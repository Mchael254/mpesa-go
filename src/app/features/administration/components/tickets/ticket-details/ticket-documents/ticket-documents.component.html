<ng-container
  *ngIf="
  currentTicket?.ticket?.sysModule === 'P' ||
  currentTicket?.ticket?.sysModule === 'RT' ||
  currentTicket?.ticket?.sysModule === 'Q'">
  <div class="row mt-3 mb-2 card">
    <div class="col-12 mt-2 mb-2">
      <label class="text-primary fw-medium">Dispatched documents</label>

      <span class="icon-circle float-end"
            data-bs-toggle="collapse" href="#collapseDispatchDocs" role="button" aria-expanded="false" aria-controls="collapseDispatchDocs"
      ><i class="pi pi-chevron-down"></i
      ></span>
    </div>

    <div class="collapse" id="collapseDispatchDocs">
      <app-dynamic-table
        [tableDetails]="tableDispatchedDocs"
        (showCustomModalEmitter)="showModal($event)">
      </app-dynamic-table>
    </div>
  </div>

  <div class="row mt-3 mb-2 card">
    <div class="col-12 mt-2 mb-2">
      <label class="text-primary fw-medium">Documents</label>

      <span class="icon-circle float-end"
            data-bs-toggle="collapse" href="#collapseDocs" role="button" aria-expanded="false" aria-controls="collapseDocs"
      ><i class="pi pi-chevron-down"></i
      ></span>
    </div>

    <div class="collapse" id="collapseDocs">
      <app-dynamic-table
        [tableDetails]="tableDetails"
        (showCustomModalEmitter)="showModal($event)">
      </app-dynamic-table>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="currentTicket?.ticket?.sysModule === 'C'">
  <div class="row mt-3 mb-2 card">
    <div class="col-12 mt-2 mb-2">
      <label class="text-primary fw-medium">Claimant Documents</label>

      <span class="icon-circle float-end"
            data-bs-toggle="collapse" href="#collapseClaimant" role="button" aria-expanded="false" aria-controls="collapseClaimant"
      ><i class="pi pi-chevron-down"></i
      ></span>
    </div>

    <div class="collapse" id="collapseClaimant">
      <app-dynamic-table
        [tableDetails]="tableClaimantDocs"
        (showCustomModalEmitter)="showModal($event)">
      </app-dynamic-table>
    </div>
  </div>

  <div class="row mt-3 mb-2 card">
    <div class="col-12 mt-2 mb-2">
      <label class="text-primary fw-medium">Service Provider Documents</label>

      <span class="icon-circle float-end"
            data-bs-toggle="collapse" href="#collapseServProv" role="button" aria-expanded="false" aria-controls="collapseServProv"
      ><i class="pi pi-chevron-down"></i
      ></span>
    </div>

    <div class="collapse" id="collapseServProv">
      <app-dynamic-table
        [tableDetails]="tableServiceProviderDocs"
        (showCustomModalEmitter)="showModal($event)">
      </app-dynamic-table>
    </div>
  </div>
</ng-container>

<div class="row mt-3 mb-2 card">
  <div class="col-12 mt-2 mb-2">
    <label class="text-primary fw-medium">Client documents</label>

    <span class="icon-circle float-end"
          data-bs-toggle="collapse" href="#collapseClientDocs" role="button" aria-expanded="false" aria-controls="collapseClientDocs"
    ><i class="pi pi-chevron-down"></i
    ></span>
  </div>

  <div class="collapse" id="collapseClientDocs">
    <app-dynamic-table
      [tableDetails]="tableClientDocs"
      (showCustomModalEmitter)="showModal($event)">
    </app-dynamic-table>
  </div>
</div>

<!--<app-dynamic-document-modal
  [modalVisible]="documentModalVisible"
  [showModalButtons]="false"
  [useDynamicContent]="true"
  [modalTitle]="selectedDocument?.docType"
  [zIndex]="1"
  (actionEmitter)="processActionEmitted($event)">
  <div modal-body-content>
    <ngx-doc-viewer
      [isBase64]="!!selectedDocumentData?.byteData"
      [base64String]="selectedDocumentData?.byteData"
      [fileName]="selectedDocumentData?.docName ?? ''"
      [srcUrl]="selectedDocumentData?.url ?? ''"
      [mimeType]="selectedDocumentData?.docMimetype"
    ></ngx-doc-viewer>
  </div>
</app-dynamic-document-modal>-->

<div class="modal fade" id="docViewerToggle" aria-labelledby="docViewerToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-6 text-primary" id="docViewerToggleLabel">Documents</h1>
        <button type="button" class="btn-close" (click)="closeDocViewerModal()"></button>
      </div>
      <div class="modal-body">
        <div class="row col-12 mb-3">
          <div class="col-3 border-end border-secondary-subtle">

            <div class="form-check mt-2 form-check-item" *ngFor="let doc of accDocsList; let i = index">

              <label class="form-label fw-medium text-dark" [for]="'flexCheckChecked' + i"
                     data-bs-target="#documentCarousel"
                     [attr.data-bs-slide-to]="i">
                <span *ngIf = "doc?.actualName" class="doc-name" title="{{doc?.actualName | titlecase}}">
                  {{doc?.actualName?.substring(0,18) | titlecase}}...
                </span>

                <i class="fa-regular fa-eye" style="font-size: 17px; cursor: pointer;"></i>
              </label><br>
            </div>

          </div>
          <div class="col-9">

            <!-- carousel -->
            <div id="documentCarousel" class="carousel slide" data-bs-ride="carousel">
              <div class="carousel-indicators">
                <ng-container *ngFor="let doc of docsList; let i = index" >
                  <button
                    type="button"
                    data-bs-target="#carouselExampleIndicators"
                    [attr.data-bs-slide-to]="i"
                    class="{{ i === 0 ? 'active' : '' }}"
                  ></button>
                </ng-container>
              </div>
              <div class="carousel-inner">
                <ng-container *ngIf="docsList.length > 0">
                  <div
                    *ngFor="let doc of docsList; let i = index"
                    class="{{ i === 0 ? 'carousel-item active' : 'carousel-item' }}"
                  >
                    <label class="form-label w-100 justify-content-center">Preview: {{ doc.fileName }}</label><br>
                    <ngx-doc-viewer
                      [isBase64]="!!doc.isBase64"
                      [base64String]="doc?.base64String"
                      [fileName]="doc?.fileName ?? ''"
                      [srcUrl]="doc?.srcUrl ?? ''"
                      [mimeType]="doc?.mimeType"
                    ></ngx-doc-viewer>
                  </div>
                </ng-container>
              </div>
              <ng-container *ngIf="docsList.length > 0">
                <button class="carousel-control-prev" type="button" data-bs-target="#documentCarousel" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true" style="background-color: black"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#documentCarousel" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true" style="background-color: black"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

