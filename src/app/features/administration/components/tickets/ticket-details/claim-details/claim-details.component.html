<label class="text-primary mb-3 fw-medium">Claim details</label>
<div class="row">
  <div class="col-sm-4">
    <p>
      <label class="ticketLabel">Claim no.:</label>
      <span class="ticketDesc">{{ selectedSpringTickets?.ticket?.claimNo}}</span>
    </p>
    <p>
      <label class="ticketLabel">Insured:</label>
      <span class="ticketDesc">{{ selectedSpringTickets?.clientName | titlecase}}</span>
    </p>
    <p>
      <label class="ticketLabel">Risk WEF:</label>
      <span class="ticketDesc">{{ claim?.risk_wef }}</span>
    </p>
    <p>
      <label class="ticketLabel">Next review date:</label>
      <span class="ticketDesc">{{ claim?.next_review_date }}</span>
    </p>
    <p>
      <label class="ticketLabel">Intermediary:</label>
      <span class="ticketDesc">{{ selectedSpringTickets?.agentName | titlecase}}</span>
    </p>
  </div>

  <div class="col-sm-4">
    <p >
      <label class="ticketLabel">Client name:</label>
      <span class="ticketDesc">{{ selectedSpringTickets?.clientName | titlecase}}</span>
    </p>
    <p>
      <label class="ticketLabel">Risk:</label>
      <span class="ticketDesc">{{ claim?.risk_property_id }}</span>
    </p>
    <p>
      <label class="ticketLabel">Risk WET:</label>
      <span class="ticketDesc">{{ claim?.risk_wet }}</span>
    </p>
    <p>
      <label class="ticketLabel">Loss description:</label>
      <span class="ticketDesc">{{ claim?.loss_description }}</span>
    </p>
    <p>
      <label class="ticketLabel">Claim remarks:</label>
      <span class="ticketDesc">{{ selectedSpringTickets?.ticket?.remarks }}</span>
    </p>
  </div>
  <div class="col-sm-4">
    <p>
      <label class="ticketLabel">Product:</label>
      <span class="ticketDesc">{{ claim?.product?.description | titlecase}}</span>
    </p>
    <p>
      <label class="ticketLabel">Risk value:</label>
      <span class="ticketDesc">{{ claim?.risk[0]?.value}}</span>
    </p>
    <p>
      <label class="ticketLabel">Claim loss date:</label>
      <span class="ticketDesc">{{ claim?.loss_date }}</span>
    </p>
    <p>
      <label class="ticketLabel">Claim notification date:</label>
      <span class="ticketDesc"></span>
    </p>
    <p>
      <label class="ticketLabel">Currency:</label>
      <span class="ticketDesc">{{claimPaymentTransaction?.currency_symbol}}</span>
    </p>
  </div>

</div>

<div class="mt-4">
  <label class="text-primary mb-3 fw-medium">Claim transaction details</label>
  <!--<button
    class="btn btn-primary float-end"
    *ngIf ="claimPaymentTransaction?.transaction_type === 'CFO' || claimPaymentTransaction?.transaction_type === 'CFI' ||
      claimPaymentTransaction?.transaction_type === 'CPI' || claimPaymentTransaction?.transaction_type === 'CPO'"
  >
    Contra
  </button>-->
  <div class="row">
    <div>
      <span *ngIf="!isLoadingTransactionData; else loadingTransactionData"></span>
      <ng-template #loadingTransactionData>
        <i class="pi pi-spin pi-spinner text-primary" style="font-size: 2rem"></i>
      </ng-template>
    </div>

    <ng-container *ngIf ="claimPaymentTransaction?.transaction_type === 'LOP' || claimPaymentTransaction?.transaction_type === 'LRV'">
      <div class="col-sm-4">
        <p>
          <label class="ticketLabel">Transaction type:</label>
          <span class="ticketDesc">{{ selectedSpringTickets?.ticket?.claimTransactionType }}</span>
        </p>
        <p>
          <label class="ticketLabel">Revision own:</label>
          <span class="ticketDesc"></span>
        </p>
        <p>
          <label class="ticketLabel">Authorised date:</label>
          <span class="ticketDesc">{{claimTransaction?.authorizationDate}}</span>
        </p>
      </div>
      <div class="col-sm-4">
        <p>
          <label class="ticketLabel">Authorised by:</label>
          <span class="ticketDesc">{{claimTransaction?.authorizedBy}}</span>
        </p>
        <p>
          <label class="ticketLabel">Revision authorised:</label>
          <span class="ticketDesc">{{claimTransaction?.authorized}}</span>
        </p>
        <p>
          <label class="ticketLabel">Own share:</label>
          <span class="ticketDesc"></span>
        </p>
      </div>
      <div class="col-sm-4">
        <p>
          <label class="ticketLabel">Revision date:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.date}}</span>
        </p>
        <p>
          <label class="ticketLabel">Own gross amount:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.amount | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Revision remarks:</label>
          <span class="ticketDesc">{{ selectedSpringTickets?.ticket?.remarks }}</span>
        </p>
      </div>
    </ng-container>
    <ng-container *ngIf ="claimPaymentTransaction?.transaction_type === 'CFO' || claimPaymentTransaction?.transaction_type === 'CFI' ||
      claimPaymentTransaction?.transaction_type === 'CPI' || claimPaymentTransaction?.transaction_type === 'CPO'">
      <div class="col-sm-4">
        <p>
          <label class="ticketLabel">Transaction type:</label>
          <span class="ticketDesc">{{ selectedSpringTickets?.ticket?.claimTransactionType }}</span>
        </p>
        <p>
          <label class="ticketLabel">Voucher no.:</label>
          <span class="ticketDesc">{{claimTransaction?.code}}</span>
        </p>
        <p>
          <label class="ticketLabel">Payment date:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.date}}</span>
        </p>
        <p>
          <label class="ticketLabel">Authorised date:</label>
          <span class="ticketDesc">{{claimTransaction?.authorizationDate}}</span>
        </p>
        <p>
          <label class="ticketLabel">Invoice no.:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.invoice_no}}</span>
        </p>
        <p>
          <label class="ticketLabel">Payment type.:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.payment_type}}</span>
        </p>
        <p>
          <label class="ticketLabel">Bank account:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.bank_account}}</span>
        </p>
        <p>
          <label class="ticketLabel">Cheque no.:</label>
          <span class="ticketDesc">{{claimTransaction?.chequeNumber}}</span>
        </p>
        <p>
          <label class="ticketLabel">Excise duty:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.exercise_duty_amount | number}}</span>
        </p>
      </div>
      <div class="col-sm-4">
        <p >
          <label class="ticketLabel">Payee:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.payee | titlecase}}</span>
        </p>
        <p>
          <label class="ticketLabel">Payment mode:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.payment_mode}}</span>
        </p>
        <p>
          <label class="ticketLabel">Authorised:</label>
          <span class="ticketDesc">{{claimTransaction?.authorized}}</span>
        </p>
        <p>
          <label class="ticketLabel">Own gross amount:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.amount | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Voucher currency:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.currency_description | titlecase}}</span>
        </p>
        <p>
          <label class="ticketLabel">WHTX amount:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.witholding_tax_amount | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Net paid:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.net_pay | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Retention:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.company_retention | number}}</span>
        </p>
      </div>
      <div class="col-sm-4">
        <p>
          <label class="ticketLabel">Correspondent:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.claimant_provider | titlecase}}</span>
        </p>
        <p>
          <label class="ticketLabel">Coin amount:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.coinsurance_total_amount | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Authorised by:</label>
          <span class="ticketDesc">{{claimTransaction?.authorizedBy}}</span>
        </p>
        <p>
          <label class="ticketLabel">Account type:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.account_type}}</span>
        </p>
        <p>
          <label class="ticketLabel">Base currency:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.amount_base_currency}}</span>
        </p>
        <p>
          <label class="ticketLabel">Invoice amount:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.invoice_amount | number}}</span>
        </p>
        <p>
          <label class="ticketLabel">Payment desc:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.payment_description | titlecase}}</span>
        </p>
        <p>
          <label class="ticketLabel">Reinstatement amt:</label>
          <span class="ticketDesc">{{claimPaymentTransaction?.reinsurance_amount | number}}</span>
        </p>
      </div>
    </ng-container>

  </div>
</div>

<div class="mt-4 mb-2">
 <app-revision-details [selectedSpringTickets]="selectedSpringTickets"></app-revision-details>
  <!--<div class="col-12 mt-2 mb-2">
    <label class="text-primary">Exceptions</label>

    <span class="icon-circle float-end"
          data-bs-toggle="collapse" href="#collapseException" role="button" aria-expanded="false" aria-controls="collapseException"
    ><i class="pi pi-chevron-down"></i
    ></span>
  </div>

  <div class="collapse" id="collapseException">
    <div class="col-12 d-flex justify-content-end mt-2 mb-2">
      <div class="col-sm-12 col-md-6">
        <input
          type="text"
          class="form-control"
          placeholder="Search by id, description"
          aria-label="search"
          aria-describedby="search"

        />
      </div>

      <div class="col-sm-12 col-md-6 d-flex justify-content-end">
        <button
          class="btn btn-primary me-2" style="font-size: 12px;" (click)="makeReady()" [disabled]="isLoadingMakeUndo">
          <span *ngIf="!isLoadingMakeUndo; else loadingMakeUndo">Make ready</span>
          <ng-template #loadingMakeUndo>
            <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
          </ng-template>
        </button>
        <button
          class="btn btn-primary" style="font-size: 12px;" (click)="authoriseExceptions()" [disabled]="isLoadingAuthExc">
          <span *ngIf="!isLoadingAuthExc; else loadingAuthExc">Authorise exceptions</span>
          <ng-template #loadingAuthExc>
            <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
          </ng-template>
        </button>
      </div>
    </div>
    <p-table
      #claimsExceptionsTable
      [autoLayout]="true"
      [rowHover]="true"
      [resizableColumns]="true"
      [showCurrentPageReport]="true"
      [rows]="pageSize || 5"
      [totalRecords]="claimExceptionData?.length"
      [value]="claimExceptionData"
      [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
      responsiveLayout="stack"
      [scrollable]="true"
      [(selection)]="selectedClaimException"
      selectionMode="single"
      dataKey="code"
      scrollHeight="400px"
      currentPageReportTemplate="{first} - {last} of {totalRecords}"
      [globalFilterFields]="['description', 'code']"
    >

      <ng-template pTemplate="header">
        <tr>
          <th style="width:0.5rem;">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
            &lt;!&ndash;        Select&ndash;&gt;
          </th>
          <th>{{'base.id' | translate }}</th>
          <th>{{'mngt_wrkflw.policyDetails.description' | translate }}</th>
          <th>{{'mngt_wrkflw.reinsurance.remarks' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.setStandard' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.usedStandard' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.authorized' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.submissionDate' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.authorizedBy' | translate }}</th>
          <th>{{'mngt_wrkflw.exceptions.authorizedDate' | translate }}</th>
          <th>{{'report.created_by' | translate }}</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-exception>
        <tr>
          <td>
            <p-tableCheckbox [value]="exception"></p-tableCheckbox>
          </td>
          <td>{{exception.gis_exception_code}}</td>
          <td>
        <span *ngIf = "exception?.description" title="{{exception?.description}}">
          {{exception?.description?.substring(0,10)}}...
        </span>
          </td>
          <td>
            <span title="{{exception?.underwriting_decision}}" (click)="toggleDropdown(exception)">
            {{exception?.underwriting_decision?.substring(0,20) | titlecase }}
          </span>

            <ng-container *ngIf="!exception.underwriting_decision || showDropdownForException === exception">
              <p-dropdown
                [options]="completionRemarksData"
                optionLabel="remark"
                optionValue="remark"
                id="code"
                [filter]="true"
                filterBy="remark"
                [showClear]="true"
                [style]="{ 'width': '130px', 'height': '40px' }"
                placeholder="Select remark"
                appendTo="body"
                (onChange)="onDropdownChange($event, exception)"
              >
                <ng-template let-remark pTemplate="item">
                  <div title="{{remark.remark}}">{{ remark.remark.length > 10 ? remark.remark.substring(0, 28) + '...' : remark.remark }}</div>
                </ng-template>
              </p-dropdown>
            </ng-container>
          </td>
          <td>{{exception?.set_standard}}</td>
          <td>{{exception?.used_standard}}</td>
          <td>{{exception?.authorised}}</td>
          <td>{{exception?.transactions_date}}</td>
          <td>{{exception?.authorised_by}}</td>
          <td>{{exception?.authorised_date}}</td>
          <td>{{exception?.exception_by}}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="11">No Exception Detail(s) Found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>-->
</div>

