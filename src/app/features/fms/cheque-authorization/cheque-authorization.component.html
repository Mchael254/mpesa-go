<div class="base-content-section">
  <div class="row me-4">
    <div class="col-8">
      <app-dynamic-breadcrumb [breadCrumbItems]="[
      {
        label: 'FMS',
        url: '/home/dashboard'
      },
      {
        label: 'Cheques',
        url: '#',
      },
      {
        label: 'Signing',
        url: ''
      }
    ]">
      </app-dynamic-breadcrumb>
    </div>
  </div>

  <div class="card mb-2" style="box-shadow:none">
    <div class="row px-3 d-flex justify-content-center">
      <div class="col-lg-3 d-flex">
        <label  class="form-label text-black align-content-center m-0" style="width: 35%;">Organization:</label>
        <select class="form-control form-select text-black border-0 fw-medium" id="organization" style="width: 62%;">
          <option value="" disabled >Select option</option>
          <option value="" selected>Mutual Benefits Assurance PLC</option>
        </select>
      </div>
      <div class="col-lg-3 d-flex">
        <label  class="form-label text-black text-end align-content-center m-0" style="width: 35%;">Branch:</label>
        <select class="form-control form-select text-black border-0 fw-medium" id="branch" style="width: 62%;">
          <option value="" disabled >Select option</option>
          <option value="" selected>Head Office</option>
        </select>
      </div>
      <div class="col-lg-2 d-flex">
        <label  class="form-label text-black text-end align-content-center m-0" style="width: 35%;">Year:</label>
        <select class="form-control form-select text-black border-0 fw-medium" id="year" style="width: 50%;">
          <option value="" disabled >Select option</option>
          <option value="" selected>2022</option>
          <option value="" selected>2023</option>
          <option value="" selected>2024</option>
        </select>
      </div>
      <div class="col-lg-2 d-flex">
        <label  class="form-label text-black text-end align-content-center m-0" style="width: 35%;">Period:</label>
        <select class="form-control form-select text-black border-0 fw-medium" id="period" style="width: 50%;">
          <option value="" disabled >Select option</option>
          <option value="" selected>APR</option>
          <option value="" selected>MAY</option>
          <option value="" selected>JUN</option>
        </select>
      </div>
    </div>
  </div>

    <div class="card mb-3" style="box-shadow:none">
      <div class="card-header bg-transparent border-bottom-0 mb-0">
        <span class="justify-content-center mt-3 text-primary">Cheque authorization</span>
      </div>
      <div class="card-body pt-0">

        <p-tabView [(activeIndex)]="activeIndex">
          <p-tabPanel header="Cheques">
            <form [formGroup]="sortingForm" style="background: none; display: contents">
              <div class="row">
                <div class="col-lg-2 col-sm-4 col-6 mb-3">
                  <label for="paymentType" class="form-label text-black fw-medium">Bank account</label>

                  <p-dropdown
                    [options]="bankAccount"
                    optionLabel="bctName"
                    [showClear]="true"
                    [filter]="true"
                    filterBy="bctName"
                    [style]="{ width: '100%', height: '50%' }"
                    appendTo="body"
                    placeholder="Select bank"
                    (onChange)="sortChequePayments()"
                    formControlName="bank">

                    <ng-template let-bank pTemplate="item">
                      <div class="d-flex align-items-center gap-2">
                        <div>{{ bank?.accNo }}</div>
                        <div>{{ bank?.bctName }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                </div>
                <div class="col-lg-2 col-sm-4 col-6">
                  <label for="paymentType" class="form-label text-black fw-medium">Payment type</label>
                  <select class="form-control form-select" formControlName="paymentType" id="paymentType" (change)="sortChequePayments()">
                    <option value="" disabled selected>Select option</option>
                    <!--                <option value="">All</option>-->
                    <option *ngFor="let paymentOption of paymentTypes" value="{{ paymentOption?.chqPaymentType }}" >{{ paymentOption?.chqPaymentDesc }}
                    </option>
                  </select>
                </div>
                <div class="col-lg-2 col-sm-4 col-6 offset-lg-4">
                  <label class="form-label text-black fw-medium">Date from</label><br>
                  <input type="date" class="form-control" formControlName="fromDate" (change)="sortChequePayments()">
                </div>
                <div class="col-lg-2 col-sm-4 col-6 mb-3">
                  <label class="form-label text-black fw-medium">Date to</label><br>
                  <input type="date" class="form-control" formControlName="toDate" (change)="sortChequePayments()">
                </div>
              </div>

            </form>
            <div >
              <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>
              <p-table
                #chequeTable
                [autoLayout]="true"
                [rowHover]="true"
                [showCurrentPageReport]="true"
                [rows]="pageSize || 10"
                [totalRecords]="chequeRequisitions?.totalElements"
                [value]="chequeRequisitions?.content"
                [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
                [scrollable]="true"
                [paginator]="true"
                [(selection)]="selectedEftPaymentTypes"
                selectionMode="single"
                dataKey="chequeRef"
                scrollHeight="490px"
                [tableStyle]="{'min-width': '78rem'}"
                responsiveLayout="scroll"

                currentPageReportTemplate="{first} - {last} of {totalRecords}"
                [globalFilterFields]="['chequeRef']"
              >

                <ng-template pTemplate="header">
                  <tr>
                    <th style="width: 3%;">
                      <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                    </th>
                    <th pSortableColumn="chequeRef">Ref No<p-sortIcon field="chequeRef"></p-sortIcon></th>
                    <th pSortableColumn="chequeRefDate">Date<p-sortIcon field="chequeRefDate"></p-sortIcon></th>
                    <th pSortableColumn="reqDate">Request date<p-sortIcon field="reqDate"></p-sortIcon></th>
                    <th pSortableColumn="pymtType">Type<p-sortIcon field="pymtType"></p-sortIcon></th>
                    <th pSortableColumn="chequeNarrative">Narrative<p-sortIcon field="chequeNarrative"></p-sortIcon></th>
                    <th pSortableColumn="bnkName">Bank account<p-sortIcon field="bnkName"></p-sortIcon></th>
                    <th pSortableColumn="chequeNo">Cheque number<p-sortIcon field="chequeNo"></p-sortIcon></th>
                    <th pSortableColumn="chequeAmount">Amount<p-sortIcon field="chequeAmount"></p-sortIcon></th>
                    <th style="width: 3%;"></th>
                  </tr>
                  <tr>
                    <th style="width: 3%;"></th>
                    <th>
                      <p-columnFilter type="text" field="chequeRef" matchMode="contains"
                                      [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="chequeRefDate" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="reqDate" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="pymtType" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="chequeNarrative" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="bnkName" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="chequeNo" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th>
                      <p-columnFilter type="text" field="chequeAmount" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>
                    </th>
                    <th style="width: 3%;"></th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-chequeAuth>
                  <tr>
                    <td>
                      <p-tableCheckbox [value]="chequeAuth"></p-tableCheckbox>
                    </td>
                    <td>{{chequeAuth.chequeRef}}</td>
                    <td>
                      {{chequeAuth?.chequeRefDate | date: 'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{chequeAuth?.reqDate | date: 'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{chequeAuth?.pymtType}}
                    </td>
                    <td>
                      <span *ngIf = "chequeAuth?.chequeNarrative" title="{{chequeAuth?.chequeNarrative}}">
                        {{chequeAuth?.chequeNarrative?.substring(0,10)}}...
                      </span>
                    </td>
                    <td>
                  <span *ngIf = "chequeAuth?.bnkName" title="{{chequeAuth?.bnkName | titlecase}}">
                    {{chequeAuth?.bnkName?.substring(0,10) | titlecase}}...
                  </span>
                    </td>
                    <td>{{chequeAuth?.chequeNo}}</td>
                    <td>{{chequeAuth?.chequeAmount | number:'1.2-2'}}</td>

                    <td class="text-center">
                      <div style="position: relative;">
                        <div class="btn-group dropend">
                          <a class="btn btn-link text-secondary" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="pi pi-ellipsis-v"></i>
                          </a>
                          <ul class="dropdown-menu">
                            <li (click)="openEligibleAuthModal(chequeAuth)">Eligible authorizers</li>
                            <li (click)="openSignedByModal(chequeAuth)">Signed by</li>
                            <li (click)="openTransactionSummaryModal(chequeAuth)">Transaction details</li>
                            <li (click)="openDocViewerModal()">Documents</li>
                          </ul>
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td colspan="11">No Cheque Authorization Detail(s) Found.</td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </p-tabPanel>
          <p-tabPanel header="EFT">
            <form [formGroup]="sortingForm" style="background: none; display: contents">
              <div class="row">
                <div class="col-lg-2 col-sm-4 col-6 mb-3">
                  <label for="paymentType" class="form-label text-black fw-medium">Bank account</label>

                  <p-dropdown
                    [options]="bankAccount"
                    optionLabel="bctName"
                    [showClear]="true"
                    [filter]="true"
                    filterBy="bctName"
                    [style]="{ width: '100%', height: '50%' }"
                    appendTo="body"
                    placeholder="Select bank"
                    (onChange)="sortChequePayments()"
                    formControlName="bank">

                    <ng-template let-bank pTemplate="item">
                      <div class="d-flex align-items-center gap-2">
                        <div>{{ bank?.accNo }}</div>
                        <div>{{ bank?.bctName }}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                </div>
                <div class="col-lg-2 col-sm-4 col-6">
                  <label for="paymentType" class="form-label text-black fw-medium">Payment type</label>
                  <select class="form-control form-select" formControlName="paymentType" id="paymentType" (change)="sortChequePayments()">
                    <option value="" disabled selected>Select option</option>
                    <!--                <option value="">All</option>-->
                    <option *ngFor="let paymentOption of paymentTypes;" value="{{ paymentOption?.chqPaymentType }}">{{ paymentOption?.chqPaymentDesc }}
                    </option>
                  </select>
                </div>
                <div class="col-lg-2 col-sm-4 col-6 offset-lg-4">
                  <label class="form-label text-black fw-medium">Date from</label><br>
                  <input type="date" class="form-control" formControlName="fromDate" (change)="sortChequePayments()">
                </div>
                <div class="col-lg-2 col-sm-4 col-6 mb-3">
                  <label class="form-label text-black fw-medium">Date to</label><br>
                  <input type="date" class="form-control" formControlName="toDate" (change)="sortChequePayments()">
                </div>
              </div>

            </form>
            <div >
              <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>
              <p-table
                #eftTable
                [autoLayout]="true"
                [rowHover]="true"
                [showCurrentPageReport]="true"
                [rows]="pageSize || 10"
                [totalRecords]="eftRequisitions?.totalElements"
                [value]="eftRequisitions?.content"
                [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
                [scrollable]="true"
                [paginator]="true"
                [(selection)]="selectedEftPaymentTypes"
                selectionMode="single"
                dataKey="chequeRef"
                scrollHeight="490px"
                [tableStyle]="{'min-width': '82rem'}"
                currentPageReportTemplate="{first} - {last} of {totalRecords}"
                [globalFilterFields]="['eftRequisitions.chequeRef', 'chequeRefDate']"
                (onLazyLoad)="lazyLoadEft($event)"
                [lazy]="true"
              >

                <ng-template pTemplate="header">
                  <tr>
                    <th style="width: 3%;">
                      <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                    </th>
                    <th pSortableColumn="chequeRef">Ref No<p-sortIcon field="chequeRef"></p-sortIcon></th>
                    <th pSortableColumn="cqrRefDate">Date<p-sortIcon field="cqrRefDate"></p-sortIcon></th>
                    <th pSortableColumn="chequeNarrative">Narrative<p-sortIcon field="chequeNarrative"></p-sortIcon></th>
                    <th pSortableColumn="bnkBankName">Bank<p-sortIcon field="bnkBankName"></p-sortIcon></th>
                    <th pSortableColumn="pyAccNo">Account Number<p-sortIcon field="pyAccNo"></p-sortIcon></th>
                    <th pSortableColumn="chequeAmount">Amount<p-sortIcon field="chequeAmount"></p-sortIcon></th>
                    <th pSortableColumn="eftStatus">Status<p-sortIcon field="eftStatus"></p-sortIcon></th>
                    <th pSortableColumn="date">Remarks<p-sortIcon field="date"></p-sortIcon></th>
                    <th style="width: 3%;"></th>
                  </tr>
                  <tr>
                    <th style="width: 3%;"></th>
                    <th>
                      <input type="text" name="refNoFilter" class="form-control w-75" (keyup.enter)="filterEft($event);" (input)="updateFilter($event)">
                    </th>
                    <th>
                      <!--<p-columnFilter type="text" field="chequeRefDate" matchMode="contains"
                                      [showMatchModes]="false" [showMenu]="false"/>-->
                    </th>
                    <th>
                      <input type="text" name="narrativeFilter" class="form-control w-75" (keyup.enter)="filterEft($event);" (input)="updateFilter($event)">
                    </th>
                    <th>
                      <!--<p-columnFilter type="text" field="bnkBankName" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>-->
                    </th>
                    <th>
                      <input type="text" name="accountNumberFilter" class="form-control w-75" (keyup.enter)="filterEft($event);" (input)="updateFilter($event)">
                    </th>
                    <th>
                      <!--<p-columnFilter type="text" field="chequeAmount" matchMode="contains"
                        [showMatchModes]="false" [showMenu]="false"/>-->
                    </th>
                    <th>
                      <input type="text" name="statusFilter" class="form-control w-75" (keyup.enter)="filterEft($event);" (input)="updateFilter($event)">
                    </th>
                    <th>
                      <!--<p-columnFilter type="text" field="chequerFmsRemarks" matchMode="contains"
                                      [showMatchModes]="false" [showMenu]="false"/>-->
                    </th>
                    <th style="width: 3%;"></th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-eftAuth let-i="rowIndex">
                  <tr>
                    <td>
                      <ng-container *ngIf="eftAuth?.disableControls === 'N'; else disableCheckbox">
                        <p-tableCheckbox [value]="eftAuth" [disabled] = "eftAuth?.disableControls === 'Y'"
                        ></p-tableCheckbox>
                      </ng-container>
                      <ng-template #disableCheckbox>
                        <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" disabled>
                      </ng-template>
                    </td>
                    <td>{{eftAuth.chequeRef}}</td>
                    <td>
                      {{eftAuth?.chequeRefDate | date: 'dd-MM-yyyy'}}
                    </td>
                    <td>
                      <span *ngIf = "eftAuth?.chequeNarrative" title="{{eftAuth?.chequeNarrative | titlecase}}">
                        {{eftAuth?.chequeNarrative?.substring(0,10) | titlecase}}...
                      </span>
                    </td>
                    <td>
                  <span *ngIf = "eftAuth?.bnkBankName" title="{{eftAuth?.bnkBankName | titlecase}}">
                    {{eftAuth?.bnkBankName?.substring(0,10) | titlecase}}...
                  </span>
                    </td>
                    <td>{{eftAuth?.pyAccNo}}</td>
                    <td>{{eftAuth?.chequeAmount | number:'1.2-2'}}</td>
                    <td>
                      <span *ngIf = "eftAuth?.eftStatus" title="{{eftAuth?.eftStatus | titlecase}}">
                        {{eftAuth?.eftStatus?.substring(0,10) | titlecase}}...
                      </span>
                    </td>
                    <td>
                      <input
                        type="text"
                        pInputText
                        (input)="onTextChange($event, eftAuth)"
                        [pTooltip]="remark"
                        tooltipPosition="bottom"
                        class="form-control"
                        [id]="i"
                      />
                    </td>
                    <td class="text-center">
                      <div style="position: relative;">
                        <div class="btn-group dropend">
                          <a class="btn btn-link text-secondary" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="pi pi-ellipsis-v"></i>
                          </a>
                          <ul class="dropdown-menu">
                            <li (click)="openEligibleAuthModal(eftAuth)">Eligible authorizers</li>
                            <li (click)="openSignedByModal(eftAuth)">Signed by</li>
                            <li (click)="openTransactionSummaryModal(eftAuth)">Transaction details</li>
                            <li (click)="fetchDocs(eftAuth?.chequeRef2)">Documents</li>
                          </ul>
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td colspan="11">No EFT Authorization Detail(s) Found.</td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </p-tabPanel>
        </p-tabView>
      </div>
    </div>


  <button class="btn btn-outline-primary float-start mb-3" (click)="generateOtp()"
          [disabled]="isGenerateOtpButtonDisabled || isLoadingGenerateOtp">
    <span *ngIf="!isLoadingGenerateOtp || countdown !== null; else loading">Generate OTP</span>
    <ng-template #loading>
      <i class="pi pi-spin pi-spinner text-primary" style="font-size: 2rem"></i>
    </ng-template>
  </button>
  <button class="btn btn-primary float-end mb-3" (click)="saveSignChequeMandate()"
          [disabled]="isButtonDisabled || isLoadingSignSelected">
    <span *ngIf="!isLoadingSignSelected; else loadingSignSelected">Sign selected</span>
    <ng-template #loadingSignSelected>
      <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
    </ng-template>
  </button>
  <button class="btn btn-primary float-end mb-3" (click)="sendToCorrectionChequeMandate()"
          [disabled]="isButtonDisabled || isLoadingSendCorrection">
    <span *ngIf="!isLoadingSendCorrection; else loading">Send for correction</span>
    <ng-template #loading>
      <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
    </ng-template>
  </button>
  <button class="btn btn-danger float-end mb-3 me-2" (click)="rejectSignChequeMandate()"
          [disabled]="isButtonDisabled || isLoadingReject">
    <span *ngIf="!isLoadingReject; else loading">Reject</span>
    <ng-template #loading>
      <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
    </ng-template>
  </button>
</div>

<!--OTP modal-->

<div class="modal fade" id="otpVerifyToggle" aria-hidden="true" aria-labelledby="otpVerifyToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered" style="width: 550px">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-6 text-dark" id="otpVerifyToggleLabel">OTP VERIFICATION</h1>
        <button type="button" class="btn-close" (click)="closeOtpModal()"></button>
      </div>
      <div class="modal-body">
        <div class="col-12 mb-3">
          <p class="text-black-50 text-center">We have sent a one time password to your email</p>
          <form [formGroup]="otpForm">
            <div class="row justify-content-center">
              <div style="align-items: center; width: 13%" class="form-group col-sm-2 col-3" *ngFor="let input of formInput;  index as i">
                <input id="keyUpEvent" #formRow type="text" formControlName="{{input}}" class="form-control text-center"
                       maxlength="1" (keyup)="keyUpEvent($event, input)">
              </div>
              <div *ngIf="submitted && otpForm.invalid" class="invalid-feedback">
                <div>
                  {{ 'auth.otp_required' | translate }}
                </div>
              </div>
            </div>
            <div class="row justify-content-center">
              <button [disabled]="!this.otpForm.valid" id="onVerify" type="submit" class="btn btn-primary my-3 w-25" (click)="onVerify()">
                <span *ngIf="!isLoading; else loading">Verify OTP</span>
                <ng-template #loading>
                  <i class="pi pi-spin pi-spinner text-white" style="font-size: 2rem"></i>
                </ng-template>
              </button>

              <div class="d-flex justify-content-center flex-nowrap">
                <label class="text-black align-content-center" style="width: 35%">Didn't receive a code?</label>
                <button class="btn btn-link text-primary text-decoration-underline" (click)="resendOtp()">
                  Resend
                </button>
              </div>

            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="mobile-bottom"></div>

<app-dynamic-simple-modal
  [modalVisible]="showEligibleAuthorizers"
  [showModalButtons]="false"
  [useDynamicContent]="true"
  [modalTitle]="'Eligible authorizers'"
  [zIndex]="1"
  (actionEmitter)="processActionEligibleAuthEmitted($event)">
  <div modal-body-content>
    <app-dynamic-table
      [tableDetails]="tableEligibleAuthorizers">
    </app-dynamic-table>
  </div>
</app-dynamic-simple-modal>

<app-dynamic-simple-modal
  [modalVisible]="showSignedBy"
  [showModalButtons]="false"
  [useDynamicContent]="true"
  [modalTitle]="'Signed by'"
  [zIndex]="1"
  (actionEmitter)="processActionSignedByEmitted($event)">
  <div modal-body-content>
    <app-dynamic-table
      [tableDetails]="tableSignedBy">
    </app-dynamic-table>
  </div>
</app-dynamic-simple-modal>


<div class="modal fade" id="transactionSummary" tabindex="-1" aria-labelledby="transactionSummaryLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="transactionSummaryLabel">Transaction summary</h1>
        <button type="button" class="btn-close" (click)="closeTransactionSummaryModal()"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-sm-6">
            <p>
              <label class="ticketLabel">System:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeSource}}</span>
            </p>
            <p>
              <label class="ticketLabel">Ref date:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeRefDate}}</span>
            </p>
            <p>
              <label class="ticketLabel">Transaction branch:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeTransactionBranch}}</span>
            </p>
            <p>
              <label class="ticketLabel">Currency:</label>
              <span class="ticketDesc">{{transactionSummary?.currency}}</span>
            </p>
            <p>
              <label class="ticketLabel">Cheque No.:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeNo}}</span>
            </p>
            <p>
              <label class="ticketLabel">Amount(words):</label>
              <span class="ticketDesc">{{transactionSummary?.chequeAmountInWords}}</span>
            </p>
            <p>
              <label class="ticketLabel">Payee details:</label>
              <span class="ticketDesc">{{transactionSummary?.payeeBank}}</span>
            </p>
            <p>
              <label class="ticketLabel">Date 1:</label>
              <span class="ticketDesc">{{transactionSummary?.date1}}</span>
            </p>
            <p>
              <label class="ticketLabel">Date 2:</label>
              <span class="ticketDesc">{{transactionSummary?.date2}}</span>
            </p>
            <p>
              <label class="ticketLabel">Requisition date:</label>
              <span class="ticketDesc">{{transactionSummary?.reqDate}}</span>
            </p>
            <p>
              <label class="ticketLabel">Source authorization date:</label>
              <span class="ticketDesc">{{transactionSummary?.sourceAuthDate}}</span>
            </p>
          </div>
          <div class="col-sm-6">
            <p>
              <label class="ticketLabel">Ref:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeRef}}</span>
            </p>
            <p>
              <label class="ticketLabel">Narrative:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeNarrative}}</span>
            </p>
            <p>
              <label class="ticketLabel">Amount:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeAmount}}</span>
            </p>
            <p>
              <label class="ticketLabel">Bank:</label>
              <span class="ticketDesc">{{transactionSummary?.bank}}</span>
            </p>
            <p>
              <label class="ticketLabel">Cheque date:</label>
              <span class="ticketDesc">{{transactionSummary?.chequeDate | titlecase}}</span>
            </p>
            <p>
              <label class="ticketLabel">Payee:</label>
              <span class="ticketDesc">{{transactionSummary?.chequePayee}}</span>
            </p>
            <p>
              <label class="ticketLabel">Action by 1:</label>
              <span class="ticketDesc">{{transactionSummary?.actionBy1}}</span>
            </p>
            <p>
              <label class="ticketLabel">Action by 2:</label>
              <span class="ticketDesc">{{transactionSummary?.actionBy2}}</span>
            </p>
            <p>
              <label class="ticketLabel">Requisition by:</label>
              <span class="ticketDesc">{{transactionSummary?.requisitionBy}}</span>
            </p>
            <p>
              <label class="ticketLabel">Source authorized by:</label>
              <span class="ticketDesc">{{transactionSummary?.authorisedBy}}</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--DOC Viewer modal-->
<div class="modal fade" id="docViewerToggle" aria-hidden="true" aria-labelledby="docViewerToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-6 text-primary" id="docViewerToggleLabel">Documents</h1>
        <button type="button" class="btn-close" (click)="closeDocViewerModal()"></button>
      </div>
      <div class="modal-body">
        <div class="row col-12 mb-3">
          <div class="col-3 border-end border-secondary-subtle">

<!--            <form [formGroup]="docDispatchForm">-->
              <div class="form-check mt-2 form-check-item" *ngFor="let doc of documentList;  let i = index">
                <!--                <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>-->
                <label class="form-label fw-medium text-dark" [for]="'flexCheckChecked' + i"
                      (click)="fetchSelectedDoc(doc?.id)" >
                  <span *ngIf = "doc?.actualName" class="doc-name" title="{{doc?.actualName | titlecase}}">
                        {{doc?.actualName?.substring(0,18) | titlecase}}...
                      </span>
<!--                  {{doc?.actualName}}-->
                  <i class="fa-regular fa-eye" style="font-size: 17px; cursor: pointer;"></i>
                </label><br>
              </div>
<!--            </form>-->
          </div>
          <div class="col-9">

            <!-- carousel -->
            <div id="documentCarousel" class="carousel slide">
              <div class="carousel-inner">
                <ng-container *ngIf="docsList.length > 0">
                  <div class="carousel-item" *ngFor="let doc of docsList; let i = index" [class.active]="i === 0">
                    <label class="form-label w-100 text-center">Preview: {{ doc.fileName }}</label><br>
                    <ngx-doc-viewer
                      [isBase64]="!!doc.isBase64"
                      [base64String]="doc?.base64String"
                      [fileName]="doc?.fileName ?? ''"
                      [srcUrl]="doc?.srcUrl ?? ''"
                      [mimeType]="doc?.mimeType"
                    ></ngx-doc-viewer>
                  </div>
                </ng-container>
              </div>
              <ng-container *ngIf="docsList.length > 0">
                <button class="carousel-control-prev" type="button" data-bs-target="#documentCarousel" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true" style="background-color: black"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#documentCarousel" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true" style="background-color: black"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </ng-container>
            </div>

          </div>

        </div>
      </div>
    </div>
  </div>
</div>
