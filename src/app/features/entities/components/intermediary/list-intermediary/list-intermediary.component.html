<div>
  <!-- Top Header Text and Breadcrumb !-->
  <div class="d-flex justify-content-between my-4 ms-4">
    <div class="mr-auto p-2">
      <h4 class="htxt page-header">{{ 'entities.business_accounts' | translate }}</h4>
    </div>
    <div class="me-4">
      <app-dynamic-breadcrumb [breadCrumbItems]="intermediaryBreadCrumbItems">
      </app-dynamic-breadcrumb>
    </div>
  </div>

  <!-- Top Buttons !-->
  <div class="d-flex my-4 ms-4">
    <button type="button" class="btn btn-primary rounded-1 px-3 me-3" id="newIntermediaryButton" (click)="gotoEntityPage()">
      {{ 'entities.new_account' | translate }}
    </button>
    <button type="button" class="btn btn-outline-primary px-3 me-3">
      {{ 'entities.import_account' | translate }}
    </button>
    <button type="button" class="btn filter-btn rounded-1 px-3 me-3">
      <i class="fa fa-filter pe-2"></i>{{ 'entities.filter' | translate }}
    </button>
  </div>

  <div class="my-4 ms-4 me-4" style="position: relative;">
    <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>

    <!--<app-dynamic-table
      [tableDetails]="tableDetails"
      (onLazyLoad)="lazyLoadAgents($event)">
    </app-dynamic-table>-->
    <p-table
      (onLazyLoad)="lazyLoadAgents($event)"
      [autoLayout]="true"
      [lazy]="true"
      [paginator]="true"
      [rowHover]="true"
      [resizableColumns]="true"
      [showCurrentPageReport]="true"
      [rows]="pageSize || 5"
      [totalRecords]="intermediaries?.totalElements"
      [value]="intermediaries?.content"
      [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
      responsiveLayout="stack"
      [scrollable]="true"
      scrollHeight="400px"
      currentPageReportTemplate="{first} - {last} of {totalRecords}"
      [globalFilterFields]=globalFilterFields
    >

      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">
            {{ 'entities.name' | translate }}
            <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="modeOfIdentity">
            {{ 'entities.primary_id_type' | translate }}
            <p-sortIcon field="modeOfIdentity"></p-sortIcon>
          </th>
          <th pSortableColumn="agentIdNo">
            {{ 'entities.id_number' | translate }}
            <p-sortIcon field="agentIdNoumber"></p-sortIcon>
          </th>
          <th pSortableColumn="primaryType">
            {{ 'entities.account_type' | translate }}
            <p-sortIcon field="primaryType"></p-sortIcon>
          </th>
          <th pSortableColumn="accountType">
            {{ 'entities.business_unit' | translate }}
            <p-sortIcon field="accountType"></p-sortIcon>
          </th>
          <th class="head">{{ 'entities.actions' | translate }}</th>
        </tr>
        <tr>
          <th>
            <input type="text" class="form-control w-75" (keyup.enter)="filter($event,0, 5, 'name');" (input)="inputName($event)">
          </th>
          <th>
            <input type="text" class="form-control w-75" (keyup.enter)="filter($event,0, 5, 'modeOfIdentity');" (input)="inputModeOfIdentity($event)">
          </th>
          <th>
            <input type="text" class="form-control w-75" (keyup.enter)="filter($event,0, 5, 'agentIdNo');" (input)="inputIdNumber($event)">
          </th>
          <th>
            <input type="text" class="form-control w-75" (keyup.enter)="filter($event,0, 5, 'primaryType');" (input)="inputPrimaryType($event)">
          </th>
          <th>
            <input type="text" class="form-control w-75" (keyup.enter)="filter($event,0, 5, 'accountType');" (input)="inputAccountType($event)">
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-agent>
        <tr>
          <td>{{ agent.name | titlecase }}</td>
          <td>{{ agent.modeOfIdentity | titlecase }}</td>
          <td>{{ agent.agentIdNo }}</td>
          <td>{{ agent.primaryType | titlecase }}</td>
          <td>{{agent.accountType | titlecase }}</td>
          <td>
            <div class="actions">
              <button type="button" class="btn btn-link text-primary" (click)="viewDetailsWithId(agent.id)">
                <i class="pi pi-eye" style="padding: 0 2px 0 0;"> </i>{{ 'entities.view' | translate }}
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8">{{ 'entities.no_agent_found' | translate }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

