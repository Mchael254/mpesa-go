
<div class="row my-3">
  <div class="col-sm-8" >
    <span
      class="text-primary fw-bold"
      *ngIf="shouldShowTableLabel"
    >
      {{ subGroup?.label[language] | titlecase }}
    </span>
  </div>
  <div class="col-sm-4 text-end">
    <button
      class="btn btn-primary btn-sm"
      (click)="onEditButtonClick({})"
      *ngIf="addButtonText"
    >
      {{ (group ? addButtonText[language] : subGroup?.addButtonTextLabel[language]) | titlecase }}
    </button>
    <span class="p-1 mx-2 caret border" (click)="columnDialogVisible = true">
      <i class="fa fa-caret-down text-primary"></i>
    </span>
  </div>
</div>

<p-dialog
  [header]="group ? group?.label[language] : subGroup?.label[language]"
  [(visible)]="columnDialogVisible"
  [modal]="true"
  [style]="{width: '330px'}"
>
  <div *ngFor="let col of table?.cols">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" value="" id="checkChecked" [checked]="col.visible" [(ngModel)]="col.visible">
      <label class="form-check-label" for="checkChecked">
        {{ col?.label[language] | titlecase }}
      </label>
    </div>
  </div>
</p-dialog>

<div style="overflow-x: auto;">
  <p-table
    [totalRecords]="table?.data.length"
    [value]="table?.data"
    [responsiveLayout]="'scroll'"
    [scrollable]="true"
    scrollHeight="400px"
    [style]="{'min-width': '800px'}"
  >
    <ng-template pTemplate="header">
      <tr>
        <ng-container *ngFor="let col of table?.cols">
          <th
            *ngIf="col.visible" [pSortableColumn]="col.field"
            class="overview-table"
          >
            {{ col?.label[language] | titlecase }}
            <p-sortIcon [field]="col.field"></p-sortIcon>
          </th>
        </ng-container>
        <th>
          {{ 'action' | titlecase }}
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-rowData>
      <tr (click)="onRowClick(rowData)">
        <ng-container *ngFor="let col of table.cols" >
          <td
            *ngIf="col.visible"
            class="py-3 overview-table"
          >
            <span *ngIf="col.fieldId !=='overview_wef' && col.fieldId !=='overview_wet'">{{ rowData[col.fieldId]  }}</span>
            <span *ngIf="col.fieldId === 'overview_wef' || col.fieldId === 'overview_wet'">{{ rowData[col.fieldId] | date }}</span>
          </td>
        </ng-container>
        <td class="text-primary overview-table">
          <button
            class="btn btn-link text-primary"
            (click)="onEditButtonClick(rowData); $event.stopPropagation()"
          >Edit</button>
          <button
            class="btn btn-link text-primary"
            (click)="triggerDeleteConfirmation(rowData); $event.stopPropagation()"
          >Delete
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog header="Confirm Delete?" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }" [blockScroll]="false" (onHide)="onDialogHide()">
  <span class="p-text-danger block mb-8">Are you sure?</span>
  <div class="text-end">
    <button class="btn btn-outline-secondary me-2" (click)="visible=false">Cancel</button>
    <button class="btn btn-danger" (click)="onDeleteButtonClick()">Confirm</button>
  </div>
</p-dialog>
