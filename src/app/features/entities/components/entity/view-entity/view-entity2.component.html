

<div *ngIf="subModules" class="entity-container">
  <p-tabView>
    <ng-container *ngFor="let tab of subModules">
      <p-tabPanel>
        <ng-template pTemplate="header" >
            <span
              class="m-2 tab-title" (click)="selectTab(tab)"
              [ngClass]="{
                'text-primary': tab.originalLabel === selectedTab,
                'text-dark': tab.originalLabel !== selectedTab
                }"
            >
              {{ tab.label[language] | titlecase }}
            </span>
        </ng-template>

        <ng-container
          *ngIf="
          entityPartyIdDetails &&
          entityAccountIdDetails &&
          clientDetails &&
          unAssignedPartyTypes &&
          clientDetails &&
          tab.originalLabel === '360 overview'
          "
        >
        <app-entity-basic-info
          [unAssignedPartyTypes]="unAssignedPartyTypes"
          [partyAccountDetails]="partyAccountDetails"
          [entityAccountIdDetails]="entityAccountIdDetails"
          [entityPartyIdDetails]="entityPartyIdDetails"
          [clientDetails]="clientDetails"
          (assignRole)="onAssignRole($event)"
          (partyTypeRole)="selectPartyTypeRole($event)"
          [overviewConfig]="tab"
          [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
        ></app-entity-basic-info>
    </ng-container>
      </p-tabPanel>
    </ng-container>
  </p-tabView>


  <p-tabView>
    <ng-container *ngFor="let tab of formGroupsAndFieldConfig?.groups">
      <p-tabPanel>
        <ng-template pTemplate="header">
            <span
              class="m-2 tab-title" (click)="selectTab(tab)"
              [ngClass]="{
                'text-primary': tab.originalLabel === selectedSubTab,
                'text-dark': tab.originalLabel !== selectedSubTab
                }"
            >
              {{ tab.label[language] | titlecase }}
            </span>
          <span
            id="edit-tab-btn"
            *ngIf="(tab.originalLabel === selectedTab || tab.originalLabel === selectedSubTab) && tab.subGroup.length === 0"
            class="m-2"
            (click)="openEditModal(tab)"
          >
            <i class="fa fa-pencil"></i>
          </span>
        </ng-template>

        <ng-container *ngIf="
           clientDetails &&
           tab.originalLabel==='Prime Identity';"
        >
          <app-prime-identity
            #primeIdentityRef
            [partyAccountDetails]="partyAccountDetails"
            [clientDetails]="clientDetails"
            [group]="tab"
            [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
          >
          </app-prime-identity>
        </ng-container>

        <ng-container *ngIf="
            clientDetails &&
            tab.originalLabel==='Contact Details'"
        >
          <app-contact
            #contactRef
            [clientDetails]="clientDetails"
            [group]="tab"
            [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
          ></app-contact>
        </ng-container>

        <ng-container *ngIf="
            clientDetails &&
            tab.originalLabel==='Address Details';"
        >
          <app-address
            #addressRef
            [clientDetails]="clientDetails"
            [group]="tab"
            [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
          ></app-address>
        </ng-container>

        <ng-container *ngIf="
            clientDetails &&
            tab.originalLabel==='Financial Details'"
        >
          <app-financial
            #financialRef
            [clientDetails]="clientDetails"
            [group]="tab"
            [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
            [countryId]="clientDetails?.address?.countryId"
          >
          </app-financial>
        </ng-container>

        <ng-container *ngIf="
            clientDetails &&
            tab.originalLabel==='Wealth And Anti-money Laundering Details'"
        >
          <app-wealth-aml
            #wealthAmlRef
            [clientDetails]="clientDetails"
            [formGroupsAndFieldConfig]="formGroupsAndFieldConfig"
            [group]="tab"
          ></app-wealth-aml>
        </ng-container>

      </p-tabPanel>
    </ng-container>
  </p-tabView>
</div>
