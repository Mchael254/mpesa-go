
<ng-container *ngIf="group.subGroup?.length === 0">
  <div class="row">
    <ng-container *ngFor="let field of fields">
      <div class="col-sm-4">
        <div class="row my-2">
          <div class="col-sm-4 text-dark">
            {{ field.label[language] }}
          </div>
          <div class="col-sm-8 text-dark fw-bold">
            {{ field.dataValue }}
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</ng-container>



<ng-container *ngIf="subGroups?.length > 0">
  <ng-container *ngFor="let subGroup of subGroups">

    <ng-container *ngIf="subGroup.presentationType===PRESENTATION_TYPE.fields">
      <div class="row my-3">
        <div class="col-sm-8">
          <span class="text-primary fw-bold">
            {{ subGroup.label[language] | titlecase }}
          </span>
          <span
            class="m-2 text-primary edit-tab-btn"
            (click)="openEditContactDialog(subGroup, Save_Action.EDIT_CONTACT_DETAILS)"
          >
            <i class="fa fa-pencil"></i>
          </span>
        </div>
      </div>
      <div class="row mb-3">
        <ng-container *ngFor="let field of subGroup.fields">
          <div class="col-sm-4" *ngIf="!(field.fieldId.toLowerCase().includes('id')) && field.formSubGroupingId === subGroup.subGroupId">
            <div class="row my-2">
              <div class="col-sm-4 text-dark">
                {{ field.label[language] }}
              </div>
              <div class="col-sm-8 text-dark fw-bold">
                {{ field.dataValue }}
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </ng-container>

    <ng-container *ngIf="subGroup.presentationType === PRESENTATION_TYPE.fields_and_table_columns">
      <app-overview-table
        [subGroup]="subGroup"
        [table]="table"
        [language]="language"
        (deleteBtnClicked)="handleContactPersonDelete($event)"
        (editBtnClicked)="prepareEditContactPersonForm($event, Save_Action.EDIT_CONTACT_PERSON)"
      >
      </app-overview-table>
    </ng-container>

  </ng-container>
</ng-container>

<!--edit prime details modal-->
<button #editButton type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editContactModal" hidden>
  Open Edit Prime Identity Modal
</button>

<!-- Modal -->
<div class="modal fade" id="editContactModal" tabindex="-1" aria-labelledby="editContactModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-4 text-primary" id="editContactModalLabel">
          {{ formHeadingLabel?.label[language] | titlecase }}
        </h1>
        <button #closeButton type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <ng-container *ngIf=" editForm; else loadingForm">
          <form [formGroup]="editForm">
            <div class="row g-3">
              <ng-container *ngFor="let field of formFields">
                <div class="col-md-6" *ngIf="!(field.fieldId.toLowerCase().includes('personid')) && field.formSubGroupingId === selectedSubgroup?.subGroupId">
                  <label [for]="field.fieldId" class="form-label">
                    {{ field?.label[language] || '---' | titlecase }}
                  </label>
                  <!-- Text input -->
                  <input
                    *ngIf="field.type === 'text' || field.type === 'email'"
                    [formControlName]="field.fieldId"
                    [placeholder]="field?.placeholder[language] || ''"
                    [id]="field.fieldId"
                    type="text"
                    class="form-control"
                  />

                  <!--select input-->
                  <select
                    *ngIf="field.type === 'select'"
                    [formControlName]="field.fieldId"
                    [id]="field.fieldId"
                    class="form-select"
                  >
                    <option *ngFor="let opt of field.options" [value]="opt.id ? opt.id : (opt.value || opt.name)">
                      {{ opt.name || opt.description || opt.label | titlecase }}
                    </option>
                  </select>

                  <!--tel number-->
                  <span *ngIf="checkTelNumber(field.fieldId)">
                    <ngx-intl-tel-input
                      [cssClass]="'form-control mb-1'"
                      [id]="field.fieldId"
                      [preferredCountries]=""
                      [enableAutoCountrySelect]="true"
                      [enablePlaceholder]="true"
                      [searchCountryFlag]="true"
                      [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"
                      [selectFirstCountry]="false"
                      [selectedCountryISO]="countryISO"
                      [phoneValidation]="true"
                      [separateDialCode]="true"
                      [numberFormat]="PhoneNumberFormat.National"
                      [formControlName]="field.fieldId"
                      [style]="{ width: '100%' }"
                    >
                    </ngx-intl-tel-input>
                  </span>

                  <!--Date-->
                  <input
                    *ngIf="field.type === 'date'"
                    type="date"
                    [formControlName]="field.fieldId"
                    [placeholder]="field.placeholder[language] || ''"
                    [id]="field.fieldId"
                    class="form-control"
                  />
                </div>
              </ng-container>
            </div>
          </form>
        </ng-container>
        <ng-template #loadingForm>
          <div class="text-center">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </ng-template>
      </div>
     <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">
<!--          {{ selectedSubgroup?.addButtonTextLabel[language] | titlecase }}-->
        </button>
        <button type="button" class="btn btn-primary" (click)="saveDetails()">
          {{ 'save' | titlecase }}
        </button>
      </div>
    </div>
  </div>
</div>
