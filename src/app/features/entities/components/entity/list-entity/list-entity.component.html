
<div class="px-4 py-2">
  <app-dynamic-breadcrumb [breadCrumbItems]="entityBreadCrumbItems">
  </app-dynamic-breadcrumb>
</div>

<div class="bg-white mx-4">
    <div class="d-flex justify-content-between ms-4">
        <div class="mr-auto p-2">
            <h6 class="htxt page-header">{{'entities.entities' | translate | uppercase}}</h6>
        </div>
    </div>
    <!-- Top Buttons !-->
    <div class="d-flex my-4 ms-4">
      <button
        type="button"
        class="btn btn-primary rounded-0 px-3 me-3"
        id="newEntityButton" (click)="createEntity()"
      >
        <i class="fa-solid fa-plus"></i> {{ 'entities.new_entity' | translate | titlecase }}
      </button>

      <button
        type="button"
        class="btn filter-btn rounded-0 px-4 me-3"
      >
        <i class="fa fa-filter pe-2"></i> {{ 'entities.filter' | translate | titlecase }}
      </button>
    </div>
    <div class="my-4 ms-4 me-4" style="position: relative;">
        <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>

        <!--<app-dynamic-table
            [tableDetails]="tableDetails"
            (onLazyLoad)="lazyLoadEntity($event)">
        </app-dynamic-table>-->

      <div class="row">
        <div class="col-sm-2 offset-sm-10 text-end mb-3">
          <span class="p-1 me-5 caret" (click)="columnDialogVisible = true">
            <i class="fa fa-caret-down text-primary"></i>
          </span>
        </div>
      </div>

      <p-dialog [header]="columnLabel[language]" [(visible)]="columnDialogVisible" [modal]="true" [style]="{width: '330px'}">
        <div *ngFor="let col of columns">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="checkChecked" [checked]="col.visible" [(ngModel)]="col.visible">
            <label class="form-check-label" for="checkChecked">
              {{ col.label[language] | titlecase }}
            </label>
          </div>
        </div>
      </p-dialog>

      <p-table
        (onLazyLoad)="lazyLoadEntity($event)"
        [autoLayout]="true"
        [lazy]="true"
        [paginator]="true"
        [rowHover]="true"
        [resizableColumns]="true"
        [showCurrentPageReport]="true"
        [rows]="pageSize || 5"
        [totalRecords]="entities?.totalElements"
        [value]="entities?.content"
        [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
        responsiveLayout="stack"
        [scrollable]="true"
        scrollHeight="400px"
        currentPageReportTemplate="{first} - {last} of {totalRecords}"
        [globalFilterFields]=globalFilterFields
      >

        <ng-template pTemplate="header">
          <!--<tr>
            <th pSortableColumn="name">
              {{ 'entities.name' | translate | titlecase }}
              <p-sortIcon field="name"></p-sortIcon>
            </th>
            <th pSortableColumn="modeOfIdentity.name">
              {{ 'entities.id_type' | translate }}
              <p-sortIcon field="modeOfIdentity.name"></p-sortIcon>
            </th>
            <th pSortableColumn="identityNumber">
              {{ 'entities.id_number' | translate }}
              <p-sortIcon field="identityNumber"></p-sortIcon>
            </th>
            <th pSortableColumn="pinNumber">
              {{ 'entities.pin_number' | translate }}
              <p-sortIcon field="pinNumber"></p-sortIcon>
            </th>
            <th pSortableColumn="categoryName">
              {{ 'entities.entity_type' | translate }}
              <p-sortIcon field="categoryName"></p-sortIcon>
            </th>
            <th class="head">{{ 'entities.actions' | translate }}</th>
          </tr>-->
          <tr>
            <ng-container *ngFor="let col of columns">
              <th *ngIf="col.visible"
                  [pSortableColumn]="col.field">
                {{ col.label[language] | titlecase }}
                <p-sortIcon [field]="col.field"></p-sortIcon>
              </th>
            </ng-container>
            <th>
              {{ actionLabel[language] }}
            </th>
          </tr>
          <tr>
            <ng-container *ngFor="let col of columns">
              <th *ngIf="col.visible">
                <input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, col.field)" (input)="processInput($event, col.field)">
              </th>
            </ng-container>
            <th></th>
          </tr>
          <!--<tr>
            <th>
              <input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, 'name');" (input)="inputName($event)">
            </th>
            <th><input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, 'modeOfIdentity.name');" (input)="inputModeOfIdentityName($event)"></th>
            <th>
              <input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, 'identityNumber');" (input)="inputIdNumber($event)">
            </th>
            <th>
              <input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, 'pinNumber');" (input)="inputPinNumber($event)">
            </th>
            <th>
              <input type="text" class="form-control w-75" (keyup.enter)="filter($event, 0, 5, 'categoryName');" (input)="inputCategoryName($event)">
            </th>
          </tr>-->
        </ng-template>
        <ng-template pTemplate="body" let-rowData>
          <tr [pSelectableRow]="rowData">
            <ng-container *ngFor="let col of columns">
              <td *ngIf="col.visible">
                {{ rowData[col.field] | titlecase }}
              </td>
            </ng-container>

            <td *ngIf="tableDetails.rows?.length > 0">
              <div class="actions">
                <button
                  type="button"
                  class="btn btn-link text-primary"
                  (click)="viewDetailsWithId(rowData.id, rowData.categoryName)"
                >
                  <i class="pi pi-eye" style="padding: 0 2px 0 0;"> </i>view
                </button>
              </div>
            </td>
          </tr>
          <!--<tr>
            <td>{{ entity?.name | titlecase }}</td>
            <td>{{ entity?.modeOfIdentity?.name | titlecase }}</td>
            <td>{{ entity?.identityNumber }}</td>
            <td>{{ entity?.pinNumber }}</td>
            <td>{{ entity?.categoryName }}</td>
            <td>
              <div class="actions">
                <button type="button" class="btn btn-link text-primary" (click)="viewDetailsWithId(entity.id)">
                  <i class="pi pi-eye" style="padding: 0 2px 0 0;"> </i>view
                </button>
              </div>
            </td>
          </tr>-->
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="8">No Entity Found.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
</div>

<div class="mobile-bottom"></div>

