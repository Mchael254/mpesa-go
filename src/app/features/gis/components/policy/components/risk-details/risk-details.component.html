<div class="container ">
    <p class="titleMain mt-3">{{'gis.policy.underwriting_risk_details' | translate}}</p>
    <app-stepper [currentStep]="2" [stepperData]="steps"></app-stepper>

    <div class="container mx-2 mt-n1">
        <!-- RISK DETAILS -->
        <div class="card mb-3 px-2" style=" position: relative;">
            <div class="card-body">
                <p class="subheading">{{'gis.policy.risk_details' | translate}}</p>
                <form [formGroup]="policyRiskForm">
                    <!-- ROW 1 -->
                    <div class="row mb-4">

                        <div class="mb-1 col-sm-4 col-12">
                            <label for="insured" class="required risk-label" id="client">{{'gis.policy.insured' |
                                translate}}</label>
                            <div formGroupName="insureds">
                                <div formGroupName="client">

                                    <input type="text" id="quote-input"
                                        class="form-select form-control form-control-sm mb-1" formControlName="id"
                                        [(ngModel)]="passedClientName" data-bs-toggle="modal"
                                        data-bs-target="#clientModal" readonly>

                                </div>
                            </div>

                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label class="required risk-label">{{'gis.policy.risk_id' | translate}}</label>
                            <input type="text" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                [(ngModel)]="riskId" formControlName="propertyId">

                            <!-- <input type="date" id="coverFrom" class="form-control form-control-sm mb-1 riskInput"
                                [(ngModel)]="passedCoverFrom" formControlName="dateCoverFrom"> -->

                            <!-- Display error message under the field -->
                            <div *ngIf="policyRiskForm.get('propertyId').hasError('required') && policyRiskForm.get('propertyId').touched"
                                class="form-text text-danger">
                                Risk ID is required.
                            </div>
                        </div>
                        <div class=" mb-1 col-sm-4 col-12" *ngIf="!motorProduct">
                            <label for="riskDescription" class="required risk-label"
                                id="riskDescription">{{'gis.policy.risk_description' | translate}}</label><br>
                            <input type="text" id="riskDescription" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="propertyDescription" data-bs-toggle="tooltip" data-bs-placement="right"
                                title="Tooltip on right" readonly>

                            <!-- Display error message under the field -->
                            <div *ngIf="policyRiskForm.get('propertyDescription').hasError('required') && policyRiskForm.get('propertyDescription').touched"
                                class="form-text text-danger">
                                Risk Description is required.
                            </div>
                        </div>
                        <div class=" mb-1 col-sm-4 col-12" *ngIf="motorProduct">
                            <label for="riskDescription" class="required risk-label"
                                id="riskDescription">{{'gis.policy.risk_description' | translate}}</label><br>
                            <input type="text" id="riskDescription" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="subClassCode" [(ngModel)]="vehiclemakeModel" data-bs-toggle="tooltip"
                                data-bs-placement="right" title="Tooltip on right" readonly>

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                class="form-text text-danger">
                                Risk Description is required.
                            </div> -->
                        </div>
                    </div>
                    <!-- ROW 2 -->
                    <div class="row mb-4">
                        <div class="mb-1 col-sm-4 col-12">
                            <label for="subclass" class="required risk-label" id="subclass">{{'gis.policy.subclass' |
                                translate}}</label>

                            <!-- <select class="form-select form-control-sm selectInput" id="subclass"
                                formControlName="subClassCode" (change)="onSubclassSelected($event)"
                                [(ngModel)]="subclass">
                                <option value=""  ></option>
                                <option *ngFor="let subclass of allMatchingSubclasses" [value]="subclass.code">
                                    {{subclass.description | sentenceCase}}</option>
                            </select> -->

                            <p-dropdown [options]="allMatchingSubclasses" optionValue="code" optionLabel="description"
                                formControlName="subClassCode" (onChange)="onSubclassSelected($event.value)"
                                [placeholder]="subclass" [filterBy]="'description'" [filter]="true"
                                [ngModel]="subclass"></p-dropdown>

                            <!-- Display error message under the field -->
                            <div *ngIf="policyRiskForm.get('subClassCode').hasError('required') && policyRiskForm.get('subClassCode').touched"
                                class="form-text text-danger">
                                Subclass is required.
                            </div>
                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label for="binder" class="required risk-label" id="binder">{{'gis.policy.binder' |
                                translate}}</label>
                            <!-- <select class="form-select form-control-sm mb-1 ms-n4 selectInput" id="binder"
                                formControlName="binder_code" (change)="onSelectBinder($event)">
                                <option></option>

                            </select> -->
                            <!-- <select class="form-select form-control-sm mb-1 ms-n4 selectInput" id="binder"
                                formControlName="binderCode" >
                                <option></option>
                                <option *ngFor="let binder of binderListDetails" [value]="binder.code">{{
                                    binder.binder_short_description | sentenceCase }}</option>
                            </select> -->
                            <p-dropdown [options]="binderListDetails" optionValue="code"
                                optionLabel="binder_short_description" formControlName="binderCode"
                                [placeholder]="binder" [filterBy]="'binder_short_description'" [filter]="true"
                                [ngModel]="binder"></p-dropdown>

                            <!-- Display error message under the field -->
                            <div *ngIf="policyRiskForm.get('binderCode').hasError('required') && policyRiskForm.get('binderCode').touched"
                                class="form-text text-danger">
                                Binder is required.
                            </div>

                        </div>
                        <div class=" mb-1 col-sm-4 col-12 ">
                            <label for="coverType" class="required risk-label" id="coverType">{{'gis.policy.cover_type'
                                | translate}}</label>

                            <!-- <select class="form-select form-control-sm selectInput" id="coverType"
                                formControlName="coverTypeCode" (change)="onCoverTypeSelected($event)"
                                [(ngModel)]="coverType">
                                <option value=""></option>
                                <option *ngFor="let coverType of subclassCoverType" [value]="coverType.code">
                                    {{coverType.description | sentenceCase}}</option>
                            </select> -->


                            <p-dropdown [options]="subclassCoverType" optionValue="code" optionLabel="description"
                                formControlName="subClassCode" (onChange)="onCoverTypeSelected($event.value)"
                                [placeholder]="coverType" [filterBy]="'description'" [filter]="true"
                                [ngModel]="coverType"></p-dropdown>
                            <!-- Display error message under the field -->
                            <div *ngIf="policyRiskForm.get('coverTypeCode').hasError('required') && policyRiskForm.get('coverTypeCode').touched"
                                class="form-text text-danger">
                                Cover Type is required.
                            </div>
                        </div>
                    </div>
                    <!-- MOTOR SUBCLASS FIELDS -->
                    <div *ngIf="showMotorSubclassFields">
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">
                                <label for="vehiclemake" class="required risk-label" id="vehiclemake">Vehicle
                                    Make</label><br>
                                <!-- <p-dropdown [options]="vehicleMakeList" optionValue="code" optionLabel="name"
                                    formControlName="vehicleMake" (onChange)="onVehicleMakeSelected($event.value)"
                                    placeholder="vehicleMake " [filterBy]="'name'" [filter]="true"
                                    [ngModel]="vehicleMake"></p-dropdown> -->

                                <p-dropdown [options]="vehicleMakeList" optionValue="code" optionLabel="name"
                                    formControlName="vehicleMake" (onChange)="onVehicleMakeSelected($event.value)"
                                    [placeholder]="vehicleMake" [filterBy]="'name'" [filter]="true"
                                    [ngModel]="vehicleMake"></p-dropdown>
                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <label for="vehicleModel" class="required risk-label" id="vehicleModel">Vehicle
                                    model</label><br>
                                <!-- <p-dropdown [options]="filteredVehicleModel" optionValue="code" optionLabel="name"
                                    formControlName="vehicleModel" (onChange)="onVehicleModelSelected($event.value)"
                                    placeholder=" vehicleModel" [filterBy]="'name'" [filter]="true"
                                    [ngModel]="vehicleModel"></p-dropdown> -->

                                    <p-dropdown [options]="filteredVehicleModel" optionValue="code" optionLabel="name"
                                    formControlName="vehicleModel" (onChange)="onVehicleModelSelected($event.value)"
                                    [placeholder]="vehicleModel" [filterBy]="'name'" [filter]="true"
                                    [ngModel]="vehicleModel"></p-dropdown>
                            </div>
                            <div class=" mb-1 col-sm-4 col-12 ">
                                <label for="riskCoverDays" class=" risk-label required" id="modelYear">Model
                                    year</label>
                                <select class="form-select form-control-sm selectInput" id="modelYear"
                                    formControlName="modelYear" [ngModel]="passedModelYear">
                                    <option value=""></option>
                                    <option *ngFor="let year of modelYear" [value]="year">{{ year }}</option>

                                </select>


                                <!-- Display error message under the field -->
                                <!-- <div *ngIf="policyProductForm.get('product_code').hasError('required') && policyProductForm.get('product_code').touched"
                                class="form-text text-danger">
                                Product is required.
                            </div> -->
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">

                                <div class="form-check pt-4">

                                    <input class="form-check-input me-2" type="checkbox" id="insuredDriver"
                                        formControlName="regularDriver">

                                    <label class="risk-label form-check-label" for="insuredDriver">
                                        Insured as regular driver
                                    </label>
                                </div>
                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">

                                    <input class="form-check-input me-2" type="checkbox" id="logBookAvailable"
                                        formControlName="logbookAvailable">

                                    <label class="risk-label form-check-label" for="logBookAvailable">
                                        Log book available
                                    </label>
                                </div>

                            </div>
                            <div class=" mb-1 col-sm-4 col-12 ">
                                <div class="form-check pt-4">

                                    <input class="form-check-input me-2" type="checkbox" id="logBookUnderInsured"
                                        formControlName="logbookUnderInsuredName">

                                    <label class="risk-label form-check-label" for="logBookUnderInsured">
                                        Log book under insured name
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">
                                <label for="logbook" class="required risk-label" id="logbook">Logbook</label><br>
                                <input type="text" id="logbook" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="logbook">
                            </div>
                        </div>
                    </div>
                    <!-- ROW 3 -->
                    <div class="row mb-4">
                        <div class="mb-1 col-sm-4 col-12">
                            <label for="coverFrom" class="required risk-label" id="coverFrom">{{'gis.policy.cover_from'
                                |
                                translate}}</label>
                            <input type="date" id="coverFrom" class="form-control form-control-sm mb-1 riskInput"
                                [(ngModel)]="passedCoverFrom" formControlName="dateCoverFrom">
                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label for="coverTo" class="required risk-label" id="coverTo">{{'gis.policy.cover_to' |
                                translate}}</label>
                            <input type="date" id="coverTo" class="form-control form-control-sm mb-1 riskInput"
                                [(ngModel)]="passedCoverTo" formControlName="dateCoverTo">

                        </div>
                        <div class=" mb-1 col-sm-4 col-12 ">
                            <label for="riskCoverDays" class=" risk-label"
                                id="riskCoverDays">{{'gis.policy.risk_cover_days' | translate}}</label>
                            <input type="text" id="riskCoverDays" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="coverDays" readonly>


                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyProductForm.get('product_code').hasError('required') && policyProductForm.get('product_code').touched"
                                class="form-text text-danger">
                                Product is required.
                            </div> -->
                        </div>
                    </div>
                    <div class="collapse" id="collapseExample">
                        <!-- ROW 4 -->
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">

                                <label class=" risk-label">{{'gis.policy.override_but_charge' | translate}}</label>
                                <input type="text" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="ncdApplicable">
                            </div>


                            <div class="mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">

                                    <input class="form-check-input me-2" type="checkbox" id="flexCheckDefault" #checkbox
                                        (change)="toggleNcdApplicableFields(checkbox.checked)"
                                        formControlName="ncdApplicable">

                                    <label class="risk-label form-check-label" for="flexCheckDefault">
                                        {{'gis.policy.ncd_applicable' | translate}}
                                    </label>
                                </div>
                            </div>

                            <div class="mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">
                                    <input class="form-check-input me-2" type="checkbox" id="flexCheckDefault"
                                        #cashApplicableCheckbox
                                        (change)="toggleCashApplicableField(cashApplicableCheckbox.checked)"
                                        formControlName="cashApplicable">

                                    <!-- <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"> -->
                                    <label class="risk-label form-check-label" for="flexCheckDefault">
                                        {{'gis.policy.cash_applicable' | translate}}
                                    </label>
                                </div>

                            </div>


                        </div>
                        <!-- NCD APPLICABLE FIELDS -->
                        <div class="row mb-4" *ngIf="isNcdApplicable">
                            <div class="mb-1 col-sm-4 col-12">
                                <label class=" risk-label"> {{'gis.policy.ncd_level' | translate}}</label>
                                <input type="number" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="ncdLevel">
                            </div>
                            <div class="mb-1 col-sm-4 col-12">
                                <label class=" risk-label"> {{'gis.policy.ncd_certificate_number' | translate}}</label>
                                <input type="text" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="ipuNcdCertNo">
                            </div>
                        </div>
                        <!-- CASH APPLICABLE FIELDS -->
                        <div class="row mb-4" *ngIf="isCashApplicable">
                            <div class="mb-1 col-sm-4 col-12">
                                <label class=" risk-label"> {{'gis.policy.cash_level' | translate}}</label>
                                <input type="number" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="cashLevel">
                            </div>

                        </div>
                        <!-- ROW 5 -->
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">

                                <label class=" risk-label"> {{'gis.policy.conveyance_type' | translate}}</label>
                                <select class="form-select form-control-sm mb-1 ms-n4 selectInput" id="subclass"
                                    formControlName="conveyanceType">
                                    <option value=""></option>
                                    <option value=""> {{'gis.policy.by_sea' | translate}}</option>
                                    <option value=""> {{'gis.policy.by_air' | translate}}</option>
                                    <option value=""> {{'gis.policy.by_road' | translate}}</option>
                                    <option value=""> {{'gis.policy.by_sea_rail_road' | translate}}</option>
                                    <option value=""> {{'gis.policy.by_sea_road' | translate}}</option>
                                    <option value=""> {{'gis.policy.by_air_road' | translate}}</option>
                                    <option value=""> {{'gis.policy.not_applicable' | translate}}</option>
                                    <option value=""> {{'gis.policy.none' | translate}}</option>
                                </select>
                            </div>


                            <div class=" mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                    <label class="risk-label form-check-label" for="flexCheckDefault"
                                        formControlName="autogenerateCert">
                                        {{'gis.policy.auto_generate_cert' | translate}}
                                    </label>
                                </div>
                            </div>
                            <div class="mb-1 col-sm-4 col-12">

                                <label class=" risk-label"> {{'gis.policy.installment_payment_pct' | translate}}</label>
                                <input type="text" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="installmentPaymentPercentage">
                            </div>



                        </div>
                        <!-- </div> ROW 6 -->
                        <div class="row mb-4">
                            <div class="mb-1 col-sm-4 col-12">

                                <label class=" risk-label"> {{'gis.policy.installment_period' | translate}}</label>
                                <input type="number" id="riskId" class="form-control form-control-sm mb-1 riskInput"
                                    formControlName="installmentPeriod">
                            </div>


                        </div>
                    </div>

                    <p class="more " (click)="show=!show" data-bs-toggle="collapse" data-bs-target="#collapseExample"
                        aria-expanded="false" aria-controls="collapseExample"> {{'gis.policy.more_details' |
                        translate}}<span class="ml-1" data-toggle="collapse" data-target="#collapseExample"
                            aria-expanded="false" aria-controls="collapseExample"> <i class="pi pi-angle-double-up"
                                style="font-size:13px" *ngIf="!show" data-toggle="collapse"
                                data-target="#collapseExample"></i><i class="pi pi-angle-double-down"
                                style="font-size:13px" *ngIf="show" data-toggle="collapse"
                                data-target="#collapseExample"></i></span> </p>
                    <!-- Client Modal -->
                    <div class="modal fade" id="clientModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">

                                <div class="modal-body">
                                    <button type="button" #closebutton class="float-end btn-close"
                                        data-bs-dismiss="modal" aria-label="Close"></button>
                                    <p class="text-start" id="selectClient">{{'gis.policy.select_client' | translate}}
                                    </p>

                                    <p-table #dt1 [value]="clientData" [tableStyle]="{'max-width': '465px'}"
                                        selectionMode="single" [resizableColumns]="true" styleClass="p-datatable-sm"
                                        responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true"
                                        [paginator]="true" [rows]="5" [scrollable]="true" scrollDirection="horizontal"
                                        [showCurrentPageReport]="true"
                                        currentPageReportTemplate=" {first} - {last} of {totalRecords}"
                                        [globalFilterFields]="['idNumber', 'emailAddress','lastName','emailAddress']">
                                        <ng-template pTemplate="caption">
                                            <div class="flex">
                                                <span class="p-input-icon-left ml-auto">
                                                    <i class="pi pi-search search-icon"></i>
                                                </span>
                                                <input class="search-input" pInputText type="text"
                                                    (input)="applyFilterGlobal($event, 'contains')"
                                                    placeholder="Search" />

                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="header">

                                            <tr id="product">
                                                <th>{{'gis.policy.id_no' | translate}}</th>
                                                <th>{{'gis.policy.name' | translate}}</th>
                                                <th>{{'gis.policy.email' | translate}}</th>

                                            </tr>
                                        </ng-template>

                                        <ng-template let-clientData pTemplate="body">
                                            <tr id="productData" [pSelectableRow]=""
                                                (click)="loadClientDetails(clientData.id);">

                                                <td>
                                                    {{clientData.idNumber}}
                                                </td>
                                                <td>
                                                    {{clientData.firstName+" "+clientData.lastName}}
                                                </td>
                                                <td>
                                                    {{clientData.emailAddress}}
                                                </td>
                                            </tr>
                                        </ng-template>

                                    </p-table>
                                    <br>
                                    <!-- <button class="btn btn-primary float-end" data-bs-dismiss="modal" (click)="saveclient()">Save Details</button> -->
                                </div>



                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>
        <!-- OTHER RISK DETAILS -->
        <div class="card mb-3 px-2" style=" position: relative;">
            <div class="card-body">
                <p class="subheading">Other risk details</p>

                <form [formGroup]="policyRiskForm">
                    <!-- ROW 1 -->
                    <div class="row mb-4">

                        <div class="mb-1 col-sm-4 col-12">
                            <label for="riskLocation" class="required risk-label"
                                id="riskLocation">{{'gis.policy.risk_location'|translate}}</label>
                            <p-dropdown [options]="statesList" optionValue="id" optionLabel="name" placeholder=" "
                                (onChange)="onStateSelected($event.value)" [filterBy]="'name'"
                                formControlName="riskLocation" [filter]="true"></p-dropdown>

                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label class="required risk-label">{{'gis.policy.risk_town'|translate}}</label>
                            <p-dropdown [options]="townList" optionValue="name" optionLabel="name" placeholder=" "
                                [filterBy]="'name'" [filter]="true" formControlName="town"></p-dropdown>

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_id').hasError('required') && policyRiskForm.get('property_id').touched"
                                class="form-text text-danger">
                                Risk Town is required.
                            </div> -->
                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label for="riskAddress" class=" risk-label"
                                id="riskAddress">{{'gis.policy.risk_address'|translate}}</label><br>
                            <input type="text" id="riskAddress" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="riskAddress">

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                class="form-text text-danger">
                                Risk Address is required.
                            </div> -->
                        </div>

                    </div>
                    <!-- ROW 2 -->
                    <div class="row mb-4">

                        <div class="mb-1 col-sm-4 col-12">
                            <label for="riskDetails" class=" risk-label"
                                id="riskLocation">{{'gis.policy.risk_details'|translate}}</label>
                            <input type="text" id="riskDetails" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="riskDetails">

                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label class="required risk-label">{{'gis.policy.survey_risk'|translate}}</label>
                            <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                formControlName="surveyDate">
                                <option value="Y">{{'gis.policy.yes' | translate}}</option>
                                <option value="N">{{'gis.policy.no' | translate}}</option>

                            </select>

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_id').hasError('required') && policyRiskForm.get('property_id').touched"
                                class="form-text text-danger">
                                Risk Town is required.
                            </div> -->
                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label for="surveyDate" class="required risk-label"
                                id="surveyDate">{{'gis.policy.Survey_date'|translate}}</label><br>
                            <input type="date" id="surveyDate" class="form-control form-control-sm mb-1 riskInput"
                                formControlName="surveyDate">

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                class="form-text text-danger">
                                Risk Address is required.
                            </div> -->
                        </div>

                    </div>
                    <!-- ROW 3 -->
                    <div class="row mb-4">

                        <div class="mb-1 col-sm-4 col-12">
                            <label for="computeMaxExposure" class="required risk-label"
                                id="riskLocation">{{'gis.policy.compute_maximum_exposure'|translate}}</label>
                            <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                formControlName="computeMaxExposure">
                                <option value="Y">{{'gis.policy.yes' | translate}}</option>
                                <option value="N">{{'gis.policy.no' | translate}}</option>

                            </select>

                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label class=" risk-label">{{'gis.policy.max_exposure_amount'|translate}}</label>
                            <input type="number" id="maxExposureAmount"
                                class="form-control form-control-sm mb-1 riskInput" formControlName="maxExposureAmount">

                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_id').hasError('required') && policyRiskForm.get('property_id').touched"
                                class="form-text text-danger">
                                Risk Town is required.
                            </div> -->
                        </div>
                        <div class=" mb-1 col-sm-4 col-12">
                            <label for="surveyDate" class="required risk-label"
                                id="surveyDate">{{'gis.policy.territory'|translate}}</label><br>
                            <p-dropdown formControlName="territory" [options]="countryList" optionValue="id"
                                optionLabel="name" [placeholder]="userCountryName" [filterBy]="'name'" [filter]="true"
                                [ngModel]="userCountryName"></p-dropdown>


                            <!-- Display error message under the field -->
                            <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                class="form-text text-danger">
                                Risk Address is required.
                            </div> -->
                        </div>

                    </div>
                    <!-- ROW 4 -->
                    <div class="row mb-4">

                        <div class="mb-1 col-sm-4 col-12">
                            <label for="newRisk" class="required risk-label"
                                id="riskLocation">{{'gis.policy.new_risk'|translate}}?</label>
                            <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                formControlName="newRisk">
                                <option value="Y">{{'gis.policy.yes' | translate}}</option>
                                <option value="N">{{'gis.policy.no' | translate}}</option>

                            </select>

                        </div>


                    </div>
                    <div class="collapse" id="collapseRiskOtherDetails">
                        <!-- ROW 5 -->
                        <div class="row mb-4">

                            <div class="mb-1 col-sm-4 col-12">
                                <label for="emlLocation" class="required risk-label"
                                    id="emlLocation">{{'gis.policy.eml_top_location_level'|translate}}</label>
                                <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                    formControlName="topLocationLevel">
                                    <option value="">RSK</option>
                                    <option value="">SEC</option>

                                </select>

                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <label class=" risk-label">{{'gis.policy.period_rates'|translate}}</label>
                                <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                    formControlName="periodRate">
                                    <option value="">{{'gis.policy.prorata'|translate}}</option>
                                    <option value="">{{'gis.policy.short_period_rates'|translate}}</option>
                                    <option value="">{{'gis.policy.full'|translate}}</option>

                                </select>


                                <!-- Display error message under the field -->
                                <!-- <div *ngIf="policyRiskForm.get('property_id').hasError('required') && policyRiskForm.get('property_id').touched"
                                    class="form-text text-danger">
                                    Risk Town is required.
                                </div> -->
                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"
                                        formControlName="retroactiveCover">
                                    <label class="risk-label form-check-label" for="flexCheckDefault">
                                        {{'gis.policy.retroactive_cover'|translate}}
                                    </label>
                                </div>
                                <!-- Display error message under the field -->
                                <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                    class="form-text text-danger">
                                    Risk Address is required.
                                </div> -->
                            </div>

                        </div>
                        <!-- ROW 6 -->
                        <div class="row mb-4">

                            <div class="mb-1 col-sm-4 col-12">
                                <div class="form-check pt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"
                                        formControlName="maintenanceCover">
                                    <label class="risk-label form-check-label" for="flexCheckDefault">
                                        {{'gis.policy.maintenance_cover'|translate}}
                                    </label>
                                </div>

                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <label for="surveyDate" class="required risk-label"
                                    id="surveyDate">{{'gis.policy.quake_flood_zone'|translate}}</label><br>

                                <p-dropdown [options]="quakeZoneList" optionValue="code" optionLabel="quakeZoneName"
                                    placeholder=" " [filterBy]="'quakeZoneName'" [filter]="true"
                                    formControlName="quakeFloodZone"></p-dropdown>



                                <!-- Display error message under the field -->
                                <!-- <div *ngIf="policyRiskForm.get('property_id').hasError('required') && policyRiskForm.get('property_id').touched"
                                    class="form-text text-danger">
                                    Risk Town is required.
                                </div> -->
                            </div>
                            <div class=" mb-1 col-sm-4 col-12">
                                <label for="surveyDate" class="required risk-label"
                                    id="surveyDate">{{'gis.policy.relational_group'|translate}}</label><br>
                                <p-dropdown [options]="" optionValue="code" optionLabel="description" placeholder=" "
                                    [filterBy]="'description'" [filter]="true"></p-dropdown>
                                <!-- Display error message under the field -->
                                <!-- <div *ngIf="policyRiskForm.get('property_description').hasError('required') && policyRiskForm.get('property_description').touched"
                                    class="form-text text-danger">
                                    Risk Address is required.
                                </div> -->
                            </div>

                        </div>
                        <!-- ROW 7 -->
                        <div class="row mb-4">

                            <div class="mb-1 col-sm-4 col-12">
                                <label for="newRisk" class="required risk-label"
                                    id="riskLocation">{{'gis.policy.risk_class'|translate}}</label>
                                <select class="form-select form-control-sm mb-1 ms-n4" id="product-input"
                                    formControlName="riskClass">
                                    <option value=""></option>
                                    <option value=""></option>
                                </select>

                            </div>


                        </div>
                    </div>
                    <p class="more " (click)="show=!show" data-bs-toggle="collapse"
                        data-bs-target="#collapseRiskOtherDetails" aria-expanded="false"
                        aria-controls="collapseExample"> {{'gis.policy.more_details' |
                        translate}}<span class="ml-1" data-toggle="collapse" data-target="#collapseRiskOtherDetails"
                            aria-expanded="false" aria-controls="collapseExample"> <i class="pi pi-angle-double-up"
                                style="font-size:13px" *ngIf="!show" data-toggle="collapse"
                                data-target="#collapseRiskOtherDetails"></i><i class="pi pi-angle-double-down"
                                style="font-size:13px" *ngIf="show" data-toggle="collapse"
                                data-target="#collapseRiskOtherDetails"></i></span> </p>
                </form>
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-primary mb-4" (click)="addPolicyRisk()">Save</button>
            </div>
        </div>
        <!-- SECTION DETAILS -->

        <div class="card mb-3 px-2" style=" position: relative;">
            <div class="card-body">

                <div class="row">
                    <div class="col-sm-3">
                        <p class="subheading">Section Details</p>

                    </div>
                    <div class="col-sm-9 d-flex justify-content-end">
                        <div class="row  mb-2">

                            <div class="col-sm-3"></div>
                            <div class="col-sm-3 me-4">
                                <button type="button" id="icon" class="btn btn-success" data-bs-toggle="modal"
                                    data-bs-target="#addSection" title="add">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            <!-- <div class="col-sm-1">
                                <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#editThirdDetails" title="Edit">
                                    <i class="fa-solid fa-pencil"></i>
                                </button>
                            </div> -->
                            <div class="col-sm-3">
                                <button type="button" id="icon" class="btn btn-danger" data-bs-toggle="modal"
                                    data-bs-target="#deleteCoinsurance" title="Delete">
                                    <i class="fa-solid fa-trash-can"></i>
                                </button>
                            </div>


                        </div>

                    </div>
                </div>
                <!-- Add Risk Section Modal -->
                <div class="modal fade" id="addSection" tabindex="-1" role="dialog" aria-labelledby="addSectionLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered " role="document">
                        <div class="modal-content" id="addSectionModal">
                            <div class="modal-body">
                                <h5 class="modal-title mt-2" id="riskOtherDetailsLabel">Risk Sections</h5>
                                <div class="search-container mb-3">
                                    <span class="search-icon"><i class="fa fa-search"></i></span>
                                    <input type="text" placeholder="Search" id="search-input-Rsection"
                                        [(ngModel)]="searchText" />
                                </div>
                                <!-- <div class="scrollable-list">
                    <div *ngFor="let section of filteredAllMatchingSections">
                      <div class="form-check" *ngIf="matchesSearch(section.description)">
                        <input class="form-check-input" type="checkbox" [id]="'checkbox-' + section.code" (change)="onCheckboxChange(section)" />
                        <label class="form-check-label" [for]="'checkbox-' + section.code">
                          {{ section.description }}
                        </label>
                      </div>
                      
                    </div>
                    
                  </div> -->
                                <div class="scrollable-list">
                                    <div *ngFor="let section of filteredAllMatchingSections">
                                        <div class="form-check" *ngIf="matchesSearch(section.description)">
                                            <input class="form-check-input" type="checkbox"
                                                [id]="'checkbox-' + section.code" [checked]="isSelected(section)"
                                                (change)="onCheckboxChange(section)" />
                                            <label class="form-check-label" [for]="'checkbox-' + section.code">
                                                {{ section.description }}
                                            </label>
                                        </div>
                                    </div>
                                </div>



                                <div class="mt-4 d-flex justify-content-end">
                                    <button type="button" class="btn btn-primary " id="saveDetails"
                                        data-bs-dismiss="modal" (click)="createRiskSection()">Save Details</button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <p-table *ngIf="!policySectionDetails" [value]="premiumList" dataKey="code" editMode="row"
                    [tableStyle]="{'min-width': '50rem'}" selectionMode="single" [(selection)]="selectedSection"
                    styleClass="p-datatable-sm" responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width:5%">Select</th>
                            <th style="width:8%">Group</th>
                            <th style="width:8%">RowNum</th>
                            <th style="width:10%">Code</th>
                            <th style="width:12%">Short Description</th>
                            <th style="width:10%">Description</th>
                            <th style="width:8%">Limit Amount</th>
                            <th style="width:10%">Premium Rate</th>
                            <th style="width:12%">Rate Type</th>
                            <!-- <th style="width:7%;"></th> -->

                            <!-- <th></th> -->
                            <!-- <th>Select</th>
                            <th>Group</th>
                            <th>RowNum</th>
                            <th>Code</th>
                            <th>Short Description</th>
                            <th>Description</th>
                            <th>Limit Amount</th>
                            <th>Premium Rate</th>
                            <th>Rate Type</th> -->

                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-premiumList let-editing="editing" let-ri="rowIndex">
                        <tr [pEditableRow]="premiumList">
                            <td>
                                <p-tableCheckbox [value]="selectedSection"></p-tableCheckbox>
                            </td>
                            <td></td>
                            <td></td>
                            <td>{{premiumList.sectionCode}}</td>
                            <td>{{premiumList.sectionShortDescription}}</td>
                            <td>{{premiumList.sectionShortDescription}}</td>
                            <td [pEditableRow]="premiumList.limitAmount" pEditableColumnField="limitAmount">
                                <!-- <input [(ngModel)]="section.limitAmount" class="cellEditorInput"/> -->
                                <input [(ngModel)]="premiumList.limitAmount" class="cellEditorInput" type="text">


                            </td>
                            <!-- <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input" >
                                        <input pInputText type="text" [(ngModel)]="premiumList.limitAmount"
                                            class="form-control form-control-sm" [ngModelOptions]="{standalone: true}">
                                            <input [(ngModel)]="premiumList.limitAmount" class="cellEditorInput" type="text">
                                    </ng-template>

                                    <ng-template pTemplate="output">
                                        {{premiumList.limitAmount}}
                                    </ng-template>
                                </p-cellEditor>
                            </td> -->
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="premiumList.rate"
                                            class="form-control form-control-sm" [ngModelOptions]="{standalone: true}">
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{premiumList.rate}}
                                    </ng-template>

                                </p-cellEditor>
                            </td>

                            <td>{{premiumList.rateType}}</td>



                            <td>
                                <!-- <div class="flex align-items-center justify-content-center gap-2">
                                    <button 
                                        *ngIf="!editing" 
                                        pButton 
                                        pRipple 
                                        type="button" 
                                        pInitEditableRow 
                                        icon="pi pi-pencil" 
                                         
                                        class="p-button-rounded p-button-text">
                                    </button>
                                    <button 
                                        *ngIf="editing" 
                                        pButton 
                                        pRipple 
                                        type="button" 
                                        pSaveEditableRow 
                                        icon="pi pi-check" 
                                        
                                        class="p-button-rounded p-button-text p-button-success mr-2">
                                    </button>
                                    <button 
                                        *ngIf="editing" 
                                        pButton pRipple 
                                        type="button" 
                                        pCancelEditableRow 
                                        icon="pi pi-times" 
                                         
                                        class="p-button-rounded p-button-text p-button-danger">
                                    </button>
                                </div> -->
                                <div class="flex align-items-center justify-content-center gap-2">
                                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow
                                        icon="pi pi-pencil" class="p-button-rounded p-button-text"></button>
                                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
                                        icon="pi pi-check"
                                        class="p-button-rounded p-button-text p-button-success mr-2"></button>
                                    <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow
                                        icon="pi pi-times"
                                        class="p-button-rounded p-button-text p-button-danger"></button>
                                </div>
                            </td>
                        </tr>


                    </ng-template>
                </p-table>


                <p-table *ngIf="policySectionDetails" [value]="policySectionDetails" dataKey="code" editMode="row"
                    [tableStyle]="{'min-width': '50rem'}" selectionMode="single" [(selection)]="selectedSection"
                    styleClass="p-datatable-sm" responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width:5%">Select</th>
                            <th style="width:8%">Group</th>
                            <th style="width:8%">RowNum</th>
                            <th style="width:10%">Code</th>
                            <th style="width:12%">Short Description</th>
                            <th style="width:10%">Description</th>
                            <th style="width:8%">Limit Amount</th>
                            <th style="width:10%">Premium Rate</th>
                            <th style="width:12%">Rate Type</th>
                            <!-- <th style="width:7%;"></th> -->

                            <!-- <th></th> -->
                            <!-- <th>Select</th>
                            <th>Group</th>
                            <th>RowNum</th>
                            <th>Code</th>
                            <th>Short Description</th>
                            <th>Description</th>
                            <th>Limit Amount</th>
                            <th>Premium Rate</th>
                            <th>Rate Type</th> -->

                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-premiumList let-editing="editing" let-ri="rowIndex">
                        <tr [pEditableRow]="premiumList">
                            <td>
                                <p-tableCheckbox [value]="selectedSection"></p-tableCheckbox>
                            </td>
                            <td></td>
                            <td></td>
                            <td>{{premiumList.sectionCode}}</td>
                            <td>{{premiumList.sectionShortDesc}}</td>
                            <td>{{premiumList.sectionDesc}}</td>
                            <td [pEditableRow]="premiumList.limitAmount" pEditableColumnField="limitAmount">
                                <!-- <input [(ngModel)]="section.limitAmount" class="cellEditorInput"/> -->
                                <input [(ngModel)]="premiumList.limitAmount" class="cellEditorInput" type="text">


                            </td>
                            <td>
                                <p-cellEditor>
                                    <ng-template pTemplate="input">
                                        <input pInputText type="text" [(ngModel)]="premiumList.rate"
                                            class="form-control form-control-sm" [ngModelOptions]="{standalone: true}">
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{premiumList.pilPremRate}}
                                    </ng-template>

                                </p-cellEditor>
                            </td>

                            <td>{{premiumList.rateType}}</td>



                            <td>
                                <!-- <div class="flex align-items-center justify-content-center gap-2">
                                    <button 
                                        *ngIf="!editing" 
                                        pButton 
                                        pRipple 
                                        type="button" 
                                        pInitEditableRow 
                                        icon="pi pi-pencil" 
                                         
                                        class="p-button-rounded p-button-text">
                                    </button>
                                    <button 
                                        *ngIf="editing" 
                                        pButton 
                                        pRipple 
                                        type="button" 
                                        pSaveEditableRow 
                                        icon="pi pi-check" 
                                        
                                        class="p-button-rounded p-button-text p-button-success mr-2">
                                    </button>
                                    <button 
                                        *ngIf="editing" 
                                        pButton pRipple 
                                        type="button" 
                                        pCancelEditableRow 
                                        icon="pi pi-times" 
                                         
                                        class="p-button-rounded p-button-text p-button-danger">
                                    </button>
                                </div> -->
                                <div class="flex align-items-center justify-content-center gap-2">
                                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow
                                        icon="pi pi-pencil" class="p-button-rounded p-button-text"></button>
                                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
                                        icon="pi pi-check"
                                        class="p-button-rounded p-button-text p-button-success mr-2"></button>
                                    <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow
                                        icon="pi pi-times"
                                        class="p-button-rounded p-button-text p-button-danger"></button>
                                </div>
                            </td>
                        </tr>


                    </ng-template>
                </p-table>
            </div>
        </div>


        <!-- SCHEDULE DETAILS -->
        <div class="card mb-3 px-2" style=" position: relative;">
            <div class="card-body">
                <p class="subheading">{{'gis.quotation.schedule_details' |translate}}</p>
                <p-tabView>
                    <p-tabPanel header="Motor Private Schedule">
                        <div class="row mb-4">
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-4">
                                        <p class="mt-1">{{'gis.policy.import_schedule' |translate}}</p>
                                    </div>
                                    <div class="col-8">
                                        <label for="fileInput"
                                            class="custom-file-upload mb-4">{{'gis.policy.from_csv_file'
                                            |translate}}</label>

                                        <span *ngIf="uploading === 'progress'" class="mx-3">
                                            <i class="pi pi-spin pi-spinner" style="color: #cccccc"></i>
                                        </span>


                                        <input type="file" id="fileInput" accept=".csv"
                                            (change)="onFileSelected($event)">

                                        <button class="btn btn-primary import-policy-button ms-2" data-bs-toggle="modal"
                                            data-bs-target="#importModal">{{'gis.policy.from_another_policy'
                                            |translate}}</button>
                                    </div>
                                    <!-- Modal -->
                                    <div class="modal fade" id="importModal" tabindex="-1"
                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog  modal-dialog-centered">
                                            <div class="modal-content">

                                                <div class="modal-body">
                                                    <p>Import a Schedule</p>
                                                    <!-- <input type="text" class="form-control form-control-sm w-50 mb-4"  placeholder="Search for a policy"> -->
                                                    <div class="input-group mb-3 w-50">
                                                        <input type="text" class="form-control form-control-sm "
                                                            placeholder="Search for a policy" aria-label="search"
                                                            aria-describedby="search" #policyNoInput>
                                                        <span class="input-group-text" id="search"
                                                            (click)="filterPolicies(policyNoInput.value)">
                                                            <i class="fa-solid fa-magnifying-glass"></i>
                                                        </span>
                                                    </div>

                                                </div>
                                                <p-table [value]="selectedPolicy" dataKey="code" editMode="row"
                                                    [tableStyle]="{'min-width': '10rem'}" selectionMode="single"
                                                    [(selection)]="selectedSection" styleClass="p-datatable-sm"
                                                    responsiveLayout="scroll" class='ui-datatable mb-4'
                                                    [autoLayout]="true">
                                                    <ng-template pTemplate="header">
                                                        <tr style="background-color: #F5F6F8;">

                                                            <th style="width:8%">Policy No.</th>
                                                            <th style="width:8%">Endorsement No.</th>
                                                            <th style="width:10%">Product</th>

                                                            <!-- <th style="width:7%;"></th> -->


                                                        </tr>
                                                    </ng-template>
                                                    <ng-template pTemplate="body" let-data let-editing="editing"
                                                        let-ri="rowIndex">
                                                        <tr>

                                                            <td>{{data.policyNo}}</td>
                                                            <td>{{data.endorsementNo}}</td>
                                                            <td>{{data.proCode}}</td>

                                                        </tr>


                                                    </ng-template>
                                                    <ng-template pTemplate="emptymessage">
                                                        <tr>
                                                            <td colspan="9" style="padding: 10px; text-align:center "
                                                                id="empty"> {{'gis.policy.no_data_to_display' |
                                                                translate}}
                                                            </td>
                                                        </tr>
                                                    </ng-template>
                                                </p-table>
                                                <div class="modal-body">
                                                    <p>Import a Risk</p>
                                                    <div class="input-group mb-3 w-50">
                                                        <input type="text" class="form-control form-control-sm "
                                                            placeholder="Search for a risk" aria-label="search"
                                                            aria-describedby="search" #riskNoInput>
                                                        <span class="input-group-text" id="search"
                                                            (click)="filterRisk(riskNoInput.value)">
                                                            <i class="fa-solid fa-magnifying-glass"></i>
                                                        </span>
                                                    </div>


                                                </div>
                                                <p-table [value]="selectedRisk" dataKey="code" editMode="row"
                                                    [tableStyle]="{'min-width': '10rem'}" selectionMode="single"
                                                    [(selection)]="selectedSection" styleClass="p-datatable-sm"
                                                    responsiveLayout="scroll" class='ui-datatable mb-4'
                                                    [autoLayout]="true">
                                                    <ng-template pTemplate="header">
                                                        <tr style="background-color: #F5F6F8;">

                                                            <!-- <th style="width:8%">Select</th> -->
                                                            <th style="width:8%">Risk Description</th>
                                                            <th style="width:8%">Risk Value</th>
                                                            <th style="width:8%">Subclass</th>
                                                            <!-- <th style="width:7%;"></th> -->


                                                        </tr>
                                                    </ng-template>
                                                    <ng-template pTemplate="body" let-data let-editing="editing"
                                                        let-ri="rowIndex">
                                                        <tr>

                                                            <td>{{data.propertyDescription}}</td>
                                                            <td></td>
                                                            <td>{{data.subClassCode}}</td>

                                                        </tr>


                                                    </ng-template>
                                                    <ng-template pTemplate="emptymessage">
                                                        <tr>
                                                            <td colspan="9" style="padding: 10px; text-align:center "
                                                                id="empty"> {{'gis.policy.no_data_to_display' |
                                                                translate}}
                                                            </td>
                                                        </tr>
                                                    </ng-template>
                                                </p-table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="col-2"></div> -->
                            <div class="col-6 d-flex justify-content-end">
                                <div class="row  mb-2">

                                    <div class="col-sm-6 me-3">
                                        <button class="btn btn-primary import-button" (click)="downloadCSVTemplate()"
                                            style="min-width: 141px;">Export Template</button>
                                    </div>

                                    <div class="col-sm-3 ms-2">
                                        <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                            data-bs-target="#editSchedule" title="Edit">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                    </div>
                                    <!--Edit Schedule Modal -->
                                    <div class="modal fade" id="editSchedule" tabindex="-1" role="dialog"
                                        aria-labelledby="editScheduleLabel" aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                            <div class="modal-content">




                                                <div class="modal-body">
                                                    <button type="button" class="btn-close ms-auto py-2 px-2 float-end"
                                                        data-bs-dismiss="modal" aria-label="Close" id="close"></button>
                                                    <h5 class="modal-title mt-2" id="editScheduleLabel">Edit Motor
                                                        Private Details</h5>
                                                    <form [formGroup]="scheduleDetailsForm">
                                                        <div formGroupName="details">
                                                            <div formGroupName="level1">
                                                                <!-- **ROW 1** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label required"
                                                                                id="scheduleLabel">Chasis no:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="chasisNumber">

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Age:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="yearOfManufacture">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 2** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Reg no:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="registrationNumber">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Vehicle make:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="Make">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 3** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Cubic
                                                                                capacity:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="cubicCapacity">

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Year of
                                                                                manufacture:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="yearOfManufacture">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 4** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Seating
                                                                                capacity:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="carryCapacity">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Value:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="value">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 5** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Body type:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="bodyType">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Cover type:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="coverType">

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 6** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Item no:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="coverType">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Colour:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 7** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Engine no:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="engineNumber">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Terrorism
                                                                                applicable:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option>Yes</option>
                                                                                    <option>No</option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 8** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Logbook no.:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="logBook">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Security device
                                                                                1:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 9** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Motor
                                                                                accessories.:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Model:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="bodyType">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 10** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Security
                                                                                device:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-select form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Regular driver
                                                                                name:</label>
                                                                            <div class="col-7">
                                                                                <select
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    id="scheduleInput"
                                                                                    formControlName="color">
                                                                                    <option></option>
                                                                                    <option></option>
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 11** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">SCH active:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Licence no.:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 12** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Driver licence
                                                                                date:</label>
                                                                            <div class="col-7">
                                                                                <input type="datetime"
                                                                                    id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Driver SMS
                                                                                no.:</label>
                                                                            <div class="col-7">
                                                                                <input type="number" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- **ROW 13** -->
                                                                <div class="row" id="scheduleRows">
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label "
                                                                                id="scheduleLabel">Driver relation
                                                                                insured:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xl-6">
                                                                        <div class="mb-3 row">
                                                                            <label for="minmax-buttons"
                                                                                class="col-5 col-form-label"
                                                                                id="scheduleLabel">Driver email
                                                                                address:</label>
                                                                            <div class="col-7">
                                                                                <input type="text" id="scheduleInput"
                                                                                    class="form-control form-control-sm mb-1"
                                                                                    formControlName="color">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>

                                                        <div class="row mt-3 mb-2 mx-3">
                                                            <div class="col-6 ">
                                                                <button type="button" class="btn btn-primary"
                                                                    (click)="clearForm()">Clear</button>

                                                            </div>
                                                            <div class="col-6 d-flex justify-content-end">
                                                                <button type="button" class="btn btn-outline-primary "
                                                                    id="
                                            " (click)="updateSchedule()" data-bs-dismiss="modal">Save Details</button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        <button type="button" id="icon" class="btn btn-danger" data-bs-toggle="modal"
                                            data-bs-target="#deleteCoinsurance" title="Delete">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </div>


                                </div>
                            </div>
                        </div>

                        <p-table [value]="csvRisksList" dataKey="code" editMode="row"
                            [tableStyle]="{'min-width': '50rem'}" selectionMode="single" [(selection)]="selectedSection"
                            styleClass="p-datatable-sm" responsiveLayout="scroll" class='ui-datatable'
                            [autoLayout]="true">
                            <ng-template pTemplate="header">
                                <tr class="mb-4">
                                    <th style="width:15%">Client ID</th>
                                    <th style="width:15%">Client Name</th>
                                    <th style="width:5%">WEF</th>
                                    <th style="width:7%">WET</th>
                                    <th style="width:15%">Risk Duplicated</th>
                                    <th style="width:10%">Class</th>
                                    <th style="width:15%">Cover Type</th>
                                    <th style="width:10%">Premium </th>
                                    <th style="width:12%">Taxes</th>
                                    <!-- <th style="width:7%;"></th> -->



                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-data let-editing="editing" let-ri="rowIndex">
                                <tr>
                                    <td>{{data.clientId}}</td>
                                    <td>{{data.clientName}}</td>
                                    <td>{{data.WEF}}</td>
                                    <td>{{data.WET}}</td>
                                    <td>{{data.riskDuplicated}}</td>
                                    <td>{{data.class}}</td>
                                    <td>{{data.coverType}}</td>
                                    <td>{{data.premium}}</td>
                                    <td>{{data.taxes}}</td>
                                </tr>


                            </ng-template>
                        </p-table>

                    </p-tabPanel>
                    <p-tabPanel header="Other Details">
                        <p>
                            Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium...
                        </p>
                    </p-tabPanel>
                    <p-tabPanel header="Principal Driver Details">
                        <p>
                            At vero eos et accusamus et iusto odio dignissimos...
                        </p>
                    </p-tabPanel>
                </p-tabView>
            </div>
        </div>

        <div class="d-flex justify-content-end">
            <button type="button" class="btn btn-primary" (click)="next()">{{'gis.policy.next' |
                translate}}</button>
        </div>
    </div>
</div>