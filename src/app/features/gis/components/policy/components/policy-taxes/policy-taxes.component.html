<div class="card riskDetailsCards">
    <div class="card-body">
        <div class="row ">
            <div class="col-sm-3">
                <p class="subheading"> Policy taxes</p>

            </div>

            <div class="col-sm-9 d-flex justify-content-end">
                <div class="row  mb-2">


                    <div class="col-6">
                        <button class="btn btn-primary import-button" (click)="populatePolicyTaxes()"
                            style="min-width: 141px;font-size:smaller;">Populate
                            taxes</button>
                    </div>
                    <div class="col-6">
                        <div class="row">
                            <div class="col-3">
                                <button type="button" id="icon" class="btn btn-success" data-bs-toggle="modal"
                                    data-bs-target="#policyTaxesModal" title="add">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            <div class="col-3">
                              
                                <button type="button" id="icon" class="btn btn-primary"
                                data-bs-toggle="modal" id="openPolicyTaxModalButtonEdit"
                                [hidden]="true" data-bs-target="#editPolicyTaxes" title="Edit">
                            </button>
                            <button type="button" id="icon" class="btn btn-primary"
                                title="Edit">
                                <i class="fa-solid fa-pencil"
                                    (click)="openPolicyTaxEditModal()"></i>
                            </button>


                            </div>
                            <div class="col-3">
                                <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                    id="openModalTaxButtonDelete" [hidden]="true" data-bs-target="#deleteTax"
                                    title="Delete">
                                </button>
                                <button type="button" id="icon" class="btn btn-primary" title="Delete">
                                    <i class="fa-solid fa-trash-can" (click)="openPolicyTaxDeleteModal()"></i>
                                </button>

                            </div>

                        </div>
                    </div>

                    <!-- <div class="col-1"></div> -->

                </div>

            </div>
        </div>
        <p-table #dt1 [value]="policyTaxes" dataKey="code" editMode="row" selectionMode="single"
            [(selection)]="selectedPolicyTax" [tableStyle]="{'min-width': '50rem'}" styleClass="p-datatable-sm"
            responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true">


            <ng-template pTemplate="header">
                <tr>
                    <th class="flexible-header">Description</th>
                    <th class="flexible-header">Code</th>
                    <th class="flexible-header">Rate</th>
                    <th class="flexible-header">Amount </th>
                    <th class="flexible-header">Level code </th>
                    <th class="flexible-header">Rate type</th>
                    <th class="flexible-header">Type</th>
                    <th class="flexible-header">Policy level</th>
                    <th class="flexible-header">Category</th>

                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-policyTaxes let-editing="editing" let-ri="rowIndex">
                <tr [pEditableRow]="policyTaxes" [pSelectableRow]="policyTaxes"
                    [class.p-highlight]="policyTaxes === selectedPolicyTax"
                    (click)="onEditPolicyTax(selectedPolicyTax)">
                    <td>{{policyTaxes.description}}</td>
                    <td></td>
                    <td>{{policyTaxes.rate}}</td>
                    <td>{{policyTaxes.amount}}</td>
                    <td></td>
                    <td>{{policyTaxes.rateType}}</td>
                    <td></td>
                    <td></td>
                    <td></td>



                </tr>
            </ng-template>
        </p-table>
        <!-- Add    Policy Taxes  Modal -->
        <div class="modal fade" id="policyTaxesModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">

                    <div class="modal-body">
                        <button type="button" #closebutton class="float-end btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                        <p class="text-start" id="selectClient">Applicable Taxes</p>

                        <p-table #dt3 [value]="applicableTaxesList" [tableStyle]="{'max-width': '465px'}"
                            selectionMode="single"  [(selection)]="selectedApplicableTax" [resizableColumns]="true" styleClass="p-datatable-sm"
                            responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true" [paginator]="true"
                            [rows]="5" [scrollable]="true" scrollDirection="horizontal" [showCurrentPageReport]="true"
                            currentPageReportTemplate=" {first} - {last} of {totalRecords}"
                            [globalFilterFields]="['description']">
                            <ng-template pTemplate="caption">
                                <div class="flex">
                                    <span class="p-input-icon-left ml-auto">
                                        <i class="pi pi-search search-icon"></i>
                                    </span>
                                    <input class="search-input" pInputText type="text"
                                        (input)="applyFilterGlobalTaxes($event, 'contains')" placeholder="Search" />

                                </div>
                            </ng-template>
                            <ng-template pTemplate="header">

                                <tr id="product">
                                    <th>Code</th>
                                    <th>Description</th>


                                </tr>
                            </ng-template>

                            <ng-template let-applicableTaxesList pTemplate="body">
                                <tr id="productData" [pSelectableRow]="" [pEditableRow]="applicableTaxesList"
                                    [pSelectableRow]="applicableTaxesList"
                                    [class.p-highlight]="applicableTaxesList === selectedApplicableTax"
                                    (click)="OnSelectApplicableTax(selectedApplicableTax)">

                                    <td> {{applicableTaxesList.code}} </td>
                                    <td>{{applicableTaxesList.description}} </td>

                                </tr>
                            </ng-template>

                        </p-table>
                        <br>
                        <!-- <button class="btn btn-primary float-end" data-bs-dismiss="modal" (click)="saveclient()">Save Details</button> -->
                    </div>



                </div>
            </div>
        </div>
         <!--Edit Policy Taxes Modal -->
         <div class="modal fade" #editrequiredDoc id="editPolicyTaxes" tabindex="-1"
         role="dialog" aria-labelledby="editPolicyTaxesLabel" aria-hidden="true">
         <div class="modal-dialog modal-dialog-centered " role="document">
             <div class="modal-content">
                 <div class="modal-body">
                     <button type="button"
                         class="btn-close ms-auto py-2 px-2 float-end"
                         data-bs-dismiss="modal" aria-label="Close"
                         id="close"></button>
                     <h5 class="modal-title mt-2 mb-3 ms-4" id="editrequiredDoc">
                        Edit policy taxes</h5>
                     <form [formGroup]="policyTaxesDetailsForm">
                         <!-- **ROW 1** -->
                         <div class="row mb-1" id="sectionRows">
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel"> Tax Description</label>
                                 </div>
                                 <div class="row">
                                     <input type="text" id="sectionInput"
                                         class="form-control form-control-sm mb-1 ms-2"
                                         formControlName="taxRateCode">
                                 </div>
                             </div>
                             <div class="col-xl-2"></div>
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel">
                                        Tax Type</label>
                                 </div>
                                 <div class="row">
                                     <input type="text" id="sectionInput"
                                         class="form-control form-control-sm mb-1 ms-2"
                                         formControlName="taxType">
                                 </div>
                             </div>
                         </div>
                         <!-- **ROW 2** -->
                         <div class="row mb-1" id="sectionRows">
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel">Transaction Type</label>
                                 </div>
                                 <div class="row">
                                     <select
                                         class="form-select form-control-sm mb-1 ms-2"
                                         id="selectedInput"
                                         formControlName="transactionLevel">
                                         <option value="UP">Underwriting Premium</option>
                                         <option value="SI">Sum Insured</option>
                                     </select>
                                 </div>
                             </div>
                             <div class="col-xl-2"></div>
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel">
                                         Computation Level</label>
                                 </div>
                                 <div class="row">
                                    <select
                                    class="form-select form-control-sm mb-1 ms-2"
                                    id="selectedInput"
                                    formControlName="companyLevel">
                                    <option value="P">Policy</option>
                                    <option value="R">Risk</option>
                                </select>
                                 </div>
                             </div>
                         </div>
                         <!-- **ROW 3** -->
                         <div class="row " id="sectionRows">
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel"> Rate</label>
                                 </div>
                                 <div class="row">
                                     <input type="number" id="sectionInput"
                                         class="form-control form-control-sm mb-1 ms-2"
                                         formControlName="rate">
                                 </div>
                             </div>
                             <div class="col-xl-2"></div>
                             <div class="col-xl-5">
                                 <div class="mb-1  row">
                                     <label for="minmax-buttons" class=""
                                         id="sectionLabel"> Amount</label>
                                 </div>
                                 <div class="row">
                                     <input type="number" id="sectionInput"
                                         class="form-control form-control-sm mb-1 ms-2"
                                         formControlName="amount">
                                 </div>
                             </div>
                         </div>
                     </form>
                     <div class="mt-4 d-flex justify-content-end">
                         <button type="button" class="btn btn-primary "
                             id="saveDetails" data-bs-dismiss="modal"
                             (click)="editPolicyTaxes()">{{'gis.policy.save_details'
                             |
                             translate}}</button>
                     </div>
                 </div>
             </div>
         </div>
     </div>
        <!-- Delete Policy Taxes Modal -->
        <div class="modal fade" id="deleteTax" tabindex="-1" role="dialog" aria-labelledby="deleteTax"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content" id="deleteTax">
                    <div class="modal-body ">
                        <p class="deleteMessage mt-4 mb-4">
                            {{'gis.policy.are_you_sure_you_want_to_delete' | translate}}</p>
                        <div class="d-flex justify-content-center mb-3">
                            <button type="button" class="btn btn-primary px-5" id="delete" data-bs-dismiss="modal"
                                (click)="deletePolicyTaxes()">{{'gis.policy.yes_delete' |
                                translate}}</button>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button type="button" class="btn btn-outline-primary px-5"
                                data-bs-dismiss="modal">{{'gis.policy.no_im_not' |
                                translate}}</button>
                        </div>



                    </div>
                </div>
            </div>
        </div>
    </div>
</div>