<div class="card mb-4">
    <div class="card-body">

        <div class="row ">
            <div class="col-sm-4">
                <p class="subheading"> {{'gis.policy.external_claim_exp' | translate}}</p>

            </div>
            <div class="col-sm-8 d-flex justify-content-end">
                <div class="row  mb-2">

                    <div class="col-sm-3"></div>
                    <div class="col-8">
                        <div class="row">
                            <div class="col-sm-4 ">
                                <button type="button" id="icon" class="btn btn-success" data-bs-toggle="modal"
                                    data-bs-target="#addExternalClaimExperienceModal" title="add">
                                    <i class="fa-solid fa-plus"></i>
                                </button>

                            </div>
                            <div class="col-sm-4">
                                <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#editExternalClaimExperienceModal" title="Edit">
                                    <i class="fa-solid fa-pencil"></i>
                                </button>

                            </div>

                            <div class="col-sm-4">
                                <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                    id="openExternalClaimModalButtonDelete" [hidden]="true" data-bs-target="#deleteExternalClaimExp"
                                    title="Delete">
                                </button>
                                <button type="button" id="icon" class="btn btn-primary" title="Delete">
                                    <i class="fa-solid fa-trash-can" (click)="openExternalClaimDeleteModal()"></i>
                                </button>
                                <!-- <button id="openModalButtonDelete" [hidden]="true"  data-bs-toggle="modal" data-bs-target="#deletePremium" >deletes</button>
                                        <a class="nav-link" id="links"  (click)="openDeleteModal()">Delete</a>
                                        <i class="fa-solid fa-trash-can"  id="icon" (click)="openDeleteModal()"></i> -->
                            </div>

                        </div>
                    </div>


                </div>

            </div>
        </div>
        <p-table #dt1 [value]="externalClaimList" dataKey="code" editMode="row" selectionMode="single"
            [(selection)]="selectedExternalClaim" [tableStyle]="{'min-width': '50rem'}" styleClass="p-datatable-sm"
            responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true">


            <ng-template pTemplate="header">
                <tr>
                    <th class="flexible-header">Policy no.</th>
                    <th class="flexible-header">Insurer</th>
                    <th class="flexible-header">Year</th>
                    <th class="flexible-header">Risk details</th>
                    <th class="flexible-header">Loss ratio</th>
                    <th class="flexible-header">Claim paid</th>
                    <th class="flexible-header">Remarks</th>
                    <th class="flexible-header">No. of accidents</th>
                    <th class="flexible-header">Damage amount</th>

                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-externalClaimList let-ri="rowIndex">
                <tr [pSelectableRow]="externalClaimList"
                    [class.p-highlight]="externalClaimList === selectedExternalClaim"
                    (click)="onSelectExternalClaim(selectedExternalClaim)">
                    <td>{{externalClaimList.policyNo}}</td>
                    <td>{{externalClaimList.insurer}}</td>
                    <td>{{externalClaimList.year}}</td>
                    <td>{{externalClaimList.riskDetails}}</td>
                    <td>{{externalClaimList.lossAmount}}</td>
                    <td>{{externalClaimList.claimPaid}}</td>
                    <td>{{externalClaimList.remarks}}</td>
                    <td>{{externalClaimList.noAcc}}</td>
                    <td>{{externalClaimList.damageAmount |number}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="1"></td>

                    <td colspan="10" style="padding:20px;padding-left: 300px;" id="empty">No data to display.</td>
                </tr>

            </ng-template>
        </p-table>
        <!-- ADD EXTERNAL CLAIM EXPEREIENCE -->
        <div class="modal fade" id="addExternalClaimExperienceModal" tabindex="-1" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-content">

                    <div class="modal-body">
                        <button type="button" #closebutton class="btn-close float-end" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                        <h5 class="modal-title" id="modalTitle">Define a new claims experience</h5>
                        <form [formGroup]="insurersDetailsForm">
                            <!-- ROW 1 -->
                            <div class="row mt-4 mb-2">
                                <div class="col-sm-6">
                                    <label for="policyNo" class="form-label external-claim-label">Policy no.</label>
                                    <input type="text" class="form-control external-claim-input" id="policyNo"
                                        placeholder="" formControlName="policyNo">
                                    <!-- Error message for Policy No. field -->
                                    <div *ngIf="insurersDetailsForm.get('policyNo').hasError('required') && insurersDetailsForm.get('policyNo').touched"
                                        class="form-text text-danger">
                                        Policy number is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="insurer" class="form-label external-claim-label">Insurer</label>
                                    <p-dropdown [options]="insuranceList" optionValue="name" optionLabel="name"
                                        formControlName="insurer" (onChange)="onInsurerSelected($event.value)"
                                        [filterBy]="'name'" [filter]="true"></p-dropdown>
                                    <div *ngIf="insurersDetailsForm.get('insurer').hasError('required') && insurersDetailsForm.get('insurer').touched"
                                        class="form-text text-danger">
                                        Insurer is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 2 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="year" class="form-label external-claim-label">Year</label>
                                    <input type="number" class="form-control external-claim-input" id="year"
                                        placeholder="" formControlName="year">
                                    <div *ngIf="insurersDetailsForm.get('year').hasError('required') && insurersDetailsForm.get('year').touched"
                                        class="form-text text-danger">
                                        Year is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="riskDetails" class="form-label external-claim-label">Risk
                                        details</label>
                                    <input type="text" class="form-control external-claim-input" id="riskDetails"
                                        placeholder="" formControlName="riskDetails">
                                    <div *ngIf="insurersDetailsForm.get('riskDetails').hasError('required') && insurersDetailsForm.get('riskDetails').touched"
                                        class="form-text text-danger">
                                        Risk details are required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 3 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="lossRatio" class="form-label external-claim-label">Loss ratio</label>
                                    <input type="number" class="form-control external-claim-input" id="lossRatio"
                                        placeholder="" formControlName="lossAmount">
                                    <div *ngIf="insurersDetailsForm.get('lossAmount').hasError('required') && insurersDetailsForm.get('lossAmount').touched"
                                        class="form-text text-danger">
                                        Loss ratio is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="claimPaid" class="form-label external-claim-label">Claim paid</label>
                                    <select class="form-select form-control-sm mb-1 ms-n4 selectInput"
                                        id="product-input" formControlName="claimPaid">
                                        <option value="Y">{{'gis.policy.yes' | translate}}</option>
                                        <option value="N">{{'gis.policy.no' | translate}}</option>

                                    </select>
                                    <div *ngIf="insurersDetailsForm.get('claimPaid').hasError('required') && insurersDetailsForm.get('claimPaid').touched"
                                        class="form-text text-danger">
                                        Claim paid is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 4 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="noOfAccidents" class="form-label external-claim-label">No. of
                                        accidents</label>
                                    <input type="number" class="form-control external-claim-input" id="noOfAccidents"
                                        placeholder="" formControlName="noAcc">
                                    <div *ngIf="insurersDetailsForm.get('noAcc').hasError('required') && insurersDetailsForm.get('noAcc').touched"
                                        class="form-text text-danger">
                                        No accidents is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="damageAmount" class="form-label external-claim-label">Damage
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="damageAmount"
                                        placeholder="" formControlName="damageAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('damageAmount').hasError('required') && insurersDetailsForm.get('damageAmount').touched"
                                        class="form-text text-danger">
                                        Damage amount is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 5 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="thirdPartyAmount" class="form-label external-claim-label">Third party
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="thirdPartyAmount"
                                        placeholder="" formControlName="totalPaidAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('totalPaidAmount').hasError('required') && insurersDetailsForm.get('totalPaidAmount').touched"
                                        class="form-text text-danger">
                                        Third party amount is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="otherAmount" class="form-label external-claim-label">Other
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="otherAmount"
                                        placeholder="" formControlName="otherAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('otherAmount').hasError('required') && insurersDetailsForm.get('otherAmount').touched"
                                        class="form-text text-danger">
                                        Other amount is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 6 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="thirdPartyAmount"
                                        class="form-label external-claim-label">Remarks</label>
                                    <input type="text" class="form-control external-claim-input" id="thirdPartyAmount"
                                        placeholder="" formControlName="remarks">

                                    <div *ngIf="insurersDetailsForm.get('remarks').hasError('required') && insurersDetailsForm.get('remarks').touched"
                                        class="form-text text-danger">
                                        Remarks are required
                                    </div>
                                </div>
                                <div class="col-sm-6">

                                </div>
                            </div>
                            <div class="d-flex justify-content-end mt-2 mb-2">
                                <button type="button" class="btn btn-primary" #closebutton
                                    (click)="createExternalClaimExp()">{{'crm.save_details' |
                                    translate}}</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
        <!-- EDIT EXTERNAL EXPERIENCE MODAL -->
        <div class="modal fade" id="editExternalClaimExperienceModal" tabindex="-1" aria-labelledby="editModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">


                    <div class="modal-body">
                        <button type="button" #closeEditClaimButton class="btn-close float-end" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                        <h5 class="modal-title" id="modalTitle">Edit a new claims experience</h5>
                        <form [formGroup]="insurersDetailsForm">
                            <!-- ROW 1 -->
                            <div class="row mt-4 mb-2">
                                <div class="col-sm-6">
                                    <label for="policyNo" class="form-label external-claim-label">Policy no.</label>
                                    <input type="text" class="form-control external-claim-input" id="policyNo"
                                        placeholder="" formControlName="policyNo">
                                    <!-- Error message for Policy No. field -->
                                    <div *ngIf="insurersDetailsForm.get('policyNo').hasError('required') && insurersDetailsForm.get('policyNo').touched"
                                        class="form-text text-danger">
                                        Policy number is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="insurer" class="form-label external-claim-label">Insurer</label>
                                    <p-dropdown [options]="insuranceList" optionValue="code" optionLabel="name"
                                        formControlName="insurer" (onChange)="onInsurerSelected($event.value)"
                                        [filterBy]="'name'" [filter]="true"></p-dropdown>
                                    <div *ngIf="insurersDetailsForm.get('insurer').hasError('required') && insurersDetailsForm.get('insurer').touched"
                                        class="form-text text-danger">
                                        Insurer is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 2 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="year" class="form-label external-claim-label">Year</label>
                                    <input type="number" class="form-control external-claim-input" id="year"
                                        placeholder="" formControlName="year">
                                    <div *ngIf="insurersDetailsForm.get('year').hasError('required') && insurersDetailsForm.get('year').touched"
                                        class="form-text text-danger">
                                        Year is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="riskDetails" class="form-label external-claim-label">Risk
                                        details</label>
                                    <input type="text" class="form-control external-claim-input" id="riskDetails"
                                        placeholder="" formControlName="riskDetails">
                                    <div *ngIf="insurersDetailsForm.get('riskDetails').hasError('required') && insurersDetailsForm.get('riskDetails').touched"
                                        class="form-text text-danger">
                                        Risk details are required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 3 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="lossRatio" class="form-label external-claim-label">Loss ratio</label>
                                    <input type="number" class="form-control external-claim-input" id="lossRatio"
                                        placeholder="" formControlName="lossAmount">
                                    <div *ngIf="insurersDetailsForm.get('lossAmount').hasError('required') && insurersDetailsForm.get('lossAmount').touched"
                                        class="form-text text-danger">
                                        Loss ratio is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="claimPaid" class="form-label external-claim-label">Claim paid</label>
                                    <select class="form-select form-control-sm mb-1 ms-n4 selectInput"
                                        id="product-input" formControlName="claimPaid">
                                        <option value="Y">{{'gis.policy.yes' | translate}}</option>
                                        <option value="N">{{'gis.policy.no' | translate}}</option>

                                    </select>
                                    <div *ngIf="insurersDetailsForm.get('claimPaid').hasError('required') && insurersDetailsForm.get('claimPaid').touched"
                                        class="form-text text-danger">
                                        Claim paid is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 4 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="noOfAccidents" class="form-label external-claim-label">No. of
                                        accidents</label>
                                    <input type="number" class="form-control external-claim-input" id="noOfAccidents"
                                        placeholder="" formControlName="noAcc">
                                    <div *ngIf="insurersDetailsForm.get('noAcc').hasError('required') && insurersDetailsForm.get('noAcc').touched"
                                        class="form-text text-danger">
                                        No accidents is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="damageAmount" class="form-label external-claim-label">Damage
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="damageAmount"
                                        placeholder="" formControlName="damageAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('damageAmount').hasError('required') && insurersDetailsForm.get('damageAmount').touched"
                                        class="form-text text-danger">
                                        Damage amount is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 5 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="thirdPartyAmount" class="form-label external-claim-label">Third party
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="thirdPartyAmount"
                                        placeholder="" formControlName="totalPaidAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('totalPaidAmount').hasError('required') && insurersDetailsForm.get('totalPaidAmount').touched"
                                        class="form-text text-danger">
                                        Third party amount is required
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <label for="otherAmount" class="form-label external-claim-label">Other
                                        amount</label>
                                    <input type="text" class="form-control external-claim-input" id="otherAmount"
                                        placeholder="" formControlName="otherAmount" appCommaFormat>
                                    <div *ngIf="insurersDetailsForm.get('otherAmount').hasError('required') && insurersDetailsForm.get('otherAmount').touched"
                                        class="form-text text-danger">
                                        Other amount is required
                                    </div>
                                </div>
                            </div>
                            <!-- ROW 6 -->
                            <div class="row mb-2">
                                <div class="col-sm-6">
                                    <label for="thirdPartyAmount"
                                        class="form-label external-claim-label">Remarks</label>
                                    <input type="text" class="form-control external-claim-input" id="thirdPartyAmount"
                                        placeholder="" formControlName="remarks">

                                    <div *ngIf="insurersDetailsForm.get('remarks').hasError('required') && insurersDetailsForm.get('remarks').touched"
                                        class="form-text text-danger">
                                        Remarks are required
                                    </div>
                                </div>
                                <div class="col-sm-6">

                                </div>
                            </div>
                            <div class="d-flex justify-content-end mt-2 mb-2">
                                <button type="button" class="btn btn-primary" #closeEditClaimButton
                                    (click)="editExternalClaimExp()">{{'crm.save_details' |
                                    translate}}</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>
        </div>

        <!-- DELETE EXTERNAL EXPERIENCE MODAL -->
        <div class="modal fade" id="deleteExternalClaimExp" tabindex="-1" role="dialog" aria-labelledby="deleteInsured"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content" id="deleteInsured">
                    <div class="modal-body ">
                        <p class="deleteMessage mt-4 mb-4">
                            {{'gis.policy.are_you_sure_you_want_to_delete' | translate}}</p>
                        <div class="d-flex justify-content-center mb-3">
                            <button type="button" class="btn btn-primary px-5" id="delete"
                                data-bs-dismiss="modal" (click)="deleteExternalClaimExp()">{{'gis.policy.yes_delete' |
                                translate}}</button>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button type="button" class="btn btn-outline-primary px-5"
                                data-bs-dismiss="modal">{{'gis.policy.no_im_not' |
                                translate}}</button>
                        </div>



                    </div>
                </div>
            </div>
        </div>



    </div>