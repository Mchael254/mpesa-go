<!-- RISK DETAILS CARD -->
<div class="card  mb-3 border-0">
    <div class="card-body border-0" style="padding-top: 0px;">

        <p-table [value]="riskDetails" [tableStyle]="{'min-width': '300px'}" selectionMode="single" dataKey="code">
            <ng-template pTemplate="header">
                <tr>
                    <th class="flexible-header">{{'gis.quotation.risk_id' | translate}}</th>
                    <th class="flexible-header"> {{'gis.quotation.risk_description' | translate}}</th>
                    <th class="flexible-header"> {{'gis.quotation.subclass' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.cover_type' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.premium_band' | translate}}</th>
                    <th class="flexible-header"> {{'gis.quotation.cover_from' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.cover_to' | translate}}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-ri="rowIndex" let-risk>
                <tr [class.p-highlight]="risk === selectedRisk" [pSelectableRow]="riskDetails" class="point"
                    (click)="handleRowClick(risk)">
                    <td>{{risk.propertyId}}</td>
                    <td>{{risk.itemDesc}}</td>
                    <td>{{risk.subclass.description}}</td>
                    <td>{{risk.coverTypeDescription}}</td>
                    <td>{{risk.binderCode}}</td>
                    <td>{{risk.wef}}</td>
                    <td>{{risk.wet}}</td>

                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="8" style="padding: 20px; text-align:center" id="empty">
                        No risk Click on + icon to add risk</td>
                </tr>
            </ng-template>
        </p-table>
        <!-- Add Risk  Modal -->
        <div class="modal fade" id="addRisk" #addRiskModal tabindex="-1" role="dialog" aria-labelledby="addRiskLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 700px;">
                <div class="modal-content" id="addRiskModal">
                    <div class="modal-body" style="max-height: 504px; overflow-y: auto;min-height: 304px;">
                        <h5 class="modal-title mt-2 mb-2 addRiskTitle ">Add risk
                            <button type="button" class="btn-close float-end" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </h5>


                        <form [formGroup]="riskDetailsForm">
                            <div class="row ">
                                <ng-container *ngFor="let field of formData; let i = index">
                                    <div class="col-sm-6 col-6 mb-4">
                                        <div class="form-group form-group-sm">
                                            <label *ngIf="field.name" [attr.for]="i + field.name" id="quote-label"
                                                [ngClass]="{ 'required': field.isMandatory === 'Y' }">
                                                {{ field.label | translate }}
                                            </label>

                                            <!-- text input -->
                                            <input *ngIf="field.type === 'text'" type="text" class="form-control"
                                                [formControlName]="field.name"
                                                [attr.placeholder]="field.label | translate" />

                                            <!-- select -->

                                            <ng-container
                                                *ngIf="field.name !== 'insureds' && riskDetailsForm && riskDetailsForm.contains(field.name)">
                                                <p-dropdown *ngIf="field.type === 'select'"
                                                    [formControlName]="field.name" [options]="field.selectOptions"
                                                    optionLabel="label" optionValue="value" [filter]="true"
                                                    [showClear]="true" [attr.placeholder]="field.label | translate"
                                                    (onChange)="field.name === 'subclass' && onSubclassSelected($event)">
                                                </p-dropdown>
                                            </ng-container>
                                            <!-- INSURED -->
                                            <ng-container *ngIf="field.name === 'insureds' && clientsData?.length">
                                                <p-dropdown formControlName="insureds" [options]="clientsData"
                                                    optionLabel="clientFullName" optionValue="id"
                                                    placeholder="Select Insured" [filter]="true"
                                                    filterBy="clientFullName">
                                                </p-dropdown>
                                            </ng-container>

                                            <!-- date -->
                                            <p-calendar *ngIf="field.type === 'date'" [formControlName]="field.name"
                                                dateFormat="yy-mm-dd" [showIcon]="true"
                                                [attr.placeholder]="field.label | translate">
                                            </p-calendar>

                                            <!-- number -->
                                            <input *ngIf="field.type === 'number'" type="text" class="form-control"
                                                [formControlName]="field.name"
                                                [attr.placeholder]="field.label | translate" />

                                            <!-- currency -->
                                            <input *ngIf="field.type === 'currency'" type="text" class="form-control"
                                                currencyMask [options]="currencyObj" [formControlName]="field.name"
                                                [attr.placeholder]="field.label | translate" />

                                            <!-- validation -->
                                            <div *ngIf="
                                                riskDetailsForm.get(field.name)?.invalid &&
                                                riskDetailsForm.get(field.name)?.touched"
                                                class="text-danger small mt-1">
                                                {{ field.label | translate }} is required.
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>


                                <!-- dynamic subclass fields -->
                                <ng-container *ngFor="let field of subclassFormData; let j = index">
                                    <div class="col-sm-6 col-6 mb-4">
                                        <div class="form-group form-group-sm">
                                            <label *ngIf="field.name" [attr.for]="j + field.name" id="quote-label"
                                                [ngClass]="{ required: field.isMandatory === 'Y' }">
                                                {{ field.label | translate }}
                                            </label>

                                            <!-- text input fields -->
                                            <ng-container
                                                *ngIf="field.name !== 'registrationNumber' && field.name !== 'riskDescription' && riskDetailsForm && riskDetailsForm.contains(field.name)">
                                                <input *ngIf="field.type === 'text'" type="text" class="form-control"
                                                    [formControlName]="field.name"
                                                    [attr.placeholder]="field.label | translate" />
                                            </ng-container>

                                            <ng-container *ngIf="field.name === 'registrationNumber'">
                                                <input type="text" id="quote-input"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="registrationNumber"
                                                    (input)="riskIdPassed($event); transformToUpperCase($event)"
                                                    placeholder="KAA 123X">
                                            </ng-container>
                                            <ng-container *ngIf="field.name === 'riskDescription'">
                                                <input type="text" id="quote-input"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="riskDescription" [value]="vehiclemakeModel"
                                                    readonly>
                                            </ng-container>

                                            <!-- select fields -->
                                            <ng-container
                                                *ngIf="field.name !== 'yearOfManufacture' && riskDetailsForm && riskDetailsForm.contains(field.name)">
                                                <p-dropdown *ngIf="field.type === 'select'"
                                                    [formControlName]="field.name" [options]="field.selectOptions"
                                                    optionLabel="label" optionValue="value" [filter]="true"
                                                    [showClear]="true" [attr.placeholder]="field.label | translate"
                                                    (onChange)="handleSelectChange(field.name, $event)">
                                                </p-dropdown>
                                            </ng-container>
                                            <!-- YEAR OF MANUFACTURE -->
                                            <ng-container *ngIf="field.name === 'yearOfManufacture'">
                                                <p-dropdown formControlName="yearOfManufacture" [options]="yearList"
                                                    placeholder="" [filter]="true">
                                                </p-dropdown>

                                            </ng-container>

                                            <!-- DATE -->
                                            <p-calendar *ngIf="field.type === 'date'" [formControlName]="field.name"
                                                dateFormat="yy-mm-dd" [showIcon]="true"
                                                [attr.placeholder]="field.label | translate">
                                            </p-calendar>

                                            <!-- number -->
                                            <input *ngIf="field.type === 'number'" type="text" class="form-control"
                                                [formControlName]="field.name"
                                                [attr.placeholder]="field.label | translate" />

                                            <!-- currency -->
                                            <input *ngIf="field.type === 'currency'" type="text" class="form-control"
                                                currencyMask [options]="currencyObj" [formControlName]="field.name"
                                                [attr.placeholder]="field.label | translate" />
                                            <div *ngIf="riskDetailsForm.get(field.name)?.touched && riskDetailsForm.get(field.name)?.errors as errors"
                                                class="text-danger small mt-1">

                                                <div *ngIf="errors['required']">
                                                    {{ field.label | translate }} is required.
                                                </div>

                                                <div *ngIf="errors['pattern']">
                                                    {{ field.label | translate }} format is invalid.
                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </form>






                        <div class="mt-4 d-flex justify-content-end">
                            <button type="button" class="btn btn-outline-primary mx-2" id="saveDetails"
                                data-bs-dismiss="modal">{{'gis.policy.cancel' | translate}}</button>
                            <button type="button" class="btn btn-primary " id="saveDetails"
                                (click)="createRiskDetail()">{{'gis.quotation.save_details' | translate}}</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- Edit Risk  Modal -->
        <div class="modal fade" id="editRisk" tabindex="-1" role="dialog" aria-labelledby="addRiskLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content" id="addRiskModal">
                    <div class="modal-body">
                        <h5 class="modal-title mt-2" id="editOtherDetailsLabel">{{'gis.quotation.risk_details' |
                            translate}}
                            <button type="button" class="btn-close float-end" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </h5>
                        <div class="row mb-4 " [formGroup]='editRiskDetailsForm'>
                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label">{{'gis.quotation.insured' |
                                        translate}}</label>
                                    <input type="text" id="quote-input" class="form-control form-control-sm mb-1"
                                        [value]="clientName |sentenceCase" readonly>

                                </div>
                            </div>

                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label"
                                        class="required">{{'gis.quotation.subclass' |
                                        translate}}</label>
                                    <p-dropdown formControlName="subclassCode" [options]="allMatchingSubclasses"
                                        optionLabel="description" [filterBy]="'description'" [filter]="true"
                                        (onChange)="onSubclassSelected($event);"></p-dropdown>

                                </div>
                            </div>
                            <!-- MOTOR SUBCLASS FIELD -->
                            <div class="col-sm-6 col-6" *ngIf="showMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label"> {{'gis.quotation.vehicle_make' |
                                        translate}}</label>

                                    <p-dropdown formControlName="vehicleMake" [options]="vehicleMakeList"
                                        optionLabel="name" [filterBy]="'name'" [filter]="true"
                                        (onChange)="onVehicleMakeSelected($event);"></p-dropdown>
                                </div>
                            </div>
                            <div class="col-sm-6 col-6" *ngIf="showMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label"> {{'gis.quotation.vehicle_model' |
                                        translate}}</label>
                                    <p-dropdown formControlName="vehicleModel" [options]="vehicleModelDetails"
                                        optionLabel="name" [filterBy]="'name'" [filter]="true"
                                        (onChange)="onVehicleModelSelected($event);"></p-dropdown>
                                </div>
                            </div>
                            <div class="col-sm-6 col-6" *ngIf="showMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label"> {{'gis.quotation.risk_id' |
                                        translate}}</label>
                                    <!-- <input type="text" id="quote-input" class="form-control form-control-sm mb-1" formControlName="propertyId" [(ngModel)]="passedRiskId" (change)="riskIdPassed()">   -->
                                    <input type="text" id="quote-input" class="form-control form-control-sm mb-1"
                                        formControlName="propertyId"
                                        (input)="riskIdPassed($event); transformToUpperCase($event)"
                                        placeholder="KAA 123X">
                                    <div *ngIf="riskDetailsForm?.get('propertyId')?.hasError('pattern') && riskDetailsForm?.get('propertyId').touched"
                                        class="form-text text-danger">
                                        {{'gis.quotation.risk_id' | translate}} is invalid
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-6" *ngIf="showMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label" class="required">
                                        {{'gis.quotation.risk_description' |
                                        translate}}</label>
                                    <input type="text" id="quote-input" class="form-control form-control-sm mb-1"
                                        formControlName="itemDesc" [value]="vehiclemakeModel" readonly>

                                </div>
                            </div>
                            <!-- NON MOTOR FIELDS -->
                            <div class="col-sm-6 col-6" *ngIf="showNonMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label"> {{'gis.quotation.risk_id' |
                                        translate}}</label>
                                    <!-- <input type="text" id="quote-input" class="form-control form-control-sm mb-1" formControlName="propertyId" [(ngModel)]="passedRiskId" (change)="riskIdPassed()">   -->
                                    <input type="text" id="quote-input" class="form-control form-control-sm mb-1"
                                        formControlName="propertyId">
                                    <div *ngIf="riskDetailsForm?.get('propertyId')?.hasError('pattern') && riskDetailsForm?.get('propertyId').touched"
                                        class="form-text text-danger">
                                        {{'gis.quotation.risk_id' | translate}} is invalid
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-6" *ngIf="showNonMotorSubclassFields">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label" class="required">
                                        {{'gis.quotation.risk_description' |
                                        translate}}</label>
                                    <input type="text" id="quote-input" class="form-control form-control-sm mb-1"
                                        formControlName="itemDesc">

                                </div>
                            </div>
                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label" class="required">
                                        {{'gis.quotation.cover_type' |
                                        translate}}</label>
                                    <p-dropdown formControlName="coverTypeDescription" [options]="subclassCoverType"
                                        optionLabel="description" optionValue="description" [filterBy]="'description'"
                                        [filter]="true" (onChange)="onCoverTypeSelected($event);"></p-dropdown>

                                </div>
                            </div>
                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="minmax-buttons" id="quote-label" class="required">
                                        {{'gis.quotation.premium_band' |
                                        translate}}</label>
                                    <p-dropdown formControlName="binderCode" [options]="binderListDetails"
                                        optionLabel="binder_name" [filterBy]="'binder_name'" [filter]="true"
                                        (onChange)="onBinderSelected($event);"></p-dropdown>

                                </div>
                            </div>

                            <!-- date fields -->
                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="" id="quote-label"> {{'gis.quotation.cover_from' | translate}}</label>
                                    <p-calendar formControlName="wef" name="wef" id="coverFromDate"
                                        inputId="coverFromDate" [dateFormat]="dateFormat" inputStyleClass='form-control'
                                        [showIcon]="true" (onSelect)="updateCoverToDate($event)" [minDate]="minDate">
                                    </p-calendar>

                                </div>
                            </div>
                            <div class="col-sm-6 col-6">
                                <div class="form-group form-group-sm">
                                    <br>
                                    <label for="" id="quote-label"> {{'gis.quotation.cover_to' | translate}}</label>
                                    <p-calendar formControlName="wet" name="wet" id="coverToDate" inputId="coverToDate"
                                        [dateFormat]="dateFormat" inputStyleClass='form-control' [showIcon]="true"
                                        [minDate]="minDate">
                                    </p-calendar>
                                </div>
                            </div>

                        </div>



                        <div class="mt-4 d-flex justify-content-end">
                            <button type="button" class="btn btn-outline-primary mx-2" id="saveDetails"
                                data-bs-dismiss="modal">{{'gis.policy.cancel' | translate}}</button>
                            <button type="button" class="btn btn-primary " id="saveDetails" data-bs-dismiss="modal"
                                (click)="updateRiskDetails()">{{'gis.quotation.save_details' | translate}}</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- Delete Risk Modal -->
        <div class="modal fade" id="deleteRisk" tabindex="-1" role="dialog" aria-labelledby="deleteProduct"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content" id="deleteProduct">
                    <div class="modal-body ">
                        <p class="deleteMessage mt-4 mb-4">{{'gis.policy.are_you_sure_you_want_to_delete' |
                            translate}}</p>
                        <div class="d-flex justify-content-center mb-3">
                            <button type="button" class="btn btn-primary px-5" id="delete" data-bs-dismiss="modal"
                                (click)="deleteRisk()">{{'gis.policy.yes_delete'
                                | translate}}</button>
                        </div>
                        <div class="d-flex justify-content-center mb-2">
                            <button type="button" class="btn btn-outline-primary px-5"
                                data-bs-dismiss="modal">{{'gis.policy.no_im_not' | translate}}</button>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- SCHEDULE DETAILS CARD -->
<div class="card  mb-3">
    <div class="card-body">

        <!-- Tabs Header -->
        <div class="d-flex justify-content-between align-items-center flex-wrap">
            <div class="nav-tabs-wrapper overflow-auto flex-grow-1 me-3">
                <ul class="nav nav-tabs flex-nowrap mb-0" style="min-width: max-content;">
                    <li class="nav-item" *ngFor="let tab of tabs">
                        <a class="nav-link" [ngClass]="{ 'active-tab': activeTab === tab }" (click)="activeTab = tab">{{
                            tab
                            }}</a>
                    </li>
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex align-items-center gap-2 mt-2 mt-md-0">
                <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal"
                    data-bs-target="#deleteRisk">
                    Import risk
                </button>
                <button type="button" class="btn btn-primary btn-sm">
                    Add risk
                </button>
                <i class="pi border border-black p-1 rounded-1 text-black"
                    [ngClass]="{ 'pi-caret-up': isCollapsibleOpen, 'pi-caret-down': !isCollapsibleOpen }"
                    style="font-size: 13px; cursor: pointer; margin-left: 18px;"></i>
            </div>
        </div>

        <!-- Tab Content -->
        <p-table [value]="scheduleList" selectionMode="single" [(selection)]="selectedSchedule" dataKey="code">
            <ng-template pTemplate="header">
                <tr>
                    <th class="flexible-header">{{'gis.quotation.reg_no' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.vehicle_make' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.cubic_capacity' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.year_of_manufacture' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.seating_capacity' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.value' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.body_type' | translate}}</th>
                    <th class="flexible-header">{{'gis.quotation.cover_type' | translate}}</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-schedule>
                <tr (click)="onSelectSchedule(schedule)" [pEditableRow]="schedule"
                    [class.p-highlight]="schedule === selectedSchedule">
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                    <td class="flexible-header"></td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="8" style="padding: 20px; text-align: center">
                        {{ 'gis.quotation.no_data_to_display' | translate }}
                    </td>
                </tr>
            </ng-template>
        </p-table>

    </div>
</div>
<!-- SECTION DETAILS CARD -->
<div class="card mb-3">
    <div class="card-body">
        <div class="row">
            <div class="col-4 section-title">
                <strong> {{'gis.quotation.section_details' | translate}}</strong>
            </div>
            <div class="col-8 d-flex justify-content-end">
                <div class="row">
                    <!-- <div class="col-4" *ngIf="isSectionDetailsOpen">
                            <button id="openModalButtonAdd"  data-bs-toggle="modal"
                                data-bs-target="#addSection">Add section</button>
                             <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                data-bs-target="#addSection" title="Edit">
                                <i class="fa-solid fa-plus"></i>
                            </button> -->
                    <!-- </div>  -->
                    <!-- <div class="col-3" *ngIf="isSectionDetailsOpen">
                  <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editSection" title="Edit">
                    <i class="fa-solid fa-pencil"></i>
                  </button>
                </div> -->
                    <!-- <div class="col-4" *ngIf="isSectionDetailsOpen">
                            <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="modal"
                                data-bs-target="#deleteSection" title="Delete">
                                <i class="fa-solid fa-trash-can"></i>
                            </button>
                        </div> -->
                    <div class="col-4 ">
                        <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="collapse"
                            data-bs-target="#sectionDetails" aria-expanded="false"
                            [attr.aria-expanded]="isSectionDetailsOpen" (click)="toggleSectionDetails()">
                            <i class="fa-solid"
                                [ngClass]="isSectionDetailsOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
                        </button>
                    </div>
                </div>

            </div>
            <!-- ADD SECTION BUTTON ROW -->
            <div class="row mt-3" *ngIf="isSectionDetailsOpen">
                <div class="col-12 d-flex justify-content-end">
                    <button id="openModalButtonAdd" class="btn btn-primary btn-sm" data-bs-toggle="modal"
                        (click)="openAddSectionModal()"> Add Section
                    </button>

                    <i class="pi border border-black p-1 rounded-1 text-black" [ngClass]="{
                   'pi-caret-up': showSections,
                   'pi-caret-down': !showSections
                 }" style="font-size: 15px; cursor: pointer; margin-left: 8px; padding: 4px 6px;"
                        (click)="toggleSections()"></i>

                </div>
            </div>
        </div>


        <div [@slideInOut]="isSectionDetailsOpen ? 'open' : 'closed'" class="mt-2">

            <!-- Add Risk Section Modal -->

            <div class="modal fade" #addRiskSection Modal id="addSection" tabindex="-1" role="dialog"
                aria-labelledby="addSectionLabel">
                <div class="modal-dialog modal-dialog-centered" style="min-width: 708px;" role="document">
                    <div class="modal-content" id="addSectionModal">
                        <div class="modal-body">
                            <h5 class="modal-title mt-2" id="editOtherDetailsLabel">Add risk section
                                <button type="button" class="btn-close red-close float-end" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </h5>

                            <!-- <div class="search-container mb-3">
                  <span class="search-icon"><i class="fa fa-search"></i></span>
                  <input type="text" placeholder="Search" id="search-input-Rsection" [(ngModel)]="searchText" />
                </div> -->
                            <!-- <div class="scrollable-list">
                  <div *ngFor="let section of sectionPremium">
                    <div class="form-check" *ngIf="matchesSearch(section.sectionShortDescription)">
                      <input class="form-check-input" type="checkbox" [id]="'checkbox-' + section.code"
                        (change)="onCheckboxChange(section)" />
                      <label class="form-check-label" [for]="'checkbox-' + section.code">
                        {{ section.sectionShortDescription }}
                      </label>
                    </div>
                  </div>
                </div> -->
                            <!-- <input pInputText type="text" (input)="sectionTable.filterGlobal($event.target.value, 'contains')" placeholder="Search..." #sectionTable> -->
                            <!-- <input class="form-control-sm mb-2" id="search-input-Rsection" pInputText type="text"
                                (input)="applyGlobalFilter($event)" placeholder="Search..."> -->

                            <p-table #sectionTable [value]="sectionPremium" id="clientTable" dataKey="code"
                                [tableStyle]="{ 'max-width': '50rem', 'border-spacing': '10 10px' }"
                                [(selection)]="selectedSections" [resizableColumns]="true" responsiveLayout="scroll"
                                class='ui-datatable' [autoLayout]="true" [paginator]="true" [rows]="5"
                                [rowsPerPageOptions]="[5, 10, 20]" [scrollable]="true" scrollDirection="horizontal"
                                [showCurrentPageReport]="true"
                                currentPageReportTemplate="{first} - {last} of {totalRecords}"
                                [globalFilterFields]="['sectionDescription']">
                                <ng-template pTemplate="header">
                                    <tr>

                                        <th style="width: 2%;">
                                            <input type="checkbox" [(ngModel)]="selectAll"
                                                (change)="toggleSelectAll($event)" />
                                        </th>

                                        <th class="equal-width " pSortableColumn="sectionDescription"> {{
                                            'gis.quotation.benefit' |
                                            translate }}<p-sortIcon field="benefit" /></th>
                                        <th class="equal-width" pSortableColumn="free_limit"> {{
                                            'gis.quotation.free_limit' | translate }}<p-sortIcon field="free_limit" />
                                        </th>
                                        <th class="equal-width" pSortableColumn="limit of amount"> {{
                                            'gis.quotation.limit_amount' | translate }}<p-sortIcon
                                                field="limit of amount" /></th>
                                        <th class="equal-width" pSortableColumn="rate"> {{ 'gis.quotation.rate' |
                                            translate }} <p-sortIcon field="rate" /></th>

                                    </tr>
                                    <tr>
                                        <td colspan="5" style="padding-left: 50px;">
                                            <input #globalFilterInput class="form-control form-control-sm my-2"
                                                id="search-input-Rsection" pInputText type="text"
                                                (input)="sectionTable.filterGlobal(globalFilterInput.value, 'contains')"
                                                placeholder=""
                                                style="width: 100px; margin-top: 6px; margin-bottom: 6px;" />
                                        </td>
                                    </tr>

                                </ng-template>
                                <ng-template pTemplate="emptymessage">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted py-3">
                                            No sections found matching your search.
                                        </td>
                                    </tr>
                                </ng-template>

                                <ng-template pTemplate="body" let-section let-editing="editing" let-i="rowIndex">
                                    <tr style="height: 40px; padding: 10px; margin-bottom: 10px;">
                                        <td>
                                            <input type="checkbox" id="check_section_{{ section.sectionCode }}"
                                                [(ngModel)]="section.isChecked">
                                        </td>
                                        <td class="equal-width">{{ section.sectionDescription |sentenceCase }}</td>
                                        <td class="equal-width">{{ section.freeLimit | number }}</td>
                                        <td class="equal-width" [pEditableColumn]="section.limitAmount"
                                            pEditableColumnField="limitAmount">
                                            <input class=" form-control form-control-sm narrow-input error-border"
                                                id="section_{{ section.sectionCode }}" [(ngModel)]="section.limitAmount"
                                                [options]="currencyObj" currencyMask type="text"
                                                (keydown)="onKeyUp($event, section)"
                                                [ngClass]="{'error-border': section.isChecked && !section.limitAmount}">
                                        </td>
                                        <td class="equal-width" [pEditableColumn]="section.rate"
                                            pEditableColumnField="rate">
                                            <input class="form-control form-control-sm narrow-input error-border"
                                                id="section_{{ section.sectionCode }}" [(ngModel)]="section.rate"
                                                type="number" (keydown)="onKeyUp($event, section)"
                                                [ngClass]="{'error-border': section.isChecked && !section.rate}">
                                        </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                            <div class="mt-4 d-flex justify-content-end ">
                                <button type="button" class="btn btn-outline-primary me-2"
                                    data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary " id="saveDetails" data-bs-dismiss="modal"
                                    (click)="createRiskLimitsNew()">{{'gis.quotation.save_details' |
                                    translate}}</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Edit Risk Section Modal -->
            <div class="modal fade  " id="editSectionModal" #editSectionModal tabindex="-1" role="dialog"
                aria-labelledby="editSectionLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-body" style="padding-left: 40px; max-height:650px;overflow-y: auto;">
                            <h5 class="modal-title mt-2" id="editScheduleLabel">
                                Edit section details
                                <button type="button" class="btn-close red-close float-end"
                                    (click)="closeEditSectionModal()" aria-label="Close"></button>
                            </h5>
                            <form [formGroup]="sectionDetailsForm">
                                <!-- **ROW 1** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.id'
                                                | translate}} :</label>
                                            <div class="col-7">
                                                <input type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1" formControlName="sectionShortDescription"
                                                    readonly>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.description' | translate}}:</label>
                                            <div class="col-7">
                                                <input type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="sectionShortDescription">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- **ROW 2** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label" id="scheduleLabel">
                                                {{'gis.quotation.rate_type' | translate}} :</label>
                                            <div class="col-7">
                                                <input type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="rateType">
                                                <!-- <select class="form-select form-control-sm mb-1" id="scheduleInput"
                                                    formControlName="rateType">
                                                    <option value="FXD">{{'gis.quotation.fixed' | translate}}</option>
                                                    <option value="RCU">{{'gis.quotation.recursive' | translate}}
                                                    </option>
                                                    <option value="RT">{{'gis.quotation.rate_table' | translate}}
                                                    </option>
                                                    <option value="ARG"> {{'gis.quotation.absolute_range' | translate}}
                                                    </option>
                                                    <option value="SRG">{{'gis.quotation.step_ranges' | translate}}
                                                    </option>
                                                </select> -->

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3">
                                            <label for="minmax-buttons" class="col-5 col-form-label" id="scheduleLabel">
                                                {{ 'gis.quotation.premium_type' | translate }}:
                                            </label>

                                            <div class="col-7">
                                                <div class="col-7">
                                                <input type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="sectionType">
                                            </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                                <!-- **ROW 3** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3">
                                            <label class="col-5 col-form-label" id="scheduleLabel">
                                                {{ 'gis.quotation.free_limit' | translate }} :
                                            </label>
                                            <div class="col-7">
                                                <ng-container *ngIf="isEditable; else readOnlyInput">
                                                    <!-- Editable number input -->
                                                    <input type="number" class="form-control form-control-sm mb-1"
                                                        formControlName="freeLimit"
                                                        [value]="freeLimitValue|translate" />
                                                </ng-container>

                                                <!-- Read-only number input -->
                                                <ng-template #readOnlyInput>
                                                    <input type="number" class="form-control form-control-sm mb-1"
                                                        [value]="freeLimitValue|translate" readonly />
                                                </ng-template>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.limit_amount' | translate}}:</label>

                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="limitAmount">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 4** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.group' | translate}}:</label>
                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="calcGroup">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.premium_rate' | translate}}:</label>

                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="premiumRate">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 5** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.div_by' | translate}}:</label>
                                              <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="multiplierDivisionFactor">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.multi_rate' | translate}} :</label>
                                             <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="multiplierRate">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 6** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.div_multi_by' | translate}}:</label>
                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="multiplierDivisionFactor">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.premium' | translate}}:</label>
                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="premiumAmount">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 7** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.minimum_premium' |
                                                translate}}:</label>
                                            <div class="col-7">
                                                <input type="number" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="minimumPremium">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.accumulation' | translate}}:</label>
                                            <div class="col-7">
                                               <input type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 8** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.remarks' | translate}}:</label>
                                            <div class="col-7">

                                                <textarea type="text" id="scheduleInput"
                                                    class="form-control form-control-sm mb-1"
                                                    formControlName="description"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.declaration' | translate}}:</label>
                                            <div class="col-7">
                                                <div class="d-flex gap-4">
                                                    <!-- YES option -->
                                                    <div class="d-flex align-items-center" style="cursor: pointer;"
                                                        (click)="setDeclaration1(true)">
                                                        <div class="rounded-circle me-2" [ngStyle]="{
                                                            width: '18px',
                                                            height: '18px',
                                                            backgroundColor: declaration1 === true ? '#198754' : 'transparent',
                                                            border: '2px solid',
                                                            borderColor: declaration1 === true ? '#198754' : '#6c757d'
                                                          }" style="user-select: none; outline: none;" tabindex="-1">
                                                        </div>
                                                        {{ 'gis.policy.yes' | translate }}
                                                    </div>

                                                    <!-- NO option -->
                                                    <div class="d-flex align-items-center" style="cursor: pointer;"
                                                        (click)="setDeclaration1(false)">
                                                        <div class="rounded-circle me-2" [ngStyle]="{
                                                            width: '18px',
                                                            height: '18px',
                                                            backgroundColor: declaration1 === false ? '#dc3545' : 'transparent',
                                                            border: '2px solid',
                                                            borderColor: declaration1 === false ? '#dc3545' : '#6c757d'
                                                          }" style="user-select: none; outline: none;" tabindex="-1">
                                                        </div>
                                                        {{ 'gis.policy.no' | translate }}
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                </div>
                                <!-- **ROW 9** -->
                                <div class="row" id="scheduleRows">
                                    <div class="col-xl-6">
                                        <div class="mb-3 ">
                                            <label for="minmax-buttons" class="col-5 col-form-label"
                                                id="scheduleLabel">{{'gis.quotation.compute' | translate}}:</label>
                                            <div class="col-7">
                                                <div class="d-flex gap-4">
                                                    <!-- YES option -->
                                                    <div class="d-flex align-items-center" style="cursor: pointer;"
                                                        (click)="setDeclaration2(true)">
                                                        <div class="rounded-circle me-2" [ngStyle]="{
                                                            width: '18px',
                                                            height: '18px',
                                                            backgroundColor: declaration2 === true ? '#198754' : 'transparent',
                                                            border: '2px solid',
                                                            borderColor: declaration2 === true ? '#198754' : '#6c757d'
                                                          }" style="user-select: none; outline: none;" tabindex="-1">
                                                        </div>
                                                        {{ 'gis.policy.yes' | translate }}
                                                    </div>

                                                    <!-- NO option -->
                                                    <div class="d-flex align-items-center" style="cursor: pointer;"
                                                        (click)="setDeclaration2(false)">
                                                        <div class="rounded-circle me-2" [ngStyle]="{
                                                            width: '18px',
                                                            height: '18px',
                                                            backgroundColor: declaration2 === false ? '#dc3545' : 'transparent',
                                                            border: '2px solid',
                                                            borderColor: declaration2 === false ? '#dc3545' : '#6c757d'
                                                          }" style="user-select: none; outline: none;" tabindex="-1">
                                                        </div>
                                                        {{ 'gis.policy.no' | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="col-xl-6">

                                    </div>
                                </div>


                            </form>
                            <div class="row mt-3 mb-2">
                                <div class="col-6 ">
                                </div>
                                <div class="col-6 d-flex justify-content-end">
                                    <button type="button" class="btn btn-primary" (click)="closeEditSectionModal()"
                                        style="background-color:#ffffff; color: #00529b;">Cancel</button>
                                    <!-- <button type="button" class="btn btn-primary"  data-bs-dismiss="modal" (click)="updateRiskSection()" >Save Details</button> -->
                                    <button type="button" class="btn btn-primary" (click)="editSection()">
                                        {{'gis.quotation.save_details' | translate}}</button>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Section Modal -->
            <div class="modal fade" id="deleteSection" tabindex="-1" aria-labelledby="deleteSectionLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered ">
                    <div class="modal-content">
                        <div class="modal-header" style="border-bottom: none;">
                            <h5 class="delete-title" id="exampleModalLabel">Delete section</h5>
                            <button type="button" class="btn-close red-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p class="d-flex justify-content-center" id="deleteLabel">
                                {{'gis.quotation.are_you_sure_you_want_to_delete_section' | translate}}?</p>
                            <div class=" d-flex justify-content-center">
                                <button type="button" class="btn btn-primary " id="delete" (click)="confirmDelete()"
                                    data-bs-dismiss="modal">{{'gis.quotation.yes_delete' | translate}}</button>
                            </div><br>
                            <div class="d-flex justify-content-center">
                                <button type="button" class="btn btn-outline-primary" id="delete"
                                    data-bs-dismiss="modal">
                                    {{'gis.quotation.no_im_not' | translate}}</button>
                            </div><br>
                        </div>
                    </div>
                </div>
            </div>

            <p-table [value]="sectionDetails" [tableStyle]="{'min-width': '300px'}" selectionMode="single"
                [(selection)]="selectedSection" dataKey="code" editMode="row" [paginator]="true" [rows]="2"
                [rowsPerPageOptions]="[2, 4, 6]" [showCurrentPageReport]="true"
                currentPageReportTemplate="{first} to {last} of {totalRecords}">
                <ng-template pTemplate="header">
                    <tr>


                        <th class="flexible-header" pSortableColumn="rowNum">
                            {{ 'gis.quotation.row_num' | translate }}
                            <p-sortIcon field="rowNum" />
                        </th>
                        <th class="flexible-header" pSortableColumn="group">
                            {{ 'gis.quotation.group' | translate }}
                            <p-sortIcon field="group" />
                        </th>

                        <th class="flexible-header" pSortableColumn="shortDescription">
                            {{ 'gis.quotation.code' | translate }}
                            <p-sortIcon field="code" />
                        </th>

                        <th class="flexible-header" pSortableColumn="description">
                            {{ 'gis.quotation.benefit' | translate }}
                            <p-sortIcon field="benefit" />
                        </th>

                        <th class="flexible-header" pSortableColumn="limitAmount">
                            {{ 'gis.quotation.limit_amount' | translate }}
                            <p-sortIcon field="limitAmount" />
                        </th>

                        <th class="flexible-header" pSortableColumn="premiumRate">
                            {{ 'gis.quotation.premium_rate' | translate }}
                            <p-sortIcon field="premiumRate" />
                        </th>

                        <th class="flexible-header" pSortableColumn="rateType">
                            {{ 'gis.quotation.rate_type' | translate }}
                            <p-sortIcon field="rateType" />
                        </th>
                        <th class="flexible-header" pSortableColumn="actions">
                            {{ 'gis.quotation.actions' | translate }}
                            <p-sortIcon field="actions" />
                        </th>


                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-sectionArray let-editing="editing" let-ri="rowIndex">
                    <tr (click)="onSelectSection(sectionArray)" [pEditableRow]="sectionArray">
                        <td class="flexible-header">{{sectionArray.rowNumber}}</td>
                        <td class="flexible-header">{{sectionArray.calcGroup}}</td>
                        <td class="flexible-header">{{sectionArray.sectionCode}}</td>
                        <td class="flexible-header">{{sectionArray.sectionShortDescription}}</td>
                        <td class="flexible-header">{{sectionArray.limitAmount}}</td>
                        <td class="flexible-header">{{sectionArray.premiumRate}}</td>
                        <td class="flexible-header">{{sectionArray.rateType}}</td>

                        <td class="flexible-header">
                            <!-- Edit Button -->
                            <button pButton pRipple type="button" pInitEditableRow
                                class="p-button-rounded p-button-text custom-button " pTooltip="" tooltipPosition="top"
                                (click)="onOpenEditSectionModal(sectionArray)">
                                Edit
                            </button>

                            <!-- Delete Button -->
                            <button pButton pRipple type="button" class="p-button-rounded p-button-text custom-button  "
                                data-bs-toggle="modal" data-bs-target="#deleteSection"
                                (click)="setSectionToDelete(sectionArray)">
                                Delete
                            </button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8" style="padding: 20px; text-align:center" id="empty">
                            No section Click on + icon to add section</td>
                    </tr>
                </ng-template>

            </p-table>

        </div>
    </div>
</div>
<!-- RISK CLAUSES DETAILS CARD -->
<div class="card mb-4">
    <div class="card-body">

        <div class="row">
            <div class="col-4 clause-title">
                <strong>{{'gis.quotation.risk_clauses' | translate}}</strong>
            </div>

            <div class="col-8 d-flex justify-content-end">
                <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="collapse"
                    data-bs-target="#riskClauses" aria-expanded="false" aria-controls="riskClauses"
                    (click)="toggleClausesopen()">
                    <i class="fa-solid fa-chevron-down"></i>
                </button>
            </div>
        </div>

        <!-- ADD Risk clause BUTTON ROW -->
        <div class="row mb-2" *ngIf="isClausesOpen">
            <div class="col-12 d-flex justify-content-end">
                <button id="openModalButtonAdd" class="btn btn-primary btn-sm" data-bs-toggle="modal"
                    data-bs-target="#addClause"> Add risk Clause
                </button>

                <i class="pi border border-black p-1 rounded-1 text-black" [ngClass]="{
              'pi-caret-up': showSections,
              'pi-caret-down': !showSections
            }" style="font-size: 15px; cursor: pointer; margin-left: 8px; padding: 4px 6px;"
                    (click)="toggleSections()"></i>
            </div>
        </div>

        <!-- Add risk close popup -->
        <div class="modal fade" id="addClause" tabindex="-1" role="dialog" aria-labelledby="addSectionLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" style="min-width: 708px;" role="document">
                <div class="modal-content" id="addSectionModal">
                    <div class="modal-body">
                        <h5 class="modal-title mt-2" id="editOtherDetailsLabel">
                            Add risk clause
                            <button type="button" class="btn-close red-close float-end" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </h5>

                        <p-table #clauseTable [value]="nonMandatoryClauses" dataKey="code" [paginator]="true" [rows]="3"
                            [rowsPerPageOptions]="[3, 5, 10]" [globalFilterFields]="['shortDescription', 'heading']"
                            [scrollable]="true" scrollDirection="horizontal" responsiveLayout="scroll" class="mt-3"
                            [(selection)]="selectedClauses" selectionMode="multiple">
                            <!-- Table Header -->
                            <ng-template pTemplate="header">
                                <!-- Column Labels -->
                                <tr>
                                    <th style="width: 2%;"></th>
                                    <th pSortableColumn="id" class="equal-width">
                                        ID <p-sortIcon field="id" />
                                    </th>
                                    <th pSortableColumn="description" class="equal-width">
                                        Description <p-sortIcon field="description" />
                                    </th>
                                </tr>


                                <tr>
                                    <td style="padding-top: 10px; padding-bottom: 10px;"></td>
                                    <td style="padding-top: 10px; padding-bottom: 10px;">
                                        <input class="form-control form-control-sm" pInputText #globalFilterInput
                                            type="text" placeholder=""
                                            (input)="clauseTable.filterGlobal(globalFilterInput.value, 'contains')"
                                            style="width: 30%;" />
                                    </td>
                                    <td style="padding-top: 10px; padding-bottom: 10px;">
                                        <input class="form-control form-control-sm" #globalFilterInput pInputText
                                            type="text" placeholder=""
                                            (input)="clauseTable.filterGlobal(globalFilterInput.value, 'contains')"
                                            style="width: 30%;" />
                                    </td>
                                </tr>
                            </ng-template>



                            <!-- Empty Message -->
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="3" class="text-center text-muted py-3">No predefined clauses available.
                                    </td>
                                </tr>
                            </ng-template>

                            <!-- Table Body -->
                            <ng-template pTemplate="body" let-clause>
                                <tr>
                                    <td>
                                        <input type="checkbox" [(ngModel)]="clause.isChecked" />
                                    </td>
                                    <td>{{ clause.shortDescription }}</td>
                                    <td>{{ clause.heading }}</td>
                                </tr>
                            </ng-template>
                        </p-table>

                        <!-- Buttons -->
                        <div class="mt-4 d-flex justify-content-end">
                            <button type="button" class="btn btn-outline-primary me-2"
                                data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="saveDetails" data-bs-dismiss="modal"
                                (click)="saveRiskClauses()">
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div [@slideInOut]="isClausesOpen ? 'open' : 'closed'" class="mt-2 w-100">
            <p-table #riskClauseTable [value]="selectedClause" dataKey="code" editMode="row"
                [(selection)]="selectedClause" selectionMode="multiple" [autoLayout]="true" [paginator]="true"
                [rows]="2" [rowsPerPageOptions]="[2, 4, 6]" [scrollable]="true" [showCurrentPageReport]="true"
                currentPageReportTemplate="{first} to {last} of {totalRecords} entries" responsiveLayout="scroll"
                [tableStyle]="{ 'min-width': '100%', width: '100%' }" class="p-datatable-sm">
                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="shortDescription">ID <p-sortIcon field="shortDescription" /></th>
                        <th pSortableColumn="heading">
                            Heading <p-sortIcon field="heading" />
                        </th>
                        <th pSortableColumn="wording">
                            Wording <p-sortIcon field="wording" />
                        </th>
                        <th></th>
                        <th></th>
                    </tr>

                    <!-- Filter Row -->
                    <tr>
                        <th>
                            <input pInputText type="text" placeholder="Search by ID"
                                class="form-control form-control-sm" (input)="filterShortDesc($event)" />
                        </th>
                        <th>
                            <input pInputText type="text" placeholder="Search by heading"
                                class="form-control form-control-sm" (input)="filterHeading($event)" />
                        </th>
                        <th>
                            <input pInputText type="text" placeholder="Search by Wording"
                                class="form-control form-control-sm" (input)="filterWording($event)" />
                        </th>
                        <th colspan="2"></th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-selectedClauseList let-editing="editing" let-ri="rowIndex">
                    <tr [pEditableRow]="selectedClauseList">
                        <td>
                            <!-- <p-tableCheckbox [value]="selectedClauseList"
(onChange)="selectedProductClauses($event)"
[(ngModel)]="selectedClauseList.checked"
[binary]="true">
></p-tableCheckbox> -->
                            <!-- <p-checkbox
[(ngModel)]="selectedClauseList.checked"
[binary]="true"
[disabled]="selectedClauseList.isMandatory === 'Y'"
(onChange)="onClauseSelectionChange(selectedClauseList)"
>
</p-checkbox> -->
                            {{ selectedClauseList.shortDescription }}
                        </td>

                        <td style="
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                overflow-y: auto;
                max-width: 250px;
              " pTooltip="{{ selectedClauseList.heading }}" tooltipPosition="top">
                            <p-cellEditor>
                                <ng-template pTemplate="input" *ngIf="selectedClauseList.isEditable === 'Y'">
                                    <input pInputText type="text" [(ngModel)]="selectedClauseList.heading"
                                        class="form-control form-control-sm" [ngModelOptions]="{ standalone: true }" />
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{ selectedClauseList.heading || selectedClauseList.description}}
                                </ng-template>
                            </p-cellEditor>
                        </td>
                        <td style="
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 300px;
                overflow-y: auto;
              ">
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <input pInputText type="text" [(ngModel)]="selectedClauseList.wording"
                                        class="form-control form-control-sm" [ngModelOptions]="{ standalone: true }" />
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{ selectedClauseList.wording }}
                                </ng-template>
                                <!-- Helper icon added next to the wording column -->
                            </p-cellEditor>
                        </td>
                        <td>
                            <button pButton pRipple type="button" (click)="openHelperModal(selectedClauseList)"
                                icon="pi pi-info-circle" class="p-button-rounded p-button-text"></button>
                        </td>
                        <!-- <td
*ngIf="selectedClauseList.isEditable !== 'Y'"
style="padding-left: 24px"
>
--
</td> -->
                        <td class="text-center align-middle">
                            <ng-container *ngIf="selectedClauseList.isEditable === 'Y'; else notEditable">
                                <div class="d-flex align-items-center justify-content-center gap-2">
                                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow
                                        class="p-button-rounded p-button-text custom-button">
                                        Edit
                                    </button>
                                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
                                        icon="pi pi-check"
                                        class="p-button-rounded p-button-text p-button-success"></button>
                                    <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow
                                        icon="pi pi-times"
                                        class="p-button-rounded p-button-text p-button-danger"></button>
                                </div>
                            </ng-container>
                            <ng-template #notEditable>
                                <span class="d-block text-muted">--</span>
                            </ng-template>
                        </td>
                    </tr>
                    <!-- Modal for each row -->
                    <p-dialog [(visible)]="selectedClauseList.showHelperModal" [modal]="false"
                        [style]="{ width: '700px' }">
                        <ng-container *ngIf="selectedClauseList">
                            <div pResizable [ngStyle]="{ 'min-width.px': 200, 'min-height.px': 150 }"
                                (onResize)="onResize($event)">
                                <p>{{ selectedClauseList.wording }}</p>
                            </div>
                        </ng-container>
                    </p-dialog>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8" style="padding: 20px; text-align:center" id="empty">
                            No risk clause Click on + icon to add risk clause</td>
                    </tr>
                </ng-template>
            </p-table>


        </div>

    </div>
</div>