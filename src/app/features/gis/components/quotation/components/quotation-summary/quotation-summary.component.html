<div class="mx-4 mt-3">
  <p class="title">Quotations:Quotation Summary </p>
  <app-stepper [currentStep]="5" [stepperData]="steps"></app-stepper>

  <div class="card mb-3">
    <div class="header mx-4 mt-2 mb-2">
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link sub-title active" data-bs-toggle="tab" id="nav-summary-tab" aria-controls="nav-summary"
            data-bs-target="#nav-summary">Quotation Details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link sub-title" data-bs-toggle="tab" id="nav-authorization-tab"
            aria-controls="nav-authorization" data-bs-target="#nav-authorization">Authorization & Reports </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-summary" role="tabpanel" aria-labelledby="nav-summary-tab"
      tabindex="0">
      <div class="spinner" style="position: relative">
        <ngx-spinner type="ball-clip-rotate-multiple" [fullScreen]="true" color="#00529B" size="large"
          bdColor="rgba(255, 255, 255, 0.966)"></ngx-spinner>
      </div>

      <!-- Quotation Details Card -->
      <div class="card mb-4">
        <div class="card-body">
          <p class="card-title mb-4">Details</p>

          <div class="row">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label">Quotation Number</p>
                </div>
                <div class="col-7">
                  <p class="content">{{quotationNumber}}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Client</p>
                </div>
                <div class="col-8">
                  <p class="content">{{ clientDetails?.inputClientName || clientDetails?.firstName + " " + clientDetails?.lastName || quickQuoteData.clientName }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-sm-4">
                  <p class="label">Agent</p>
                </div>
                <div class="col-8">
                  <p class="content">{{agents?.name}}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label">Branch</p>
                </div>
                <div class="col-7">
                  <p class="content">{{branch?.name}}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Cover From</p>
                </div>
                <div class="col-8">
                  <p class="content">{{coverFrom}}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Cover To</p>
                </div>
                <div class="col-8">
                  <p class="content">{{coverTo}}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label">Currency</p>
                </div>
                <div class="col-7">
                  <p class="content">{{quotationView?.currency}}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Proposer</p>
                </div>
                <div class="col-8">
                  <p class="content">{{quotationDetails?.introducerCode }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Introducer</p>
                </div>
                <div class="col-8">
                  <p class="content">{{quotationDetails?.introducerCode }}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label">Expiry Date</p>
                </div>
                <div class="col-7">
                  <p class="content">{{expiryDate }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Status</p>
                </div>
                <div class="col-8">
                  <p class="content">{{quotationView?.status }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">Source</p>
                </div>
                <div class="col-8">
                  <p class="content">{{sourecDescription }}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label ">Premium</p>
                </div>
                <div class="col-7">
                  <p class="content " *ngIf="premium" appCommaFormat>{{ premium.premiumAmount }}</p>
                  <p class="content" *ngIf="!premium" appCommaFormat>{{ quotationView?.premium }}</p>
                  <!-- <p class="content" *ngIf="!premium && !quotationView?.premium">0.00</p> -->
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label ">Sum Insured</p>
                </div>
                <div class="col-8">
                  <p class="content" appCommaFormat>{{ sumInsured }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label ">Comm amt.</p>
                </div>
                <div class="col-8">
                  <p class="content" appCommaFormat>{{ marketerCommissionAmount  }}</p>
                </div>
              </div>
            </div>

          </div>

          <div class="row mb-2">
            <div class="col-md-4">
              <div class="row">
                <div class="col-5">
                  <p class="label">Internal Comments</p>
                </div>
                <div class="col-7">
                  <p class="content">{{quotationDetails?.internalComments }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-4">
                  <p class="label">External Comments</p>
                </div>
                <div class="col-8">
                  <p class="content">{{quotationDetails?.comments }}</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <!--  -->
            </div>
          </div>

          <p class="cancel float-start" (click)="cancelQuotation()">Cancel Quotation</p>
          <div class="float-end">
            <button class="btn btn-outline-primary" style="margin-right: 10px;" (click)="editDetails()">Edit
              Details</button>
            <button class="btn btn-primary" (click)="computePremium()">Compute Premium</button>
          </div>
        </div>
      </div>

      <!-- Product Details Card -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <p  *ngIf="!isCollapsibleOpen" class="card-title mt-2" data-bs-toggle="collapse" data-bs-target="#productDetails"
                (click)="toggleProductDetails()">Product Details</p>
            </div>
            <div class="col-8 d-flex justify-content-end">
              <div class="row">
                <!-- <div class="col-sm-3"></div>
                <div class="col-sm-3" *ngIf="isCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" title="Add">
                    <i class="fa-solid fa-plus"></i>
                  </button>
                </div>
                <div class="col-sm-3" *ngIf="isCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" title="Edit">
                    <i class="fa-solid fa-pencil"></i>
                  </button>
                </div>
                <div class="col-sm-3" *ngIf="isCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-danger me-2" title="Delete">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div> -->
                <div class="col-4" *ngIf="!isCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="collapse"
                    data-bs-target="#productDetails" (click)="toggleProductDetails()"
                    [attr.aria-expanded]="!isCollapsibleOpen">
                    <i class="fa-solid fa-chevron-down"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="collapse mt-4" id="productDetails">
            <div class="row">
              <div class="col-3">
                <!-- <p class="card-title mt-2" data-bs-toggle="collapse" data-bs-target="#productDetails" (click)="toggleProductDetails()">Product Details</p> -->
                <p class="fw-semibold	card-title-collapsed mt-2">Product Details</p>
              </div>
              <div class="col-9 d-flex justify-content-end" id="navigationIcons">
                <div class="row">
                  <div class="col-sm-3"></div>
                  <div class="col-sm-3">
                    <button type="button" id="icon" class="btn btn-primary" title="Add">
                      <i class="fa-solid fa-plus"></i>
                    </button>
                  </div>
                  <div class="col-sm-3">
                    <button type="button" id="icon" class="btn btn-primary" title="Edit">
                      <i class="fa-solid fa-pencil"></i>
                    </button>
                  </div>
                  <div class="col-sm-3">
                    <button type="button" id="icon" class="btn btn-danger me-2" title="Delete">
                      <i class="fa-solid fa-trash-can"></i>
                    </button>
                  </div>

                </div>
              </div>
            </div>
            <div class="mt-3" id="">
              <p-table [value]="productDetails" [tableStyle]="{ 'min-width': '50rem' }">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Product</th>
                    <th>Cover From</th>
                    <th>Cover To</th>
                    <th>Binder</th>
                    <th class="text-end">Sum Insured</th>
                    <th class="text-end">Commission</th>
                    <th class="text-end">Premium</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-data>
                  <tr (click)="handleProductClick(data)" class="point"
                    [ngClass]="{'selected-row': selectedProduct === data}">
                    <td>{{data.productName}}</td>
                    <td>{{data.wef}}</td>
                    <td>{{data.wet}}</td>
                    <td>{{data.binder || "-" }}</td>
                    <td appCommaFormat class="text-end">{{data.totalSumInsured || 0.00}}</td>
                    <td appCommaFormat class="text-end">{{data.commission || 0.00}}</td>
                    <td appCommaFormat class="text-end">{{data.premium || 0.00}}</td>
                  </tr>
                </ng-template>
              </p-table>
              <!-- TABS  -->
              <div class="row mt-5 mb-3">
                <div class="col-7">
                  <ul class="nav nav-underline ">
                    <li class="nav-item">
                      <a class="nav-link active" [class.active]="activeTab === 'clauses'"
                        (click)="setActiveTab('clauses')" aria-current="page" data-bs-toggle="tab"
                        data-bs-target="#nav-clauses">Clauses</a>
                    </li>
                    <br>
                    <li class="nav-item">
                      <a class="nav-link" [class.active]="activeTab === 'taxes'" (click)="setActiveTab('taxes')"
                        data-bs-toggle="tab" data-bs-target="#nav-taxes">Taxes</a>
                    </li>
                    <br>
                    <li class="nav-item">
                      <a class="nav-link" [class.active]="activeTab === 'limits'" (click)="setActiveTab('limits')"
                        data-bs-toggle="tab" data-bs-target="#nav-limits">Limits of Liability</a>
                    </li>
                    <br>
                    <li class="nav-item">
                      <a class="nav-link" [class.active]="activeTab === 'similarQuotes'"
                        (click)="setActiveTab('similarQuotes')" data-bs-toggle="tab"
                        data-bs-target="#nav-similarQuotes">Similar Quotes</a>
                    </li>
                  </ul>
                </div>
                <div class="col-5 d-flex justify-content-end" id="navigationIcons">
                  <div class="row" *ngIf="activeTab === 'clauses' || activeTab === 'taxes' || activeTab === 'limits'">
                    <div class="col-sm-3"></div>
                    <div class="col-sm-3">
                      <button type="button" id="icon" class="btn btn-primary" title="Add">
                        <i class="fa-solid fa-plus"></i>
                      </button>
                    </div>
                    <div class="col-sm-3">
                      <button type="button" id="icon" class="btn btn-primary" title="Edit">
                        <i class="fa-solid fa-pencil"></i>
                      </button>
                    </div>
                    <div class="col-sm-3">
                      <button type="button" id="icon" class="btn btn-danger me-2" title="Delete">
                        <i class="fa-solid fa-trash-can"></i>
                      </button>
                    </div>

                  </div>
                </div>
              </div>


              <div class="tab-content mb-4" id="nav-tabContent">
                <!-- CLAUSES -->
                <div class="tab-pane fade show active" id="nav-clauses" role="tabpanel" aria-labelledby="nav-clauses"
                  tabindex="0">


                  <p-table [value]="clauses" [tableStyle]="{ 'min-width': '50rem' }"  [rows]="5"

                    class='ui-datatable' responsiveLayout="scroll"  [autoLayout]="true" [scrollable]="true" scrollHeight="200px">
                    <ng-template pTemplate="header">
                      <tr>
                        <th class="flexible-header">ID</th>
                        <th class="flexible-header"> {{'gis.quotation.heading' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.wording' | translate}}</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td class="flexible-header">{{data.shortDescription}}</td>
                        <td class="flexible-header">{{data.heading | sentenceCase }}</td>
                        <td class="flexible-header" style=" white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        max-width:300px;
                        overflow-y: auto;">{{data.wording | sentenceCase }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
                <!-- TAXES -->
                <div class="tab-pane fade" id="nav-taxes" role="tabpanel" aria-labelledby="nav-taxes" tabindex="0">
                  <p-table [value]="taxDetails" [tableStyle]="{ 'min-width': '50rem' }" class='ui-datatable'
                  responsiveLayout="scroll"  [autoLayout]="true" [scrollable]="true" scrollHeight="200px">
                    <ng-template pTemplate="header">
                      <tr>
                        <th class="flexible-header">Description</th>
                        <th class="flexible-header">Quotation Rate</th>
                        <th class="flexible-header">Rate Type</th>
                        <th class="flexible-header text-end">Amount</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td class="flexible-header">{{data.rateDescription}}</td>
                        <td class="flexible-header">{{data.quotationRate}}</td>
                        <td class="flexible-header">{{data.rateType}}</td>
                        <td class="flexible-header text-end" appCommaFormat>{{ data.taxAmount }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
                <!-- LIMITS -->
                <div class="tab-pane fade " id="nav-limits" role="tabpanel" aria-labelledby="nav-limits" tabindex="0">
                  <div class="row">
                    <div class="col-3">
                      <div>

                        <div class="listing">
                          <p class="subclass-title">{{'gis.quotation.subclass' | translate}} </p>
                          <ul class="scrollable-list">
                            <li *ngFor="let data of productSubclass" (click)="onSubclassClick(data.code)">
                              {{ data.description | sentenceCase}}
                            </li>
                          </ul>
                        </div>

                      </div>
                    </div>
                    <div class="col-9">


                      <p-table [value]="limitsOfLiabilityList" [tableStyle]="{ 'min-width': '50rem' }"
                        class='ui-datatable' responsiveLayout="scroll"  [autoLayout]="true" [scrollable]="true" scrollHeight="200px">
                        <ng-template pTemplate="header">
                          <tr>
                            <th class="flexible-header">{{'gis.quotation.narration' | translate}}</th>
                            <th class="flexible-header">Scl Desc</th>
                            <th class="flexible-header">{{'gis.quotation.value' | translate}}</th>
                          </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-data>
                          <tr>
                            <td class="flexible-header" style=" white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                                max-width:300px;
                                overflow-y: auto;">{{data.narration | sentenceCase}}</td>
                            <td class="flexible-header">{{data.subclassCode}}</td>
                            <td class="flexible-header">{{data.value}}</td>
                          </tr>
                        </ng-template>
                      </p-table>

                    </div>
                  </div>
                </div>
                <!-- SIMILAR QUOTES -->
                <div class="tab-pane fade" id="nav-similarQuotes" role="tabpanel" aria-labelledby="nav-similarities"
                  tabindex="0">
                  <p-table [value]="similarQuotesList" [tableStyle]="{ 'min-width': '50rem' }" class='ui-datatable'
                  responsiveLayout="scroll"  [autoLayout]="true" [scrollable]="true" scrollHeight="200px">
                    <ng-template pTemplate="header" >
                      <tr>
                        <th class="flexible-header">{{'gis.quotation.quotation_number' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.client' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.cover_from' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.cover_to' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.branch' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.agent' | translate}}</th>
                        <th class="flexible-header">{{'gis.quotation.product' | translate}}</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td>{{data.quotNo}}</td>
                        <td>{{data.client | sentenceCase}}</td>
                        <td>{{data.quotCoverFrom}}</td>
                        <td>{{data.quotCoverTo}}</td>
                        <td>{{data.branchName | sentenceCase}}</td>
                        <td>{{data.agentName | sentenceCase}}</td>
                        <td>{{data.productDesc | sentenceCase}}</td>
                      </tr>
                    </ng-template>

                    <!-- Template for empty data -->
                    <ng-template pTemplate="emptymessage">
                      <tr>
                        <td colspan="7" class="text-center">No similar quotations to display</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Risk Details Card -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <p *ngIf="!isRiskCollapsibleOpen" class="card-title mt-2" data-bs-toggle="collapse" data-bs-target="#riskDetails"
                (click)="toggleRiskDetails()">Risk Details</p>
            </div>
            <div class="col-8 d-flex justify-content-end">
              <div class="row">
                <!-- <div class="col-sm-3"></div>
                <div class="col-sm-3" *ngIf="isRiskCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" title="Add">
                    <i class="fa-solid fa-plus"></i>
                  </button>
                </div>
                <div class="col-sm-3" *ngIf="isRiskCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" title="Edit">
                    <i class="fa-solid fa-pencil"></i>
                  </button>
                </div>
                <div class="col-sm-3" *ngIf="isRiskCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-danger me-2" title="Delete">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div> -->
                <div class="col-4" *ngIf="!isRiskCollapsibleOpen">
                  <button type="button" id="icon" class="btn btn-primary" data-bs-toggle="collapse"
                    data-bs-target="#riskDetails" (click)="toggleRiskDetails()"
                    [attr.aria-expanded]="!isRiskCollapsibleOpen">
                    <i class="fa-solid fa-chevron-down"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="collapse mt-4" id="riskDetails">
            <div class="row mb-3">
              <div class="col-4">
                <p  class=" mt-2 fw-semibold" data-bs-toggle="collapse" data-bs-target="#riskDetails"
                  >Risk Details</p>
              </div>
              <div class="col-8 d-flex justify-content-end">
                <div class="row">
                  <div class="col-sm-3"></div>
                  <div class="col-sm-3" >
                    <button type="button" id="icon" class="btn btn-primary" title="Add">
                      <i class="fa-solid fa-plus"></i>
                    </button>
                  </div>
                  <div class="col-sm-3" >
                    <button type="button" id="icon" class="btn btn-primary" title="Edit">
                      <i class="fa-solid fa-pencil"></i>
                    </button>
                  </div>
                  <!-- <div class="col-sm-3" >
                    <button type="button" id="icon" class="btn btn-danger me-2" title="Delete">
                      <i class="fa-solid fa-trash-can"></i>
                    </button>
                  </div> -->
                  <div class="col-sm-3">
                    <!-- <button
                    type="button"
                    id="openRiskModalButtonDelete"
                    class="btn btn-primary"
                    title="Delete"
                    data-bs-toggle="modal"
                    data-bs-target="#deleteRisk"
                    [hidden]="true"
                   >
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                    <button
                      type="button"
                      id="icon"
                      class="btn btn-primary"
                      title="Delete"
                      (click)="openRiskDeleteModal()"
                      [disabled]="quotationDetails?.riskInformation?.length <= 1">
                      <i class="fa-solid fa-trash-can"></i>
                    </button> -->
                    <button type="button" id="icon" class="btn btn-danger me-2" title="Delete"
                    id="openRiskModalButtonDelete" [hidden]="true" data-bs-toggle="modal"
                    data-bs-target="#deleteRisk">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                  <button type="button" id="icon" class="btn btn-primary" title="Delete" >
                    <i class="fa-solid fa-trash-can" (click)="openRiskDeleteModal()"></i>
                  </button>
                  </div>

                </div>
              </div>
            </div>

            <p-table [value]="riskDetails" [tableStyle]="{ 'min-width': '50rem' }" class='ui-datatable'
              styleClass="p-datatable-striped" >
              <ng-template pTemplate="header">
                <tr>
                  <th>ID</th>
                  <th>Description</th>
                  <th>Cover type</th>
                  <th>Subclass</th>
                  <th class="text-end">SI</th>
                  <th class="text-end">Premium</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-data>
                <tr [class.p-highlight]="data === selectedRisk" [pSelectableRow]="riskDetails" class="point" (click)="handleRowClick(data)"
                  [class.disabled]="!data?.code">
                  <td>{{data?.quotationRiskNo || '-'}}</td>
                  <td>{{data?.propertyId || '-'}}</td>
                  <td>{{data?.coverTypeShortDescription || '-'}}</td>
                  <td>{{data?.subclass?.description || '-'}}</td>
                  <td appCommaFormat class="text-end">{{data?.sectionsDetails[0]?.limitAmount || 0 }}</td>
                  <td appCommaFormat class="text-end">{{data?.sectionsDetails[0]?.premium || 0 }}</td>
                </tr>
              </ng-template>
            </p-table>
               <!-- Delete Risk Modal -->
               <div class="modal fade" id="deleteRisk" tabindex="-1" role="dialog"
               aria-labelledby="deleteRisk" aria-hidden="true">
               <div class="modal-dialog modal-dialog-centered" role="document">
                   <div class="modal-content" id="deleteRisk">
                       <div class="modal-body ">
                           <p class="deleteMessage mt-4 mb-4">{{'gis.policy.are_you_sure_you_want_to_delete' |
                               translate}}</p>
                           <div class="d-flex justify-content-center mb-3">
                               <button type="button" class="btn btn-primary px-5" id="delete"
                                   data-bs-dismiss="modal" (click)="deleteRisk()">{{'gis.policy.yes_delete'
                                   | translate}}</button>
                           </div>
                           <div class="d-flex justify-content-center mb-2">
                               <button type="button" class="btn btn-outline-primary px-5"
                                   data-bs-dismiss="modal">{{'gis.policy.no_im_not' | translate}}</button>
                           </div>


                       </div>
                   </div>
               </div>
           </div>
            <br>
            <ul class="nav nav-underline mt-2 mb-4">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" data-bs-toggle="tab"
                  data-bs-target="#nav-sections">Sections</a>
              </li>
              <br>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-riskClauses">Clauses</a>
              </li>
              <br>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-schedules">Other Details</a>
              </li>
              <br>
              <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-excesses">Excesses</a>
              </li>
            </ul>
            <div class="tab-content mb-4" id="nav-tabContent">
              <!-- SECTIONS -->
              <div class="tab-pane fade show active" id="nav-sections" role="tabpanel" aria-labelledby="nav-sections"
                tabindex="0">
                <p-table [value]="sections" [tableStyle]="{ 'min-width': '50rem' }" >
                  <ng-template pTemplate="header">
                    <tr>
                      <th class="flexible-header">Row Num</th>
                      <th class="flexible-header">Group</th>
                      <th class="flexible-header">Section description</th>
                      <th class="flexible-header">Rate type</th>
                      <th class="flexible-header">Section rate</th>
                      <th class="text-end flexible-header">Section limit</th>
                      <th class="text-end flexible-header">Premium</th>
                      <th class="text-end flexible-header">Free limit</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td class="flexible-header">{{data.rowNumber}}</td>
                      <td class="flexible-header">{{data.calculationGroup}}</td>
                      <td class="flexible-header">{{data.sectionShortDescription}}</td>
                      <td class="flexible-header">{{data.rateType}}</td>
                      <td class="flexible-header">{{data.rate}}</td>
                      <td appCommaFormat class="text-end flexible-header">{{data.limitAmount}}</td>
                      <td appCommaFormat class="text-end flexible-header">{{data.premium}}</td>
                      <td appCommaFormat class="text-end flexible-header">{{data.freeLimit}}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
              <!-- RISK CLAUSES -->
              <div class="tab-pane fade" id="nav-riskClauses" role="tabpanel" aria-labelledby="nav-riskClauses"
                tabindex="0">
                <p-table [value]="riskClauses" dataKey="code" editMode="row" [tableStyle]="{'min-width': '50rem'}"
                   responsiveLayout="scroll" class='ui-datatable' [autoLayout]="true">
                  <ng-template pTemplate="header">
                    <tr>
                      <th style="width: 5%;padding-right: 50px;">Clause</th>
                      <th style="width: 25%;padding-right: 50px;">Product</th>
                      <th style="width: 40%;">Wording</th>
                      <th style="width: 5%;"></th>
                      <th style="width: 5%;">Editable</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-selectedClauseList let-editing="editing" let-ri="rowIndex">
                    <tr [pEditableRow]="selectedClauseList">
                      <td>
                        {{selectedClauseList.shortDescription}}
                      </td>
                      <td>
                        {{selectedClauseList.productDescription}}
                      </td>
                      <td
                        style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width:300px; overflow-y: auto;">
                        <p-cellEditor>
                          <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="selectedClauseList.clause"
                              class="form-control form-control-sm" [ngModelOptions]="{standalone: true}">
                          </ng-template>
                          <ng-template pTemplate="output">
                            {{selectedClauseList.clause}}
                          </ng-template>
                          <!-- Helper icon added next to the wording column -->
                        </p-cellEditor>
                      </td>
                      <td>
                        <button pButton pRipple type="button" (click)="openHelperModal(selectedClauseList)"
                          icon="pi pi-info-circle" class="p-button-rounded p-button-text"></button>
                      </td>
                      <td>{{selectedClauseList.clauseEditable}}</td>
                    </tr>
                    <!-- Modal for each row -->
                    <p-dialog [(visible)]="selectedClauseList.showHelperModal" [modal]="false"
                      [style]="{ 'width': '700px'}">
                      <ng-container *ngIf="selectedClauseList">
                        <div pResizable [ngStyle]="{'min-width.px': 200, 'min-height.px': 150}"
                          (onResize)="onResize($event)">
                          <p>{{ selectedClauseList.clause }}</p>
                        </div>
                      </ng-container>
                    </p-dialog>
                  </ng-template>
                </p-table>
              </div>
              <!-- SCHEDULES -->
              <div class="tab-pane fade " id="nav-schedules" role="tabpanel" aria-labelledby="nav-schedules"
                tabindex="0">
                <p-table [value]="schedules" [tableStyle]="{ 'min-width': '50rem' }" >
                  <ng-template pTemplate="header">
                    <tr>
                      <th class="flexible-header">Reg no.</th>
                      <th class="flexible-header"> Vehicle make</th>
                      <th class="flexible-header">Cubic capacity</th>
                      <th class="flexible-header">Year of manufacture</th>
                      <th class="flexible-header">Seating capacity</th>
                      <th class="flexible-header">Value</th>
                      <th class="flexible-header">Body type</th>
                      <th class="flexible-header">Cover type</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td class="flexible-header">{{data.registrationNumber}}</td>
                      <td class="flexible-header">{{data.Make}}</td>
                      <td class="flexible-header">{{data.cubicCapacity}}</td>
                      <td class="flexible-header">{{data.yearOfManufacture}}</td>
                      <td class="flexible-header">{{data.carryCapacity}}</td>
                      <td class="flexible-header">{{data.value}}</td>
                      <td class="flexible-header">{{data.bodyType}}</td>
                      <td class="flexible-header">{{data.coverType}}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
              <!-- EXCESSES -->
              <div class="tab-pane fade" id="nav-excesses" role="tabpanel" aria-labelledby="nav-excesses" tabindex="0">
                <p-table [value]="excessesList" [tableStyle]="{ 'min-width': '50rem' }" >
                  <ng-template pTemplate="header">
                    <tr>
                      <th>Narration</th>
                      <th>Value</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td>{{data.narration}}</td>
                      <td>{{data.value}}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Claims Experience Section -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row mb-3">
            <div class="col-4">
              <p-panelMenu [model]="menuItems" [style]="{'width':'300px'}"></p-panelMenu>
            </div>
            <div class="col-8 d-flex justify-content-end">
              <div class="row">
                <div class="col-3"></div>
                <div class="col-sm-3">
                  <button type="button" id="icon" class="btn btn-primary" title="Add" data-bs-toggle="modal"
                    data-bs-target="#addExternalClaimExperienceModal" [hidden]="!showExternalClaims">
                    <i class="fa-solid fa-plus"></i>
                  </button>
                </div>
                <div class="col-sm-3">
                  <button type="button" id="icon" class="btn btn-primary" title="Edit"
                    [attr.data-bs-toggle]="selectedExternalClaimExp ? 'modal' : null"
                    [attr.data-bs-target]="selectedExternalClaimExp ? '#addExternalClaimExperienceModal' : null"
                    (click)="openExternalClaimExpEditModal()" [hidden]="!showExternalClaims">
                    <i class="fa-solid fa-pencil"></i>
                  </button>
                </div>
                <div class="col-sm-3">
                  <button type="button" id="icon" class="btn btn-danger me-2" title="Delete"
                    id="openClaimModalButtonDelete" [hidden]="true" data-bs-toggle="modal"
                    data-bs-target="#deleteClaim">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                  <button type="button" id="icon" class="btn btn-primary" title="Delete" [hidden]="!showExternalClaims">
                    <i class="fa-solid fa-trash-can" (click)="openClaimDeleteModal()"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- EXTERNAL CLAIMS -->
          <div class="mb-4" *ngIf="showExternalClaims">
            <p-table [value]="externalTable" [tableStyle]="{ 'min-width': '50rem' }">
              <ng-template pTemplate="header">
                <tr>
                  <!-- <th>Client</th> -->
                  <th class="flexible-header">Insurer</th>
                  <th class="flexible-header">Policy Number</th>
                  <th class="flexible-header">Year</th>
                  <th class="flexible-header">Risk Details</th>
                  <th class="text-end flexible-header">Damage Amount</th>
                  <th class="text-end flexible-header">Third-Party Amount</th>
                  <th class="text-end flexible-header">Other Amount</th>
                  <th class="text-end flexible-header">Claim Paid</th>

                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-externalClaim>
                <tr [class.p-highlight]="externalClaim === selectedExternalClaimExp"
                  (click)="onExternalClaimSelect(externalClaim)" style="cursor: default">
                  <!-- <td>{{ clientDetails?.firstName+" "+clientDetails?.lastName }}</td> -->
                  <td class="flexible-header">{{externalClaim.insurer}}</td>
                  <td class="flexible-header">{{externalClaim.policyNumber}}</td>
                  <td class="flexible-header">{{externalClaim.year}}</td>
                  <td class="flexible-header">{{externalClaim.riskDetails}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{externalClaim.damageAmount}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{externalClaim.totalPaidAmount}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{externalClaim.otherAmount}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{externalClaim.claimPaid}}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="1"></td>
                  <td colspan="4" style="padding:30px;padding-left: 350px;" id="empty">No records Found</td>
                </tr>
              </ng-template>
            </p-table>
          </div>

          <!-- INTERNAL CLAIMS -->
          <div class="mb-4" *ngIf="showInternalClaims">
            <p-table [value]="internalTable" [tableStyle]="{ 'min-width': '50rem' }">
              <ng-template pTemplate="header">
                <tr>
                  <th class="flexible-header">Policy No</th>
                  <th class="flexible-header">Claim No</th>
                  <th class="text-end flexible-header">OST Reserve</th>
                  <th class="text-end flexible-header">Total Reserve</th>
                  <th class="text-end flexible-header">Recoveries</th>
                  <th class="text-end flexible-header">Salvages</th>
                  <th class="text-end flexible-header">Total Payments</th>
                  <th class="text-end flexible-header">Net Paid</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-internalClaim>
                <tr [class.p-highlight]="internalClaim === selectedIntetnalClaimExp"
                  (click)="onInternalClaimSelect(internalClaim)" style="cursor: default">
                  <td class="flexible-header">{{internalClaim.client_policy_number}}</td>
                  <td class="flexible-header">{{internalClaim.claim_number}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.outstanding_reserve}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.total_reserve}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.recoveries}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.salvages}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.total_payments}}</td>
                  <td appCommaFormat class="text-end flexible-header">{{internalClaim.net_paid}}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="1"></td>
                  <td colspan="4" style="padding:30px;padding-left:350px;" id="empty">No records Found</td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Claims Modal -->
    <div class="modal fade" id="deleteClaim" tabindex="-1" role="dialog" aria-labelledby="deleteClaim"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" id="deleteClaim">
          <div class="modal-body ">
            <p class="deleteMessage mt-4 mb-4">{{'gis.policy.are_you_sure_you_want_to_delete' | translate}}</p>
            <div class="d-flex justify-content-center mb-3">
              <button type="button" class="btn btn-primary px-5" id="delete" data-bs-dismiss="modal"
                (click)="deleteExternalClaimExperience()">
                {{'gis.policy.yes_delete' | translate}}
              </button>
            </div>
            <div class="d-flex justify-content-center mb-2">
              <button type="button" class="btn btn-outline-primary px-5" data-bs-dismiss="modal">
                {{'gis.policy.no_im_not' | translate}}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add External Claims Experience Modal -->
    <div class="modal fade" id="addExternalClaimExperienceModal" tabindex="-1"
      aria-labelledby="addExternalClaimExperienceModal" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-body">
            <button type="button" #closebutton class="btn-close float-end" data-bs-dismiss="modal" aria-label="Close"
              (click)="clearForm()"></button>
            <h5 class="modal-title" id="modalTitle">Define a new claims experience</h5>

            <form [formGroup]="insurersDetailsForm">
              <div class="row mt-4">
                <!-- Policy No -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="policyNumber" class="form-label external-claim-label col-3 mb-0 pe-2">Policy no.</label>
                  <div class="col-8 ps-0">
                    <input type="text" class="form-control external-claim-input" id="policyNumber" placeholder=""
                      formControlName="policyNumber">
                    <div
                      *ngIf="insurersDetailsForm.get('policyNumber').hasError('required') && insurersDetailsForm.get('policyNumber').touched"
                      class="form-text text-danger">
                      Policy number is required
                    </div>
                  </div>
                </div>

                <!-- Insurer -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="insurer" class="form-label external-claim-label col-3 mb-0 pe-2">Insurer</label>
                  <div class="col-8 ps-0">
                    <p-dropdown [options]="insurersList" formControlName="insurer" optionLabel="name" [filter]="true"
                      filterBy="name" [showClear]="true" placeholder="Select an insurer"
                      class="w-100 form-control-md custom-dropdown-height" (onChange)="onInsurerChange($event)"
                      [style]="{ 'height': '38px' }">
                      <ng-template pTemplate="item" let-insurer>
                        <div class="d-flex align-items-center">
                          <div>{{ insurer.name }}</div>
                        </div>
                      </ng-template>
                    </p-dropdown>
                    <div
                      *ngIf="insurersDetailsForm.get('insurer').hasError('required') && insurersDetailsForm.get('insurer').touched"
                      class="form-text text-danger">
                      Insurer is required
                    </div>
                  </div>
                </div>

                <!-- Year -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="year" class="form-label external-claim-label col-3 mb-0 pe-2">Year</label>
                  <div class="col-8 ps-0">
                    <input type="number"
                      class="form-control external-claim-input"
                      id="year"
                      placeholder="YYYY"
                      formControlName="year"
                      [min]="1900"
                      [max]="acceptedYear">
                    <div *ngIf="insurersDetailsForm.get('year').touched" class="form-text text-danger">
                      <div *ngIf="insurersDetailsForm.get('year').hasError('required')">
                        Year is required
                      </div>
                      <div *ngIf="insurersDetailsForm.get('year').hasError('max')">
                        Year cannot be past {{  acceptedYear }}
                      </div>
                      <div *ngIf="insurersDetailsForm.get('year').hasError('pattern') && insurersDetailsForm.get('year').hasError('min')">
                        Please enter a valid year
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Risk Details -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="riskDetails" class="form-label external-claim-label col-3 mb-0 pe-2">Risk details</label>
                  <div class="col-8 ps-0">
                    <input type="text" class="form-control external-claim-input" id="riskDetails" placeholder=""
                      formControlName="riskDetails">
                    <div
                      *ngIf="insurersDetailsForm.get('riskDetails').hasError('required') && insurersDetailsForm.get('riskDetails').touched"
                      class="form-text text-danger">
                      Risk details are required
                    </div>
                  </div>
                </div>

                <!-- Loss Ratio -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="lossRatio" class="form-label external-claim-label col-3 mb-0 pe-2">Loss ratio</label>
                  <div class="col-8 ps-0">
                    <input type="number" class="form-control external-claim-input" id="lossRatio" placeholder=""
                      formControlName="lossAmount">
                    <div
                      *ngIf="insurersDetailsForm.get('lossAmount').hasError('required') && insurersDetailsForm.get('lossAmount').touched"
                      class="form-text text-danger">
                      Loss ratio is required
                    </div>
                  </div>
                </div>

                <!-- Claim Paid -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="claimPaid" class="form-label external-claim-label col-3 mb-0 pe-2">Claim paid</label>
                  <div class="col-8 ps-0">
                    <select class="form-select" id="product-input" formControlName="claimPaid">
                      <option value="Y">Yes</option>
                      <option value="N">No</option>
                    </select>
                    <div
                      *ngIf="insurersDetailsForm.get('claimPaid').hasError('required') && insurersDetailsForm.get('claimPaid').touched"
                      class="form-text text-danger">
                      Claim paid is required
                    </div>
                  </div>
                </div>

                <!-- noAccrual -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="noAccrual" class="form-label external-claim-label col-3 mb-0 pe-2">noAccrual</label>
                  <div class="col-8 ps-0">
                    <input type="number" class="form-control external-claim-input" id="noAccrual" placeholder=""
                      formControlName="noAccrual">
                    <div
                      *ngIf="insurersDetailsForm.get('noAccrual').hasError('required') && insurersDetailsForm.get('noAccrual').touched"
                      class="form-text text-danger">
                      noAccrual is required
                    </div>
                  </div>
                </div>

                <!-- Damage Amount -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="damageAmount" class="form-label external-claim-label col-3 mb-0 pe-2">Damage
                    amount</label>
                  <div class="col-8 ps-0">
                    <input type="text" class="form-control external-claim-input" id="damageAmount" placeholder=""
                      formControlName="damageAmount" appCommaFormat>
                    <div
                      *ngIf="insurersDetailsForm.get('damageAmount').hasError('required') && insurersDetailsForm.get('damageAmount').touched"
                      class="form-text text-danger">
                      Damage amount is required
                    </div>
                  </div>
                </div>

                <!-- Third Party Amount -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="thirdPartyAmount" class="form-label external-claim-label col-3 mb-0 pe-2">Third party
                    amount</label>
                  <div class="col-8 ps-0">
                    <input type="text" class="form-control external-claim-input" id="thirdPartyAmount" placeholder=""
                      formControlName="totalPaidAmount" appCommaFormat>
                    <div
                      *ngIf="insurersDetailsForm.get('totalPaidAmount').hasError('required') && insurersDetailsForm.get('totalPaidAmount').touched"
                      class="form-text text-danger">
                      Third party amount is required
                    </div>
                  </div>
                </div>

                <!-- Other Amount -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="otherAmount" class="form-label external-claim-label col-3 mb-0 pe-2">Other amount</label>
                  <div class="col-8 ps-0">
                    <input type="text" class="form-control external-claim-input" id="otherAmount" placeholder=""
                      formControlName="otherAmount" appCommaFormat>
                    <div
                      *ngIf="insurersDetailsForm.get('otherAmount').hasError('required') && insurersDetailsForm.get('otherAmount').touched"
                      class="form-text text-danger">
                      Other amount is required
                    </div>
                  </div>
                </div>

                <!-- Remarks -->
                <div class="mb-3 d-flex align-items-center">
                  <label for="remarks" class="form-label external-claim-label col-3 mb-0 pe-2">Remarks</label>
                  <div class="col-8">
                    <input type="text" class="form-control external-claim-input" id="remarks" placeholder=""
                      formControlName="remarks">
                    <div
                      *ngIf="insurersDetailsForm.get('remarks').hasError('required') && insurersDetailsForm.get('remarks').touched"
                      class="form-text text-danger">
                      Remarks are required
                    </div>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-end mt-2 mb-2">
                <button type="button" class="btn btn-outline-primary mx-3" #closebutton data-bs-dismiss="modal"
                  (click)="clearForm()">Cancel</button>
                <button type="button" class="btn btn-primary" #closebutton
                  (click)="externalClaimExpAction()">Save</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>


    <div class="tab-pane fade" id="nav-authorization" role="tabpanel" aria-labelledby="nav-authorization-tab"
      tabindex="0">
      <div class="card mb-4">
        <div class="card-body">
          <h6 class="mb-4">Choose Report</h6>

          <div class="form-check form-check-inline" id="report-checks">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
            <label class="form-check-label" for="inlineCheckbox1">Quotation summary document</label>
          </div>
          <div class="form-check form-check-inline" id="report-checks">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
            <label class="form-check-label" for="inlineCheckbox2">Quotation premium calculation</label>
          </div>
          <div class="form-check form-check-inline" id="report-checks">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
            <label class="form-check-label" for="inlineCheckbox1">Quotation document</label>
          </div>
          <br><br>
          <div class="form-check form-check-inline" id="report-checks" style="margin-right: 10%;">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
            <label class="form-check-label" for="inlineCheckbox1">Quotation clauses document</label>
          </div>
          <div class="form-check form-check-inline" id="report-checks">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
            <label class="form-check-label" for="inlineCheckbox2">Quotation schedules</label>
          </div>
        </div>
        <br>
        <div class="float-end mb-3">
          <button class="btn btn-primary float-end mr-3" style="margin-right: 13px;">Download</button>
          <button class="btn btn-outline-primary float-end" style="margin-right: 10px;" (click)="makeReady()"
            *ngIf="makeQuotationReady">Make Quotation Ready</button>
          <button class="btn btn-outline-primary float-end" style="margin-right: 10px;" (click)="confirm()"
            *ngIf="confirmQuotation">Confirm</button>
          <button class="btn btn-outline-primary float-end" style="margin-right: 10px;" (click)="authorise()"
            *ngIf="authoriseQuotation">Authorise</button>
        </div>
      </div>
      <div class="card mb-4">
        <div class="card-body">
          <h6 class="mb-4">Communication</h6>

          <div class="form-check form-check-inline">
            <label style="margin-left:-24px">Send</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1"
              (change)="showCommunicationDetails('email')" value="option1">
            <label class="form-check-label" for="inlineRadio1">Email</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="inlineRadioOptions"
              (change)="showCommunicationDetails('sms')" id="inlineRadio2" value="option2">
            <label class="form-check-label" for="inlineRadio2">SMS</label>
          </div>
          <br><br>

          <div *ngIf="showSms">
            <div class="row mr-4">
              <div class="col-sm">
                <div class="row mb-3">
                  <label class="col-sm-4 col-form-label" id="communicationLabel">SMS Template</label>
                  <div class="col-sm-8">
                    <input type="text" class="form-control" id="inputEmail3">
                  </div>
                </div>
              </div>
              <div class="col-sm">
                <div class="form-check form-check-reverse" id="report-checks">
                  <label class="form-check-label" for="inlineCheckbox2" id="communicationLabel">Send to client</label>
                  <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
                </div>
              </div>
              <div class="col-sm">
                <div class="form-check form-check-reverse" id="report-checks">
                  <label class="form-check-label" for="inlineCheckbox1" id="communicationLabel">Send to agent</label>
                  <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
                </div>
              </div>
            </div>
            <div class="float-end mb-3">
              <button class="btn btn-primary float-end mr-3" style="margin-right: 13px;">Cancel</button>
              <button class="btn btn-outline-primary float-end" style="margin-right: 10px;" data-bs-toggle="modal"
                data-bs-target="#smsModal">Okay</button>
            </div>
          </div>


          <div *ngIf="showEmail">
            <div class="row ">
              <div class="col-sm">
                <div class="row mb-3">
                  <label class="col-sm-6 col-form-label" id="communicationLabel">Email Template</label>
                  <div class="col-sm-6">
                    <input type="text" class="form-control" id="inputEmail3">
                  </div>
                </div>
              </div>
              <div class="col-sm">
                <div class="form-check form-check-reverse">
                  <label class="form-check-label" for="inlineCheckbox2" id="communicationLabel">Send to client</label>
                  <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
                </div>
              </div>
              <div class="col-sm">
                <div class="form-check form-check-reverse">
                  <label class="form-check-label" for="inlineCheckbox1" id="communicationLabel">Send to agent</label>
                  <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
                </div>
              </div>
              <div class="col-sm">
                <div class="form-check form-check-reverse">
                  <label class="form-check-label" for="inlineCheckbox1" id="communicationLabel">Send to all
                    agent</label>
                  <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
                </div>
              </div>
            </div>
            <div class="float-end mb-3">
              <button class="btn btn-primary float-end mr-3" style="margin-right: 13px;">Cancel</button>
              <button class="btn btn-outline-primary float-end" style="margin-right: 10px;" data-bs-toggle="modal"
                data-bs-target="#emailModal">Okay</button>
            </div>
          </div>

          <!-- Email Modal -->
          <div class="modal fade" id="emailModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-body">
                  <h6 class="mb-3">Details</h6>
                  <!-- Client and Agent -->
                  <div class="row ">
                    <div class="col-sm">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Client</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted">{{ clientDetails?.firstName+" "+clientDetails?.lastName }}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Agent</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted"></p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Quotation Code -->
                  <div class="row mb-2">
                    <div class="col-sm-8">
                      <div class="row">
                        <div class="col-sm-5">
                          <h6>Quotation Code</h6>
                        </div>
                        <div class="col-sm-7">
                          <p class="text-muted">{{quotationCode}}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">
                      <!--  -->
                    </div>
                  </div>

                  <!-- Quotation Number -->
                  <div class="row mb-2">
                    <div class="col-sm-10">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Quotation Number</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted">{{quotationNumber}}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-2">
                    </div>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" value="">
                    <label class="form-check-label">
                      Include policy batch documents
                    </label>
                  </div>
                  <h6 class="mb-3">Message Details</h6>
                  <form [formGroup]="emailForm">

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">To</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="address">
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">CC</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="cc">
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">BCC</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="bcc">
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">Subject</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="subject">
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">Message</label>
                      <div class="col-sm-9">
                        <textarea class="form-control" rows="3" formControlName="message"></textarea>
                      </div>
                    </div>
                  </form>

                  <button class="btn btn-primary float-end" data-bs-dismiss="modal" (click)="emaildetails()">Send
                    Email</button>
                </div>
              </div>
            </div>
          </div>

          <!--SMS  Modal -->
          <div class="modal fade" id="smsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">

                <div class="modal-body">
                  <h6 class="mb-3">Details</h6>

                  <!-- Client and Agent -->
                  <div class="row ">
                    <div class="col-sm">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Client</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted">{{ clientDetails?.firstName+" "+clientDetails?.lastName }}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Agent</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted"></p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Quotation Code -->
                  <div class="row mb-2">
                    <div class="col-sm-8">
                      <div class="row">
                        <div class="col-sm-5">
                          <h6>Quotation Code</h6>
                        </div>
                        <div class="col-sm-7">
                          <p class="text-muted">{{quotationCode}}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">
                      <!--  -->
                    </div>
                  </div>

                  <!-- Quotation Number -->
                  <div class="row mb-2">
                    <div class="col-sm-10">
                      <div class="row">
                        <div class="col-sm-4">
                          <h6>Quotation Number</h6>
                        </div>
                        <div class="col-sm-8">
                          <p class="text-muted">{{quotationNumber}}</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <!--  -->
                    </div>
                  </div>

                  <h6 class="mb-3">Message Details</h6>
                  <form [formGroup]="smsForm">

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">Receiver Phone No.</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="recipients">
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">Sender Phone No.</label>
                      <div class="col-sm-9">
                        <input type="text" class="form-control" formControlName="sender">
                      </div>
                    </div>

                    <div class="mb-3 row">
                      <label class="col-sm-3 col-form-label" id="messageLabel">Message</label>
                      <div class="col-sm-9">
                        <textarea class="form-control" rows="3" formControlName="message"></textarea>
                      </div>
                    </div>

                  </form>

                  <button class="btn btn-primary float-end" data-bs-dismiss="modal" (click)="sendSms()">Send
                    SMS</button>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card mb-4">
        <div class="card-body">
          <h6 class="mb-4">Documents</h6>
          <div class="row mt-3 mb-4 g-3 align-items-center">
            <div class="col-auto">
              <label for="documentTypes" class="col-form-label">Document Type</label>
            </div>
            <div class="col-auto">
              <select class="form-select form-select-sm mb-1" id="quote-input" placement="right"
                (change)="onDocumentTypeChange($event)">
                <option [value]="" selected="true" disabled="disabled"></option>
                <option *ngFor="let data of documentTypes" [value]="data.id">{{data.description}}</option>
              </select>
            </div>
            <div class="col-auto">
              <!--  -->
            </div>
          </div>

          <div class="card" style="border: 2px dashed black;">
            <div class="card-body">
              <div class="d-flex justify-content-center">
                <i class="pi pi-arrow-circle-up mb-4" style="font-size: 2.5rem"></i>
              </div>
              <p class="text-center">
                Drag and drop files to upload or
                <span class="browse-link" (click)="onBrowseClick()">browse</span>
              </p>
              <input type="file" #fileInput style="display: none;" (change)="onFileSelected($event)">
            </div>
          </div>

          <div *ngIf="files.length > 0" class="file-list">
            <h6>Uploaded Files</h6>
            <div *ngFor="let file of files; let i = index" class="file-item">

              <input type="checkbox" [(ngModel)]="file.selected">
              <span class="file-name">{{ file.documentType }} - {{ file.name }}</span>
              <span class="file-actions">
                <i class="fas fa-download" (click)="downloadFile(file)"></i>
                <i class="fas fa-print" (click)="printFile(file)"></i>
                <i class="fas fa-trash" (click)="deleteFile(i)"></i>
              </span>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>


</div>
