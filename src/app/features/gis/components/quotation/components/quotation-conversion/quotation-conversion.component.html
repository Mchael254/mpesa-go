<div class="container" style="max-width: 90%; margin: 0 auto;">
  <!-- Page Title -->
  <p class="titleMain mt-3 mb-5">{{ 'gis.quotation.quotation_conversion' | translate }}</p>

  <!-- Input Fields Section -->
  <div class="input-section p-4 mb-4" style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <!-- First Row -->
    <div class="row">
      <div class="row">
        <div class="col-md-3">
          <!-- Search Type Dropdown -->
          <div class="field mb-4 w-full">
            <label for="search-type" class="quote-label required">
              {{ 'gis.quotation.client' | translate }}
            </label><br>
            <input
              type="text"
              id="quote-input"
              class="form-select form-control form-control-sm mb-1"
              [value]="clientName"
              data-bs-toggle="modal"
              data-bs-target="#clientSearchModal"
              readonly
              placeholder="Search by client"
            />
          </div>

          <!-- Client Search Modal Component -->
          <app-client-search-modal
            (clientSelected)="onClientSelected($event)"
          ></app-client-search-modal>
        </div>

        <div class="col-md-3">
          <!-- Search Type Dropdown -->
          <div class="field mb-4 w-full">
            <label for="search-type" class="quote-label required">
              {{ 'gis.quotation.agent' | translate }}
            </label><br>
            <input
              type="text"
              id="quote-input"
              class="form-select form-control form-control-sm mb-1"
              [value]="agentName"
              data-bs-toggle="modal"
              data-bs-target="#agentSearchModal"
              readonly
              placeholder="Search by agent"
            />
          </div>

          <!-- Client Search Modal Component -->
          <app-agent-search-modal
            (agentSelected)="onAgentSelected($event)"
          ></app-agent-search-modal>
        </div>
    </div>

    <!-- Second Row -->
    <div class="row g-3 align-items-center mb-3">
      <div class="col">
        <!-- Products Dropdown -->
        <div class="field">
          <label for="product" class="quote-label" id="product">
            {{ 'gis.quotation.search_results' | translate }}
          </label><br>
          <input
            type="text"
            id="quote-input"
            class="form-select form-control form-control-sm mb-1"
            [value]="productName"
            data-bs-toggle="modal"
            data-bs-target="#productSearchModal"
            readonly
            placeholder="Select a product"
          />

          <!-- Client Search Modal Component -->
          <app-product-search-modal
            (productSelected)="onProductSelected($event)">
          </app-product-search-modal>
        </div>
      </div>

      <div class="col">
        <!-- Quotation Number Input -->
        <div class="field">
          <label for="quote-number" class="quote-label" id="quote-number">
            <br>
          </label><br>
          <input
            type="text"
            id="quote-number-input"
            class="form-control form-control-sm mb-1"
            [(ngModel)]="quotationNumber"
            (ngModelChange)="onInputChange()"
            placeholder="Enter Quotation Number"
            [style]="{ 'height': '38px' }"
          />
        </div>
      </div>

      <div class="col">
        <!-- Status Type Dropdown -->
        <div class="field">
          <label for="product" class="quote-label" id="product">
            <br>
           </label><br>
           <p-dropdown
            [options]="status"
            [(ngModel)]="selectedStatus"
            optionLabel="status"
            [filter]="true"
            filterBy="status"
            [showClear]="true"
            placeholder="Status"
            [style]="{ 'width': '100%', 'height': '38px' }">
            <ng-template pTemplate="selectedItem">
              <div class="business-type-item business-type-value" *ngIf="selectedStatus">
                <div>{{ selectedStatus.status }}</div>
              </div>
            </ng-template>
            <ng-template let-status pTemplate="item">
              <div class="business-type-item">
                <div>{{ status.status }}</div>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>

      <div class="col">
        <!-- Effective From Date -->
        <div class="field">
          <label for="product" class="quote-label" id="product">
            <br>
           </label><br>
          <p-calendar
            name="withEffectiveFromDate"
            [(ngModel)]="fromDate"
            [dateFormat]="dateFormat"
            [showIcon]="true"
            [showButtonBar]="true"
            [placeholder]="'Select start date'"
            [minDate]="minDate"
            (onSelect)="onDateFromInputChange($event)"
            (onClear)="clearDateFilters()"
            [style]="{ 'width': '100%', 'height': '38px' }">
          </p-calendar>
        </div>
      </div>

      <div class="col">
        <!-- Effective To Date -->
        <div class="field">
          <label for="product" class="quote-label" id="product">
            <br>
           </label><br>
          <p-calendar
            name="withEffectiveToDate"
            [(ngModel)]="toDate"
            [dateFormat]="dateFormat"
            [showIcon]="true"
            [showButtonBar]="true"
            [placeholder]="'Select end date'"
            [minDate]="minToDate"
            (onSelect)="onDateToInputChange($event)"
            (onClear)="clearDateFilters()"
            [style]="{ 'width': '100%', 'height': '38px' }">
          </p-calendar>
        </div>
      </div>
    </div>
  </div>

  <!-- Add this right after the second row div -->
  <div class="row mt-2">
    <div class="col-12 d-flex justify-content-start">
      <button class="btn btn-outline-primary me-2" (click)="fetchGISQuotations()">
        {{ 'gis.quotation.search' | translate }}
      </button>
      <button class="btn btn-primary" (click)="clearFilters()">
        {{ 'gis.quotation.clear' | translate }}
      </button>
    </div>
  </div>

  <!-- Table Section -->
  <div class="table-section mt-4 mb-3">
    <p class="title mb-3">{{ 'gis.quotation.product_details' | translate }}</p>
    <p-table [value]="gisQuotationList" [paginator]="true" [rows]="10" [scrollable]="true"
      scrollDirection="horizontal" [showCurrentPageReport]="true"
      currentPageReportTemplate=" {first} - {last} of {totalRecords}" [responsiveLayout]="'scroll'"
      [resizableColumns]="true" [reorderableColumns]="true">
      <ng-template pTemplate="header">
        <tr>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.quotation_number' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.client' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.agent' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.premium' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.status' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.cover_from' | translate }}</th>
          <th style="background-color: #f0f0f0">{{ 'gis.quotation.cover_to' | translate }}</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-quotation>
        <tr style="cursor: pointer">
          <td>{{quotation.quotationNumber}}</td>
          <td>{{quotation.clientName}}</td>
          <td>{{quotation.agentShortDescription}}</td>
          <td>{{quotation.premium || 0}}</td>
          <td>{{quotation.status}}</td>
          <td>{{quotation.fromDate}}</td>
          <td>{{quotation.toDate}}</td>
          <td id="action-buttons">{{ "View quote" }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="1"></td>

          <td colspan="10" style="padding:20px;padding-left: 340px;" id="empty">
            {{'gis.quotation.no_data_to_display' | translate}}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Quotation Products Section -->
  <div class="quotation-products-section mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <p class="title mb-3">{{'gis.quotation.quotation_products' | translate}}</p>
      <div>
        <button class="btn btn-outline-primary me-2">{{'gis.quotation.merge_to_policy' | translate}}</button>
        <button class="btn btn-primary">{{'gis.quotation.convert_to_policy' | translate}}</button>
      </div>
    </div>

    <p-table [tableStyle]="{ 'min-width': '50px' }">
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 50px; background-color: #f0f0f0">
            <input type="checkbox" id="selectAll" />
          </th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.product' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.start_date' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.end_date' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.premium' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.commission' | translate}}</th>
          <th style="background-color: #f0f0f0">FAP</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.remarks' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.converted' | translate}}</th>
          <th style="background-color: #f0f0f0">{{'gis.quotation.policy_no' | translate}}</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>
            <input type="checkbox" id="productCheckbox{{ product.id }}" />
          </td>
          <td>Product</td>
          <td>Start date</td>
          <td>End date</td>
          <td>Premium</td>
          <td>Commission</td>
          <td>FAP</td>
          <td>Remarks</td>
          <td>Converted</td>
          <td>Policy no.</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="10" class="text-center py-4">
            {{'gis.quotation.no_data' | translate}}
          </td>
        </tr>
      </ng-template>
    </p-table>

  </div>
</div>
