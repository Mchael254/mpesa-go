<div class="base-content-section">
  <div class="row me-4">
    <div class="col-8">
      <app-dynamic-breadcrumb
        [breadCrumbItems]="[
      {
        label: 'Administration',
        url: '/home/crm'
      },
      {
        label: 'CRM Setups',
        url: '/home/crm',
      },
      {
        label: 'Activity Management',
        url: '/home/crm/activities'
      },
      {
        label: 'Activities',
        url: ''
      }
    ]"
      >
      </app-dynamic-breadcrumb>
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      <div class="row mb-2">
        <div class="col-sm-12 col-md-6">
          <h5 class="text-dark">Activities</h5>
        </div>

        <div class="col-sm-12 col-md-6 d-flex justify-content-lg-end">
          <div class="float-end">
            <span class="icon-circle">
              <i
                class="fa-solid fa-plus"
                (click)="openDefineActivityModal()"
              ></i>
            </span>
            <span class="icon-circle">
              <i class="pi pi-pencil" (click)="editActivity()"></i>
            </span>
            <span class="icon-circle">
              <i class="fa-regular fa-trash-can"></i>
            </span>
          </div>
        </div>
      </div>
      <p-table
        #activitiesTable
        [autoLayout]="true"
        [rowHover]="true"
        [resizableColumns]="true"
        [showCurrentPageReport]="true"
        [rows]="pageSize || 5"
        [totalRecords]="activityData?.length"
        [value]="activityData"
        [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
        responsiveLayout="stack"
        [scrollable]="true"
        [(selection)]="selectedActivity"
        selectionMode="single"
        dataKey="code"
        scrollHeight="400px"
        currentPageReportTemplate="{first} - {last} of {totalRecords}"
        [globalFilterFields]="['description', 'code']"
      >
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="gis_exception_code">
              Subject <p-sortIcon field="gis_exception_code"></p-sortIcon>
            </th>
            <th pSortableColumn="objective">
              Start Date <p-sortIcon field="objective"></p-sortIcon>
            </th>
            <th pSortableColumn="description">
              End Date <p-sortIcon field="description"></p-sortIcon>
            </th>
            <th>Duration</th>
            <th>Location</th>
            <th>Assigned To</th>
            <th>Related To</th>
            <th pSortableColumn="authorised">
              Status <p-sortIcon field="authorised"></p-sortIcon>
            </th>
            <th pSortableColumn="transactions_date">
              Type <p-sortIcon field="transactions_date"></p-sortIcon>
            </th>
            <th pSortableColumn="authorised_by">
              Description <p-sortIcon field="authorised_by"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-activity>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="10">No Activity Detail(s) Found.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-body">
      <div class="row mb-2">
        <div class="col-sm-12 col-md-6">
          <h5 class="text-dark">Notes and attachments</h5>
        </div>

        <div class="col-sm-12 col-md-6 d-flex justify-content-lg-end">
          <div class="float-end">
            <span class="icon-circle">
              <i class="fa-solid fa-plus" (click)="openDefineNoteModal()"></i>
            </span>
            <span class="icon-circle">
              <i class="pi pi-pencil" (click)="editNote()"></i>
            </span>
            <span class="icon-circle">
              <i class="fa-regular fa-trash-can"></i>
            </span>
          </div>
        </div>
      </div>
      <p-table
        #notesAndAttachmentsTable
        [autoLayout]="true"
        [rowHover]="true"
        [resizableColumns]="true"
        [showCurrentPageReport]="true"
        [rows]="pageSize || 5"
        [totalRecords]="notesAndAttachmentsData?.length"
        [value]="notesAndAttachmentsData"
        [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
        responsiveLayout="stack"
        [scrollable]="true"
        [(selection)]="selectedNotes"
        selectionMode="single"
        dataKey="code"
        scrollHeight="400px"
        currentPageReportTemplate="{first} - {last} of {totalRecords}"
        [globalFilterFields]="['description', 'code']"
      >
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="gis_exception_code">
              Subject <p-sortIcon field="gis_exception_code"></p-sortIcon>
            </th>
            <th pSortableColumn="objective">
              Related To <p-sortIcon field="objective"></p-sortIcon>
            </th>
            <th pSortableColumn="description">
              Description <p-sortIcon field="description"></p-sortIcon>
            </th>
            <th pSortableColumn="authorised">
              Attachment <p-sortIcon field="authorised"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-note>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4">No Notes and Attachments Detail(s) Found.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-body">
      <div class="row mb-2">
        <div class="col-sm-12 col-md-6">
          <h5 class="text-dark">Tasks</h5>
        </div>

        <div class="col-sm-12 col-md-6 d-flex justify-content-lg-end">
          <div class="float-end">
            <span class="icon-circle">
              <i class="fa-solid fa-plus" (click)="openDefineTaskModal()"></i>
            </span>
            <span class="icon-circle">
              <i class="pi pi-pencil" (click)="editTask()"></i>
            </span>
            <span class="icon-circle">
              <i class="fa-regular fa-trash-can"></i>
            </span>
          </div>
        </div>
      </div>
      <p-table
        #tasksTable
        [autoLayout]="true"
        [rowHover]="true"
        [resizableColumns]="true"
        [showCurrentPageReport]="true"
        [rows]="pageSize || 5"
        [totalRecords]="tasksData?.length"
        [value]="tasksData"
        [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
        responsiveLayout="stack"
        [scrollable]="true"
        [(selection)]="selectedTask"
        selectionMode="single"
        dataKey="code"
        scrollHeight="400px"
        currentPageReportTemplate="{first} - {last} of {totalRecords}"
        [globalFilterFields]="['description', 'code']"
      >
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="gis_exception_code">
              Subject <p-sortIcon field="gis_exception_code"></p-sortIcon>
            </th>
            <th pSortableColumn="objective">
              Start Date <p-sortIcon field="objective"></p-sortIcon>
            </th>
            <th pSortableColumn="description">
              End Date <p-sortIcon field="description"></p-sortIcon>
            </th>
            <th pSortableColumn="authorised">
              Status <p-sortIcon field="authorised"></p-sortIcon>
            </th>
            <th>Priority</th>
            <th>Related To</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-task>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="6">No Tasks Detail(s) Found.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-body">
      <div class="row mb-2">
        <div class="col-sm-12 col-md-6">
          <h5 class="text-dark">Participants</h5>
        </div>

        <div class="col-sm-12 col-md-6 d-flex justify-content-lg-end">
          <div class="float-end">
            <button class="btn btn-primary">Send invite</button>
            <span class="icon-circle">
              <i class="fa-solid fa-plus" (click)="openAllUsersModal()"></i>
            </span>
            <span class="icon-circle">
              <i class="fa-regular fa-trash-can"></i>
            </span>
          </div>
        </div>
      </div>
      <p-table
        #participantsTable
        [autoLayout]="true"
        [rowHover]="true"
        [resizableColumns]="true"
        [showCurrentPageReport]="true"
        [rows]="pageSize || 5"
        [totalRecords]="partipantsData?.length"
        [value]="partipantsData"
        [rowsPerPageOptions]="[5, 10, 20, 30, 50, 100]"
        responsiveLayout="stack"
        [scrollable]="true"
        [(selection)]="selectedParticipant"
        selectionMode="single"
        dataKey="code"
        scrollHeight="400px"
        currentPageReportTemplate="{first} - {last} of {totalRecords}"
        [globalFilterFields]="['description', 'code']"
      >
        <ng-template pTemplate="header">
          <tr>
            <th></th>
            <th pSortableColumn="gis_exception_code">
              Name <p-sortIcon field="gis_exception_code"></p-sortIcon>
            </th>
            <th pSortableColumn="objective">
              Email <p-sortIcon field="objective"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-participant>
          <tr>
            <td>
              <p-tableCheckbox></p-tableCheckbox>
            </td>
            <td></td>
            <td></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="3">No Participants Detail(s) Found.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>

<!--Create activity modal-->
<div
  class="modal fade"
  #newActivity
  id="newActivity"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header border-bottom-0 pb-0">
        <h5 class="modal-title text-black">
          {{ editMode ? "Edit" : "Define" }}
          {{ editMode ? "an activity" : "a new activity" }}
        </h5>
        <button
          type="button"
          class="btn-close"
          (click)="closeDefineActivityModal()"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="createActivityForm">
          <div class="row my-3">
            <ng-container *ngIf="visibleStatus.subject === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="subject">Subject</label>
                <input
                  type="text"
                  class="form-control"
                  id="subject"
                  formControlName="subject"
                  [ngClass]="{
                    'is-invalid':
                      g['subject']?.invalid &&
                      (g['subject']?.dirty || g['subject']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['subject']?.invalid &&
                    (g['subject']?.dirty || g['subject']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['subject']?.errors['required']">
                    Subject is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.activityType === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="activityType"
                  >Activity type</label
                >
                <select
                  id="activityType"
                  class="form-select"
                  formControlName="activityType"
                  [ngClass]="{
                    'is-invalid':
                      g['activityType']?.invalid &&
                      (g['activityType']?.dirty || g['activityType']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    g['activityType']?.invalid &&
                    (g['activityType']?.dirty || g['activityType']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['activityType']?.errors['required']">
                    Activity type is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.description === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="description"
                  >Description</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="description"
                  formControlName="description"
                  [ngClass]="{
                    'is-invalid':
                      g['description']?.invalid &&
                      (g['description']?.dirty || g['description']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['description']?.invalid &&
                    (g['description']?.dirty || g['description']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['description']?.errors['required']">
                    Description is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.location === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="location">Location</label>
                <input
                  type="text"
                  class="form-control"
                  id="location"
                  formControlName="location"
                  [ngClass]="{
                    'is-invalid':
                      g['location']?.invalid &&
                      (g['location']?.dirty || g['location']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['location']?.invalid &&
                    (g['location']?.dirty || g['location']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['location']?.errors['required']">
                    Location is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.assignedTo === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="assignedTo"
                  >Assigned To</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="assignedTo"
                  formControlName="assignedTo"
                  [ngClass]="{
                    'is-invalid':
                      g['assignedTo']?.invalid &&
                      (g['assignedTo']?.dirty || g['assignedTo']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['assignedTo']?.invalid &&
                    (g['assignedTo']?.dirty || g['assignedTo']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['assignedTo']?.errors['required']">
                    Assigned to is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.relatedAccount === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="relatedAccount"
                  >Related Account</label
                >
                <select
                  id="relatedAccount"
                  class="form-select"
                  formControlName="relatedAccount"
                  [ngClass]="{
                    'is-invalid':
                      g['relatedAccount']?.invalid &&
                      (g['relatedAccount']?.dirty ||
                        g['relatedAccount']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    g['relatedAccount']?.invalid &&
                    (g['relatedAccount']?.dirty || g['relatedAccount']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['relatedAccount']?.errors['required']">
                    Related account is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.startDate === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="startDate"
                  >Start Date</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="startDate"
                  formControlName="startDate"
                  [ngClass]="{
                    'is-invalid':
                      g['startDate']?.invalid &&
                      (g['startDate']?.dirty || g['startDate']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['startDate']?.invalid &&
                    (g['startDate']?.dirty || g['startDate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['startDate']?.errors['required']">
                    Start date is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.endDate === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="endDate">End Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="endDate"
                  formControlName="endDate"
                  [ngClass]="{
                    'is-invalid':
                      g['endDate']?.invalid &&
                      (g['endDate']?.dirty || g['endDate']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['endDate']?.invalid &&
                    (g['endDate']?.dirty || g['endDate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['endDate']?.errors['required']">
                    End date is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.duration === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="duration">Duration</label>
                <input
                  type="number"
                  class="form-control"
                  id="duration"
                  formControlName="duration"
                  [ngClass]="{
                    'is-invalid':
                      g['duration']?.invalid &&
                      (g['duration']?.dirty || g['duration']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['duration']?.invalid &&
                    (g['duration']?.dirty || g['duration']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['duration']?.errors['required']">
                    Duration is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.status === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="status">Status</label>
                <input
                  type="text"
                  class="form-control"
                  id="status"
                  formControlName="status"
                  [ngClass]="{
                    'is-invalid':
                      g['status']?.invalid &&
                      (g['status']?.dirty || g['status']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    g['status']?.invalid &&
                    (g['status']?.dirty || g['status']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['status']?.errors['required']">
                    Status is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.team === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="team">Team</label>
                <select
                  id="team"
                  class="form-select"
                  formControlName="team"
                  [ngClass]="{
                    'is-invalid':
                      g['team']?.invalid &&
                      (g['team']?.dirty || g['team']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    g['team']?.invalid &&
                    (g['team']?.dirty || g['team']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['team']?.errors['required']">
                    Team is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.emailTemplate === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="emailTemplate"
                  >Email Template</label
                >
                <select
                  id="emailTemplate"
                  class="form-select"
                  formControlName="emailTemplate"
                  [ngClass]="{
                    'is-invalid':
                      g['emailTemplate']?.invalid &&
                      (g['emailTemplate']?.dirty || g['emailTemplate']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    g['emailTemplate']?.invalid &&
                    (g['emailTemplate']?.dirty || g['emailTemplate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['emailTemplate']?.errors['required']">
                    Email template is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.sendReminder === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="sendReminder"
                  >Send reminder?</label
                >
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    formControlName="sendReminder"
                    id="sendReminder"
                    value="Y"
                  />
                  <label class="form-check-label text-black" for="sendReminder"
                    >Yes</label
                  >
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    formControlName="sendReminder"
                    id="sendReminder"
                    value="N"
                  />
                  <label class="form-check-label text-black" for="sendReminder"
                    >No</label
                  >
                </div>
                <div
                  *ngIf="
                    g['sendReminder']?.invalid &&
                    (g['sendReminder']?.dirty || g['sendReminder']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="g['sendReminder']?.errors['required']">
                    Send reminder is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container
              *ngIf="createActivityForm.get('sendReminder').value === 'Y'"
            >
              <div class="col-md-6">
                <label class="form-label w-100" for="reminderTime"
                  >Reminder Time</label
                >
                <input
                  type="datetime-local"
                  class="form-control"
                  id="reminderTime"
                  formControlName="reminderTime"
                />
              </div>
            </ng-container>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-primary"
          (click)="createActivity()"
        >
          Save details
        </button>
      </div>
    </div>
  </div>
</div>

<!--Create note modal-->
<div
  class="modal fade"
  #newNote
  id="newNote"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header border-bottom-0 pb-0">
        <h5 class="modal-title text-black">
          {{ editMode ? "Edit" : "Define" }} a
          {{ editMode ? "note" : "new note" }}
        </h5>
        <button
          type="button"
          class="btn-close"
          (click)="closeDefineNoteModal()"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="createNoteForm">
          <div class="row my-3">
            <ng-container *ngIf="visibleStatus.noteSubject === 'Y'">
              <div class="col-md-12">
                <label class="form-label w-100" for="noteSubject"
                  >Subject</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="noteSubject"
                  formControlName="noteSubject"
                  [ngClass]="{
                    'is-invalid':
                      f['noteSubject']?.invalid &&
                      (f['noteSubject']?.dirty || f['noteSubject']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    f['noteSubject']?.invalid &&
                    (f['noteSubject']?.dirty || f['noteSubject']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="f['noteSubject']?.errors['required']">
                    Subject is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.relateTo === 'Y'">
              <div class="col-md-12">
                <label class="form-label w-100" for="relateTo"
                  >Related To</label
                >
                <select
                  id="relateTo"
                  class="form-select"
                  formControlName="relateTo"
                  [ngClass]="{
                    'is-invalid':
                      f['relateTo']?.invalid &&
                      (f['relateTo']?.dirty || f['relateTo']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    f['relateTo']?.invalid &&
                    (f['relateTo']?.dirty || f['relateTo']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="f['relateTo']?.errors['required']">
                    Related to is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.noteDescription === 'Y'">
              <div class="col-md-12">
                <label class="form-label w-100" for="noteDescription"
                  >Description</label
                >
                <textarea
                  class="form-control"
                  id="noteDescription"
                  formControlName="noteDescription"
                  rows="3"
                  [ngClass]="{
                    'is-invalid':
                      f['noteDescription']?.invalid &&
                      (f['noteDescription']?.dirty ||
                        f['noteDescription']?.touched)
                  }"
                ></textarea>
                <div
                  *ngIf="
                    f['noteDescription']?.invalid &&
                    (f['noteDescription']?.dirty ||
                      f['noteDescription']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="f['noteDescription']?.errors['required']">
                    Description is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.attachment === 'Y'">
              <div class="col-md-12">
                <label class="form-label w-100">Attachment</label>
                <div class="mt-2" (change)="onFileChange($event)">
                  <img
                    *ngIf="url !== '' && url"
                    [src]="url"
                    alt=""
                    id="photo"
                  />
                  <input
                    type="file"
                    id="inputImg"
                    accept="image/jpeg, image/png"
                    hidden
                  />
                  <label *ngIf="url === ''" for="inputImg" class="img_upload"
                    >Upload file</label
                  >
                  <label for="inputImg" *ngIf="url !== ''" class="img_edit">{{
                    "entities.edit" | translate | titlecase
                  }}</label>
                </div>

                <div
                  *ngIf="
                    f['endDate']?.invalid &&
                    (f['endDate']?.dirty || f['endDate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="f['endDate']?.errors['required']">
                    End date is required
                  </div>
                </div>
              </div>
            </ng-container>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save details</button>
      </div>
    </div>
  </div>
</div>

<!--Create task modal-->
<div
  class="modal fade"
  #newTask
  id="newTask"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header border-bottom-0 pb-0">
        <h5 class="modal-title text-black">
          {{ editMode ? "Edit" : "Define" }} a
          {{ editMode ? "task" : "new task" }}
        </h5>
        <button
          type="button"
          class="btn-close"
          (click)="closeDefineTaskModal()"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="createTaskForm">
          <div class="row my-3">
            <ng-container *ngIf="visibleStatus.taskSubject === 'Y'">
              <div class="col-md-12">
                <label class="form-label w-100" for="taskSubject"
                  >Subject</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="taskSubject"
                  formControlName="taskSubject"
                  [ngClass]="{
                    'is-invalid':
                      h['taskSubject']?.invalid &&
                      (h['taskSubject']?.dirty || h['taskSubject']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    h['taskSubject']?.invalid &&
                    (h['taskSubject']?.dirty || h['taskSubject']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="h['taskSubject']?.errors['required']">
                    Subject is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.taskStartDate === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="taskStartDate"
                  >Start Date</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="taskStartDate"
                  formControlName="taskStartDate"
                  [ngClass]="{
                    'is-invalid':
                      h['taskStartDate']?.invalid &&
                      (h['taskStartDate']?.dirty || h['taskStartDate']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    h['taskStartDate']?.invalid &&
                    (h['taskStartDate']?.dirty || h['taskStartDate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="h['taskStartDate']?.errors['required']">
                    Start date is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.taskEndDate === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="taskEndDate"
                  >End Date</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="taskEndDate"
                  formControlName="taskEndDate"
                  [ngClass]="{
                    'is-invalid':
                      h['taskEndDate']?.invalid &&
                      (h['taskEndDate']?.dirty || h['taskEndDate']?.touched)
                  }"
                />
                <div
                  *ngIf="
                    h['taskEndDate']?.invalid &&
                    (h['taskEndDate']?.dirty || h['taskEndDate']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="h['taskEndDate']?.errors['required']">
                    End date is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.taskRelatedTo === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="taskRelatedTo"
                  >Related To</label
                >
                <select
                  id="taskRelatedTo"
                  class="form-select"
                  formControlName="taskRelatedTo"
                  [ngClass]="{
                    'is-invalid':
                      h['taskRelatedTo']?.invalid &&
                      (h['taskRelatedTo']?.dirty || h['taskRelatedTo']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    h['taskRelatedTo']?.invalid &&
                    (h['taskRelatedTo']?.dirty || h['taskRelatedTo']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="h['taskRelatedTo']?.errors['required']">
                    Related to is required
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="visibleStatus.priority === 'Y'">
              <div class="col-md-6">
                <label class="form-label w-100" for="priority">Priority</label>
                <select
                  id="priority"
                  class="form-select"
                  formControlName="priority"
                  [ngClass]="{
                    'is-invalid':
                      h['priority']?.invalid &&
                      (h['priority']?.dirty || h['priority']?.touched)
                  }"
                >
                  <option value=""></option>
                  <option value=""></option>
                </select>
                <div
                  *ngIf="
                    h['priority']?.invalid &&
                    (h['priority']?.dirty || h['priority']?.touched)
                  "
                  class="form-text text-danger"
                >
                  <div *ngIf="h['priority']?.errors['required']">
                    Priority is required
                  </div>
                </div>
              </div>
            </ng-container>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save details</button>
      </div>
    </div>
  </div>
</div>

<!--Modal for Listing all users !-->
<app-dynamic-simple-modal
  [modalVisible]="allUsersModalVisible"
  [modalButtonLabel]="'Okay'"
  [modalTitle]="'Add participant'"
  [useDynamicContent]="true"
  [zIndex]="firstModalZIndex"
  (actionEmitter)="processSelectedUser($event)"
>
  <!---Use content projection !-->
  <div modal-body-content>
    <app-staff-modal (userSelected)="getSelectedUser($event)">
    </app-staff-modal>
  </div>
  <!---Use content projection !-->
</app-dynamic-simple-modal>
<!-- add backdrop element that is shown when the allUsersModalVisible is true and has a lower z-index value -->
<div
  class="modal-backdrop fade"
  *ngIf="allUsersModalVisible"
  [style.z-index]="firstModalZIndex"
></div>
