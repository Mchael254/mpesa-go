<div class="container-fluid">
  <div class="full-border">
    <div
      class="d-flex justify-content-start text-black"
      style="font-weight: 500; font-size: 16px"
    >
      Policy Underwriting
    </div>
   <div class="spinner" style="position: relative;">
    <ngx-spinner name="underwriting" type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>
  
    <div class="row pt-4 px-2 pb-4 fadeIn " style="font-size: 11px" >
        <div class="col-lg-4 col-md-6 col-sm-12 px-4">
          <div class="row px-4">
            <div class="col-3 text-black-50">Product:</div>
            <div class="col-9 text-black">{{ productList | product : policyUnderwritingSummary['product_code'] }}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-3 text-black-50">Payment option:</div>
            <div class="col-9 text-black">{{ policyUnderwritingSummary['endr_pay_method']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-3 text-black-50">Premium mask:</div>
            <div class="col-9 text-black">{{ policyUnderwritingSummary['premium_mask']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-3 text-black-50">Agent:</div>
            <div class="col-9 text-black"> {{policyUnderwritingSummary['agent']}} </div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-3 text-black-50">Assured:</div>
            <div class="col-9 text-black"> {{policyUnderwritingSummary['assured']}} </div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-3 text-black-50">Endorsement Type:</div>
            <div class="col-9 text-black"> {{policyUnderwritingSummary['endorsement_desc']}} </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-12 px-4">
          <div class="row px-4">
            <div class="col-6 text-black-50">Proposal No. :</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['proposal_no']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Life assured:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['life_assured']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Term:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['endr_term']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Agent code:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['agn_sht_desc']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">ANB:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['endr_anb']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Endorsement status:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['endr_status']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Occupation:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['occupation']}}</div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-12 px-4">
          <div class="row px-4">
            <div class="col-6 text-black-50">Effective date:</div>
            <div class="col-6 text-black">{{ policyUnderwritingSummary['effective_date'] | date:'short'}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Product option:</div>
            <div class="col-6 text-black"> {{policyUnderwritingSummary['product_option']}} </div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Maturity Date:</div>
            <div class="col-6 text-black"> {{policyUnderwritingSummary['maturity_date'] | date:'short'}} </div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Status:</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['status']}}</div>
          </div>
          <div class="row px-4 pt-2">
            <div class="col-6 text-black-50">Endorsement No. :</div>
            <div class="col-6 text-black">{{policyUnderwritingSummary['endr_no']}}</div>
          </div>
        </div>
      </div>
      <div class="d-flex justify-content-end pt-4">
        <div
          data-bs-toggle="modal"
          data-bs-target="#UnderWritingModal"
          style="cursor: pointer; border-bottom: solid 2px var(--primary-color)"
        >
          view summary
        </div>
      </div>
   </div>

    <div class="fadeIn">
      <div>
        <p-tabMenu [model]="items" [activeItem]="activeItem">
          <ng-template pTemplate="item" let-item>
            <div>
              <span style="color: black"> {{ item.label }}</span>
            </div>
          </ng-template>
        </p-tabMenu>
      </div>
      <div class="content">
        <div *ngIf="activeTab === 'ACCOUNT_DETAILS'">
          <app-account-details></app-account-details>
        </div>
        <div *ngIf="activeTab === 'EXCEPTIONS'">
          <app-exceptions></app-exceptions>
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex justify-content-end" style="font-size: 10px !important;">
    <button type="button" class="btn btn-danger m-1" data-bs-toggle="modal"
    data-bs-target="#UnderWritingRejectModal">Reject</button>
    <button type="button" class="btn btn-primary m-1" (click)="authorizePolicy()">Authorize</button>
  </div>
</div>

<div
  class="modal fade"
  tabindex="-1"
  #UnderWritingModal
  id="UnderWritingModal"
  aria-labelledby="UnderWritingModal"
  aria-hidden="true"
  style="color: #333"
>
  <div class="modal-dialog">
    <div class="modal-content modal-content-undw  modal-content-sub-header">
      <div>
        <div class="d-flex justify-content-end"><div style="color: red; font-size: 18px; padding: 0.5rem;">x</div></div>
        <div style="padding: 0 2rem">
          <div class="row" >
            <div class="col-lg-6 col-md-12">
              <div
                class="col-12"
                style="
                  color: var(--primary-color);
                  font-weight: 500;
                  border-bottom: solid 2px var(--primary-color);
                "
              >
                Client Details
              </div>
              <div class="row pt-2">
                <div class="col-lg-4 col-md-12 text-black-50">Name:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['assured']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">DOB:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['prp_dob']}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Gender:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['assured']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12  text-black-50">Occupation:</div>
                <div class="col-lg-4 col-md-12  text-black fw-medium"> {{ policyUnderwritingSummary['occupation']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12  text-black-50">Nationality:</div>
                <div class="col-lg-4 col-md-12  text-black fw-medium"> {{ policyUnderwritingSummary['assured']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Country of Residence:</div>
                <div class="col-lg-4 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['assured']| titlecase}}</div>
              </div>
            </div>
            <div class="col-lg-6 col-md-12">
              <div
                class="col-12"
                style="
                  color: var(--primary-color);
                  font-weight: 500;
                  border-bottom: solid 2px var(--primary-color);
                "
              >
                Product details
              </div>
              <div class="row pt-2">
                <div class="col-lg-4 col-md-12  text-black-50">Proposal No. :</div>
                <div class="col-lg-8 col-md-12  text-black fw-medium"> {{ policyUnderwritingSummary['proposal_no']}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12  text-black-50">Intermediary:</div>
                <div class="col-8 text-black fw-medium"> {{ policyUnderwritingSummary['assured']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Payment mode:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['endr_pay_method']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Sum assured:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['endr_tot_sa'] | number}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Product:</div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['product_description']| titlecase}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Currency: </div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['sum_assured'] | number}}</div>
              </div>
              <div class="row">
                <div class="col-lg-4 col-md-12 text-black-50">Premium: </div>
                <div class="col-lg-8 col-md-12 text-black fw-medium"> {{ policyUnderwritingSummary['endr_tot_premium'] | number}}</div>
              </div>
            </div>
          </div>
          <div class="pt-2">
            <div>
              <div class="col-12">
              <div
                class="col-12"
                style="
                  color: var(--primary-color);
                  font-weight: 500;
                  border-bottom: solid 2px var(--primary-color);
                "
              >
                Cover Details
              </div>
              <div class="row">
                <!-- {{policyUnderwritingSummary | json}} -->
                <div *ngFor="let item of endorsementCoverTypeList" class="row col-lg-6 col-md-12">
                  <div class="row pt-2">
                    <div class="col-lg-12 col-md-12 text-black fw-medium">{{item['cvt_desc'] | titlecase}}</div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 col-md-12 text-black-50">Premium:</div>
                    <div class="col-lg-8 col-md-12 text-black fw-medium">{{item['pcvt_premium'] | number}}</div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 col-md-12 text-black-50">Sum Assured:</div>
                    <div class="col-lg-8 col-md-12 text-black fw-medium"> {{item['pcvt_sa'] | number}} </div>
                  </div>
                </div>

                <div class=" pt-2" *ngIf="endorsementCoverTypeList?.length===0" style="color: red;">
                  No Cover Details Available!!
                </div>
              </div>


            </div></div>
          </div>
          <div class="pt-2">
            <div>
              <div class="col-12">
              <div
                class="col-12"
                style="
                  color: var(--primary-color);
                  font-weight: 500;
                  border-bottom: solid 2px var(--primary-color);
                "
              >
              Beneficiary(ies) & trustee(s)
              </div>
              <div class="row">
                <div *ngFor="let item of policyDependents" class="row col-6">
                  <div class="row pt-2">
                    <div class="col-6 text-black-50">Name:</div>
                    <div class="col-6 text-black fw-medium"> {{item['surname'] +' '+ item['other_names'] | titlecase }} </div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Benefit proportion:</div>
                    <div class="col-6 text-black fw-medium">{{item['percentage'] || 0 | number}}% </div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Date of birth:</div>
                    <div class="col-6 text-black fw-medium">{{item['date_of_birth'] | date: 'dd/mm/YYYY'}}</div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Relation:</div>
                    <div class="col-6 text-black fw-medium">{{'-'}}</div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Gender:</div>
                    <div class="col-6 text-black fw-medium">{{item['gender']==='M'?'Male': 'Female' | titlecase}}</div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Type:</div>
                    <div class="col-6 text-black fw-medium"> {{item['dty_desc'] | titlecase}}</div>
                  </div>
                </div>

                <div class=" pt-2" *ngIf="policyDependents?.length===0" style="color: red;">
                  No Beneficiary(ies) Or trustee(s) Available!!
                </div>
              </div>


            </div></div>
          </div>
          <div class="pt-2">
            <div>
              <div class="col-12">
              <div
                class="col-12"
                style="
                  color: var(--primary-color);
                  font-weight: 500;
                  border-bottom: solid 2px var(--primary-color);
                "
              >
                Document(s)
              </div>
              <div class="row">
                <div class="row col-6">
                  <!-- <div class="row pt-2">
                    <div class="col-6 text-black-50">Passport:</div>
                    <div class="col-6 fw-medium" style="color: var(--primary-color); text-decoration: underline;">mypassport.pdf</div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Passport:</div>
                    <div class="col-6 fw-medium" style="color: var(--primary-color); text-decoration: underline;">mypassport.pdf</div>
                  </div>
                  <div class="row">
                    <div class="col-6 text-black-50">Utility Bill:</div>
                    <div class="col-6 fw-medium" style="color: var(--primary-color); text-decoration: underline;">electricity_bill.pdf</div>
                  </div> -->




                  <div class="row pt-2" *ngFor="let item of documentList; let i = index">
                    <div class="d-flex justify-content-start view_document">
                      <span class="font-grey__font-eight__700">{{i+1}}.</span>
                      <a (click)="downloadBase64File(item['backend_file_url'])" class="fw-light  click">{{item['type'].replaceAll('_', ' ') | titlecase}}.{{item['file_extension'] | lowercase}}</a>
                    </div>
                  </div>
                  <div class="row pt-2" *ngIf="documentList?.length===0" style="color: red;">
                    No Document Available!!
                  </div>


                </div>
              </div>


            </div></div>
          </div>
        </div>
      </div>

      <div class="modal-body"></div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  tabindex="-1"
  #UnderWritingModal
  id="UnderWritingRejectModal"
  aria-labelledby="UnderWritingRejectModal"
  aria-hidden="true"
  style="color: #333"
>
  <div class="modal-dialog">
    <div class="modal-content-undw-reject modal-content modal-content-sub-header">
      <div>
        <div class="d-flex justify-content-end"><div style="color: red; font-size: 18px; padding: 0.5rem;">x</div></div>
        <div style="padding: 0 2rem" [formGroup]="rejectForm">
          <div class="text-black fw-medium">Please provide a reason for your cancellation</div>
          <div class="text-black fw-medium pt-2">Reason</div>

          <textarea class="form-control pt-1 pb-4" id="exampleFormControlTextarea1" rows="3" formControlName="cancellation_source"></textarea>

          <div class="d-flex justify-content-end pt-2" style="transform: translateX(0.4rem);">
            <button type="button" class="btn btn-info m-1" data-bs-toggle="modal"
            data-bs-target="#UnderWritingRejectModal" style="color: var(--primary-color);">Close</button>
            <button type="button" class="btn btn-primary m-1" (click) = rejectQuote() [disabled]="!rejectForm.invalid">Reject Quote</button>
          </div>
        </div>



      </div>

      <div class="modal-body"></div>
    </div>
  </div>
</div>



