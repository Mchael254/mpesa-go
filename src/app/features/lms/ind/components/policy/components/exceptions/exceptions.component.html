<div class="">
  <div class="spinner" style="position: relative">
    <ngx-spinner name="exceptions" type="ball-clip-rotate-multiple" [fullScreen]="false" color="#00529B" size="medium" bdColor = "rgba(255, 255, 255, 0.966)"></ngx-spinner>
  
    <div class="d-flex justify-content-end">
      <div class="b-r d-flex justify-content-center align-content-center" (click)="openModal()">
        <i class="fa-solid fa-plus" (click)="openModal()"></i>
      </div>
    </div>
    <ng-container>
      <p-table
        #dt1
        [lazy]="true"
        responsiveLayout="stack"
        scrollHeight="flex"
        [columns]="exceptionList?.cols"
        [value]="exceptionList?.rows"
        [paginator]="exceptionList?.paginator"
        [rows]="exceptionList.rowsPerPage || 5"
        [showCurrentPageReport]="true"
        [totalRecords]="100"
        (onPage)="paginate($event)"
      >
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th pSortableColumn="{{ 'SN' }}" style="width: 4%">
              {{ "SN" }}
              <span *ngIf="exceptionList.showSorting">
                <p-sortIcon field="{{ 'SN' }}"></p-sortIcon>
              </span>
              <span *ngIf="exceptionList.showFilter">
                <p-columnFilter
                  type="text"
                  field="{{ 'SN' }}"
                  display="menu"
                ></p-columnFilter>
              </span>
            </th>
            <th
              style="width: 20%"
              pSortableColumn="{{ col.field }}"
              *ngFor="let col of columns"
            >
              {{ col.header }}
              <span *ngIf="exceptionList.showSorting">
                <p-sortIcon field="{{ col.field }}"></p-sortIcon>
              </span>
              <span *ngIf="exceptionList.showFilter">
                <p-columnFilter
                  type="text"
                  field="{{ col.field }}"
                  display="menu"
                ></p-columnFilter>
              </span>
            </th>

            <th style="width: 4%">
              {{ "" }}
            </th>
          </tr>
        </ng-template>
        <ng-template
          pTemplate="body"
          let-rowIndex="rowIndex"
          let-rowData
          let-columns="columns"
        >
          <tr
            class="change_Color"
            style="font-size: 14px"
            (click)="selectRow(rowData)"
          >
            <ng-container>
              <td>{{ rowIndex + 1 }}</td>

              <td *ngFor="let col of columns" style="width: 10%;">
                {{ rowData[col.field]?.replaceAll("_", " ") | titlecase }}
              </td>
              <td>
                <div
                  class="d-flex justify-content-end dropdown-toggle"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <div>
                    <i class="fa-solid fa-ellipsis-vertical"></i>
                    <ul class="dropdown-menu">
                      <li>
                        <a class="dropdown-item" (click)="approveException(rowIndex)">Approve</a>
                      </li>
                      <li>
                        <a class="dropdown-item" (click)="editException(rowIndex)">Edit</a>
                      </li>
                      <li (click)="deleteException(rowData)">
                        <a class="dropdown-item">Delete</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </td>
            </ng-container>
          </tr>
        </ng-template>
      </p-table>
    </ng-container>
  </div>
</div>



<div
  class="modal fade"
  tabindex="-1"
  #UnderWritingModal
  id="UnderWritingExceptionModal"
  aria-labelledby="UnderWritingExceptionModal"
  aria-hidden="true"
  style="color: #333"
>
  <div class="modal-dialog">
    <div class="modal-content-undw-reject modal-content modal-content-sub-header">
      <div>
        <div class="d-flex justify-content-end"><div style="color: red; font-size: 20px; padding: 0.5rem; cursor: pointer;" (click)="closeModal()" > x </div></div>
        <div style="padding: 0 2rem" [formGroup]="exceptionFormModal">
          <div class="text-black fw-medium">Add Exception Details</div>
          <div class="row">
            <div class="col-md-6 col-sm-12">
              <div>
                <label class="required">Exception Type</label>
                <select formControlName="le_code" class="form-select">
                  <ng-container *ngFor="let exception of exceptionTypeList">
                    <option [value]="exception['code']">
                      {{ exception?.name | titlecase }}
                    </option>
                  </ng-container>
                </select>
              </div>
            </div>

            <div class="col-md-6 col-sm-12">
              <div>
                <label class="required">Value</label>
                <input
                type="text"
                class="form-control"
                formControlName="value"
                id="value"
              />              
            </div>
            </div>
          </div>
          <div class="d-flex justify-content-end pt-2" style="transform: translateX(0.4rem);">
            <button type="button" class="btn btn-danger m-1" data-bs-toggle="modal"
            data-bs-target="#UnderWritingExceptionModal" (click)="closeModal()" >Close</button>
            <button type="button" class="btn btn-primary m-1"  (click)="saveException()">save</button>
          </div>
        </div>



      </div>

    </div>
  </div>
</div>
