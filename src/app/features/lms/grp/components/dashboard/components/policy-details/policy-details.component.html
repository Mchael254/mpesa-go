<div class="main">
    <div style="display: flex; padding-top: 1rem; justify-content: start">
        <app-dynamic-breadcrumb [breadCrumbItems]="breadCrumbItems">
        </app-dynamic-breadcrumb>
      </div>
    <div *ngIf="!gla" class="container">
        <div>
            <!-- <div class="nav-link" (click)="showContent('summary')" [class.active]="selectedContent === 'summary'">
                Pension account summary</div> -->
                <div class="nav-link" (click)="showContent('summary')" [class.active]="selectedContent === 'summary'">
                    {{ investment || investmentWithRider ? 'Investment summary' : 'Pension account summary' }}
                </div>                
                <div *ngIf="pensionWithLifeRider || investmentWithRider" class="nav-link" (click)="showContent('cover_types')"
                [class.active]="selectedContent === 'cover_types'">Cover types</div>
            <div class="nav-link" (click)="showContent('transactions')"
                [class.active]="selectedContent === 'transactions'">Transactions</div>
        </div>
    </div>

    <div class="container2">
        <ng-container *ngIf="!gla">
        <div *ngIf="selectedContent === 'summary'">
            <div class="title-desc" *ngIf="!investment && !investmentWithRider">Pension account summary</div>
            <div class="title-desc" *ngIf="investment || investmentWithRider">Investment summary</div>


            <div class="pension-table-container col-12" *ngIf="memberDetails">

                <div class="col-6">
                    <table class="pension-table">
                        <tr>
                            <td class="table-label">Name:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.name | titlecase }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Date of birth:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.date_of_birth }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Date of joining scheme:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.effective_from_date }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Years to retirement:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.future_service_years }}</td>
                        </tr>
                        <tr *ngIf="!investment && !investmentWithRider">
                            <td class="table-label">Employee contribution:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.employee_contri | number }}</td>
                        </tr>
                        <tr *ngIf="investment || investmentWithRider">
                            <td class="table-label">Interest:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.pens_interest_pct }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Interim interest rate:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.pens_interest_pct }}</td>
                        </tr>
                    </table>
                </div>

                <div class="col-6">
                    <table class="pension-table">
                        <tr>
                            <td class="table-label">Gender:</td>
                            <td class="table-label-desc">{{ getGenderLabel(memberDetails[0]?.gender) }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Member number:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.member_number }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Group:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.scheme_name }}</td>
                        </tr>
                        <tr *ngIf="!investment && !investmentWithRider">
                            <td class="table-label">Employer contribution:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.employer_contri | number }}</td>
                        </tr>
                        <tr *ngIf="!investment && !investmentWithRider">
                            <td class="table-label">Annual salary:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.annual_earnings | number }}</td>
                        </tr>
                        <tr *ngIf="investment || investmentWithRider">
                            <td class="table-label">Contribution:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.name }}</td>
                        </tr>
                        <tr *ngIf="investment || investmentWithRider">
                            <td class="table-label">Total fund value:</td>
                            <td class="table-label-desc">{{ memberDetails[0]?.name }}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Status:</td>
                            <td class="table-label-desc">{{ getStatusLabel(memberDetails[0]?.pension_status) }}</td>
                        </tr>
                    </table>
                </div>
            </div>

            <ng-container *ngIf="!investment && !investmentWithRider">
            <div class="statement-desc" style="margin-top: 40px;">Statement as of 13th, March 2024</div>
            <div class="pension-table-container col-12">
                <div class="col-6">
                    <div class="title-desc" style="color: black;">Employee contribution</div>

                    <table class="pension-table">
                        <tr>
                            <td class="table-label">Contribution:</td>
                            <td class="table-label-desc">Ksh. 100,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Trasfer value:</td>
                            <td class="table-label-desc">Ksh. 80,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Annual voluntary contribution:</td>
                            <td class="table-label-desc">Ksh. 20,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Interest:</td>
                            <td class="table-label-desc">Ksh. 1,200,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Total fund value:</td>
                            <td class="table-label-desc">Ksh. 10,300,000</td>
                        </tr>
                    </table>
                </div>

                <div class="col-6">
                    <div class="title-desc col-6" style="color: black;">Employer contribution</div>

                    <table class="pension-table">
                        <tr>
                            <td class="table-label">Contribution:</td>
                            <td class="table-label-desc">Ksh. 100,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Trasfer value:</td>
                            <td class="table-label-desc">Ksh. 80,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Annual voluntary contribution:</td>
                            <td class="table-label-desc">Ksh. 20,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Interest:</td>
                            <td class="table-label-desc">Ksh. 1,200,000</td>
                        </tr>
                        <tr>
                            <td class="table-label">Total fund value:</td>
                            <td class="table-label-desc">Ksh. 10,300,000</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="statement-desc" style="color: black;">Pension account totals <b>Ksh. 20,000,000</b></div>
        </ng-container>
            <!-- <div class="download-link mt-2">
                <a href="#">
                    <img src="assets/images/file-type-pdf.svg" class="pdf-icon">
                    <span class="download-link">Pension account summary report</span>
                </a>
            </div> -->
            <div class="download-link mt-2">
                <a href="#">
                    <img src="assets/images/file-type-pdf.svg" class="pdf-icon">
                    <span class="download-link">
                        {{ investment || investmentWithRider ? 'Investment summary report' : 'Pension account summary report' }}
                    </span>
                </a>
            </div>
            

            <div class="title-desc mt-3">Valuations</div>
            <div class="filter-options">
                <label for="filterBy" style="color: black;">Filter by</label>
                <select class="form-select">
                    <ng-container *ngFor="let option ">
                        <option [value]="">{{ option['category_category'] | titlecase }}</option>
                    </ng-container>
                </select>
                <select class="form-select">
                    <ng-container *ngFor="let option ">
                        <option [value]="">{{ option['category_category'] | titlecase }}</option>
                    </ng-container>
                </select>
                <input type="text" pInputText class="form-control" id='otherNames'>
            </div>
            <p-table [value]="memberBalances" styleClass="p-datatable-striped" [tableStyle]="{'max-width': '100%'}">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: calc(100% / 7);">Year</th>
                        <th style="width: calc(100% / 7);">Period</th>
                        <th id="table-align" style="width: calc(100% / 7);">Balance B/F</th>
                        <th id="table-align" style="width: calc(100% / 7);">Contribution</th>
                        <th id="table-align" style="width: calc(100% / 7);">Rate</th>
                        <th id="table-align" style="width: calc(100% / 7);">Interest</th>
                        <th id="table-align"  style="width: calc(100% / 7);">Balance C/F</th>
                        <th class="action-column" style="width: 10px;"></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>{{ item.year }}</td>
                        <td>{{ item.period }}</td>
                        <td id="table-align">{{ item.balance_bf | number  }}</td>
                        <td id="table-align">{{ item.employer_amount | number  }}</td>
                        <td id="table-align">{{ item.rate }}</td>
                        <td id="table-align">{{ item.total_interest | number }}</td>
                        <td id="table-align">{{ item.balance_cf | number  }}</td>
                        <td class="action-column">
                            <div class="flex justify-content-center">
                                <p-overlayPanel #op>
                                    <div>
                                        <!-- Download button -->
                                        <p-button label="Download" icon="pi pi-download" styleClass="p-button-rounded p-button-text"
                                            severity="primary"></p-button>
                                    </div>
                                </p-overlayPanel>
                                <!-- Ellipsis container -->
                                <div (click)="op.toggle($event)">
                                    <i class="fas fa-ellipsis-v hover-button" (click)="op.toggle($event)"></i>
                                </div>
                            </div>
                        </td>
                        </tr>
                </ng-template>
            </p-table>

            <div class=" mt-3">
                <a href="#">
                    <img src="assets/images/file-type-pdf.svg" class="pdf-icon">
                    <span class="download-link">Valuations report</span>
                </a>
            </div>


        </div>
        </ng-container>

        <ng-container *ngIf="!gla">
        <div *ngIf="selectedContent === 'cover_types'">
                <div class="info">
                    <div>
                        <label class="label-name" for="name">Cover:</label>
                        <span class="label-desc" id="name">{{memberCovers[0]?.cvt_desc | titlecase}}</span>
                    </div>
            
                    <div>
                        <label class="label-name" for="national-id">Coverage period:</label>
                        <span class="label-desc" id="national-id">{{ memberCovers[0]?.pcm_cover_wef_date }} - {{ memberCovers[0]?.pcm_cover_wet_date }}</span>
                    </div>
        
                    <div>
                        <label class="label-name" for="phone">Sum assured:</label>
                        <span class="label-desc" id="phone">{{memberCovers[0]?.pcm_sa | number}}</span>
                    </div>
            
                </div>
        </div>
    </ng-container>

        <ng-container *ngIf="!gla">
        <div *ngIf="selectedContent === 'transactions'">
            <div class="title-desc">Receipts</div>
            <div>
                <div class="filter-options">
                    <select class="form-select">
                        <option value="" disabled selected>Select Year</option>
                        <ng-container *ngFor="let year of years">
                            <option [value]="year">{{ year }}</option>
                        </ng-container>
                    </select>

                    <select class="form-select">
                        <option value="" disabled selected>Select Month</option>
                        <ng-container *ngFor="let month of months">
                            <option [value]="month">{{ month }}</option>
                        </ng-container>
                    </select>
                </div>

                <p-table [value]="memberPensionDepReceipts" styleClass="p-datatable-striped" [tableStyle]="{'max-width': '100%'}"
                [paginator]="true" [rows]="5" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10, 25, 50]">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width: calc(100% / 8);">Receipt number</th>
                            <th style="width: calc(100% / 8);">Date</th>
                            <th id="table-align" style="width: calc(100% / 8);">Contribution</th>
                            <th style="width: calc(100% / 8);">Voluntary contribution</th>
                            <th style="width: calc(100% / 8);">Transfer value</th>
                            <th id="table-align" style="width: calc(100% / 8);">Severance</th>
                            <th id="table-align" style="width: calc(100% / 8);">Account total</th>
                            <th id="table-align" style="width: calc(100% / 8);">Total pension account</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
                        <tr (click)="onReceiptsTableRowClick(item, rowIndex)" [ngClass]="{'selected-row': rowIndex === selectedRowIndex}" style="cursor: pointer">
                            <td>{{ item.pension_member_dep_code }}</td>
                            <td>{{ item.pnmdp_date }}</td>
                            <td id="table-align">{{ item.employee_amount | number }}</td>
                            <td id="table-align">{{ item.voluntary_contribution_amount | number }}</td>
                            <td id="table-align">{{ item.total_transfer_amount }}</td>
                            <td id="table-align">{{ item.cost_of_past_benefits }}</td>
                            <td id="table-align">{{ item.total_amount | number }}</td>
                            <td id="table-align">{{ item.pnmdp_amount | number }}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <div style="margin-top: 40px;">
                <div class="title-desc">Withdrawals</div>
                <div class="filter-options">
                    <select class="form-select">
                        <option value="" disabled selected>Select Year</option>
                        <ng-container *ngFor="let year of years">
                            <option [value]="year">{{ year }}</option>
                        </ng-container>
                    </select>

                    <select class="form-select">
                        <option value="" disabled selected>Select Month</option>
                        <ng-container *ngFor="let month of months">
                            <option [value]="month">{{ month }}</option>
                        </ng-container>
                    </select>
                </div>

                <p-table [value]="withdrawals" styleClass="p-datatable-striped" [tableStyle]="{'max-width': '100%'}">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width: calc(100% / 6);">Date</th>
                            <th style="width: calc(100% / 6);">Payment method</th>
                            <th style="width: calc(100% / 6);">Bank</th>
                            <th style="width: calc(100% / 6);">Account number</th>
                            <th style="width: calc(100% / 6);">Payee</th>
                            <th style="width: calc(100% / 6); text-align: right;">Amount</th>
                            <th class="action-column" style="width: 10px;"></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr>
                            <td>{{ item.voucher_date }}</td>
                            <td>{{ item.payment_mode }}</td>
                            <td>{{ item.bank_branch_name }}</td>
                            <td>{{ item.clnt_acc_no }}</td>
                            <td>{{ item.payee }}</td>
                            <td style="text-align: right;">{{ item.voucher_amount | number }}</td>
                            <td class="action-column">
                                <i class="fas fa-ellipsis-v"></i>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

            <div style="margin-top: 40px;" *ngIf="investment || investmentWithRider">
                <div class="title-desc">Loans</div>
                <div class="filter-options">
                    <select class="form-select">
                        <option value="" disabled selected>Select Year</option>
                        <ng-container *ngFor="let year of years">
                            <option [value]="year">{{ year }}</option>
                        </ng-container>
                    </select>

                    <select class="form-select">
                        <option value="" disabled selected>Select Month</option>
                        <ng-container *ngFor="let month of months">
                            <option [value]="month">{{ month }}</option>
                        </ng-container>
                    </select>
                </div>

                <p-table [value]="dummyData" styleClass="p-datatable-striped" [tableStyle]="{'max-width': '100%'}">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width: calc(100% / 7);">Issue date</th>
                            <th style="width: calc(100% / 7);">1st repayment date</th>
                            <th style="width: calc(100% / 7);">Loan duration</th>
                            <th style="width: calc(100% / 7);">Principal amount</th>
                            <th style="width: calc(100% / 7);">Rates</th>
                            <th style="width: calc(100% / 7);">Interest</th>
                            <th style="width: calc(100% / 7);">Total payment</th>
                            <th class="action-column" style="width: 10px;"></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr>
                            <td id="table-align">{{ item.year }}</td>
                            <td id="table-align">{{ item.period }}</td>
                            <td id="table-align">{{ item.balanceBF }}</td>
                            <td id="table-align">{{ item.contribution }}</td>
                            <td id="table-align">{{ item.rate }}%</td>
                            <td id="table-align">{{ item.interest }}</td>
                            <td id="table-align">{{ item.interest }}</td>
                            <td class="action-column">
                                <div class="flex justify-content-center">
                                    <p-overlayPanel #op>
                                        <div>
                                            <!-- Download button -->
                                            <p-button label="Download repayment schedule" icon="pi pi-download" styleClass="p-button-rounded p-button-text"
                                                severity="primary"></p-button>
                                        </div>
                                    </p-overlayPanel>
                                    <!-- Ellipsis container -->
                                    <div (click)="op.toggle($event)">
                                        <i class="fas fa-ellipsis-v hover-button" (click)="op.toggle($event)"></i>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </ng-container>

        <ng-container *ngIf="gla">
            <div>
            <div class="title-desc" style="font-size: 20px;">Cover types</div>
            <div class="cvt-container">
                <div *ngFor="let memCovers of memberCovers; let i = index" class="box">
                    <label class="active-label">{{memberCovers[0]?.pcm_status | titlecase}}</label>
                    <div class="scroll-content">
                    <table>
                        <tr>
                            <td>Cover:</td>
                            <td class="td-data">{{memberCovers[0]?.cvt_desc | titlecase}}</td>
                        </tr>
                        <tr>
                            <td>Coverage period:</td>
                            <td class="td-data">{{ memberCovers[0]?.pcm_cover_wef_date }} - {{ memberCovers[0]?.pcm_cover_wet_date }}</td>
                        </tr>
                        <tr>
                            <td>Sum assured:</td>
                            <td class="td-data">{{memberCovers[0]?.pcm_sa | number}}</td>
                        </tr>
                    </table>
                    </div>
                </div>
            </div>
            </div>
    
        </ng-container>

    </div>
</div>

<!-- modals begin -->
<!-- modal to GET receipt breakdown -->
<div class="modal fade" tabindex="-1" #adminDetailsModal id="receiptsModal" aria-labelledby="receiptsModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title float-left" id="receiptsModal">Receipts summary</h5>
          <button type="button" class="custom-red-button" data-bs-dismiss="modal" aria-label="Close"
          (click)="closeReceiptsModal()"></button>
        </div>
        <div class="modal-body">
            <div class="pension-table-container col-12" *ngIf="detailedMemContrReceipts">
                <div class="col-6">
                    <div class="title-desc" style="color: black;">Employee contribution</div>

                    <table class="receipt-table">
                        <tr>
                            <td class="table-label">Contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.employee_amount | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Trasfer amount:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.pnmdp_empye_trans_amt | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Annual voluntary contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.pnmdp_empye_vol_amt | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Cost of benefits:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.cost_of_past_benefits | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Total contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.total_amount | number}}</td>
                        </tr>
                    </table>
                </div>

                <div class="col-6">
                    <div class="title-desc col-6" style="color: black;">Employer contribution</div>

                    <table class="receipt-table">
                        <tr>
                            <td class="table-label">Contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.employer_amount | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Trasfer amount:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.pnmdp_empyr_trans_amt | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Annual voluntary contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.pnmdp_empyr_trans_amt | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Cost of benefits:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.cost_of_past_benefits | number}}</td>
                        </tr>
                        <tr>
                            <td class="table-label">Total contribution:</td>
                            <td class="table-label-desc">{{detailedMemContrReceipts[0]?.total_amount | number}}</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="statement-desc" style="color: black;">Total account contributions <b>Ksh. 20,000,000</b></div>
            
        </div>
        <div class="modal-footer">
        </div>
      </div>
    </div>
  </div>
  <!-- end of modal to GET receipt breakdown -->
  <!-- modals end -->